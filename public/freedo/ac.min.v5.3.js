/*
 FreeDo Co.Ltd.@2022
 @fileoverview AirCityCloud JS DevelopmentKit
 Creation Time: 2022/11/14 3:00:48 PM
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(w){var D=0;return function(){return D<w.length?{done:!1,value:w[D++]}:{done:!0}}};$jscomp.arrayIterator=function(w){return{next:$jscomp.arrayIteratorImpl(w)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(w,D,H){if(w==Array.prototype||w==Object.prototype)return w;w[D]=H.value;return w};$jscomp.getGlobal=function(w){w=["object"==typeof globalThis&&globalThis,w,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var D=0;D<w.length;++D){var H=w[D];if(H&&H.Math==Math)return H}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(w,D){var H=$jscomp.propertyToPolyfillSymbol[D];if(null==H)return w[D];H=w[H];return void 0!==H?H:w[D]};
$jscomp.polyfill=function(w,D,H,E){D&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(w,D,H,E):$jscomp.polyfillUnisolated(w,D,H,E))};$jscomp.polyfillUnisolated=function(w,D,H,E){H=$jscomp.global;w=w.split(".");for(E=0;E<w.length-1;E++){var N=w[E];if(!(N in H))return;H=H[N]}w=w[w.length-1];E=H[w];D=D(E);D!=E&&null!=D&&$jscomp.defineProperty(H,w,{configurable:!0,writable:!0,value:D})};
$jscomp.polyfillIsolated=function(w,D,H,E){var N=w.split(".");w=1===N.length;E=N[0];E=!w&&E in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var T=0;T<N.length-1;T++){var F=N[T];if(!(F in E))return;E=E[F]}N=N[N.length-1];H=$jscomp.IS_SYMBOL_NATIVE&&"es6"===H?E[N]:null;D=D(H);null!=D&&(w?$jscomp.defineProperty($jscomp.polyfills,N,{configurable:!0,writable:!0,value:D}):D!==H&&(void 0===$jscomp.propertyToPolyfillSymbol[N]&&(H=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[N]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(N):$jscomp.POLYFILL_PREFIX+H+"$"+N),$jscomp.defineProperty(E,$jscomp.propertyToPolyfillSymbol[N],{configurable:!0,writable:!0,value:D})))};$jscomp.initSymbol=function(){};$jscomp.iteratorPrototype=function(w){w={next:w};w[Symbol.iterator]=function(){return this};return w};$jscomp.underscoreProtoCanBeSet=function(){var w={a:!0},D={};try{return D.__proto__=w,D.a}catch(H){}return!1};
$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(w,D){w.__proto__=D;if(w.__proto__!==D)throw new TypeError(w+" is not extensible");return w}:null;$jscomp.makeIterator=function(w){var D="undefined"!=typeof Symbol&&Symbol.iterator&&w[Symbol.iterator];return D?D.call(w):$jscomp.arrayIterator(w)};$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(w){if(!(w instanceof Object))throw new TypeError("Iterator result "+w+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(w){this.yieldResult=w};
$jscomp.generator.Context.prototype.throw_=function(w){this.abruptCompletion_={exception:w,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(w){this.abruptCompletion_={return:w};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(w){this.abruptCompletion_={jumpTo:w};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(w,D){this.nextAddress=D;return{value:w}};
$jscomp.generator.Context.prototype.yieldAll=function(w,D){w=$jscomp.makeIterator(w);var H=w.next();$jscomp.generator.ensureIteratorResultIsObject_(H);if(H.done)this.yieldResult=H.value,this.nextAddress=D;else return this.yieldAllIterator_=w,this.yield(H.value,D)};$jscomp.generator.Context.prototype.jumpTo=function(w){this.nextAddress=w};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(w,D){this.catchAddress_=w;void 0!=D&&(this.finallyAddress_=D)};$jscomp.generator.Context.prototype.setFinallyBlock=function(w){this.catchAddress_=0;this.finallyAddress_=w||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(w,D){this.nextAddress=w;this.catchAddress_=D||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(w){this.catchAddress_=w||0;w=this.abruptCompletion_.exception;this.abruptCompletion_=null;return w};$jscomp.generator.Context.prototype.enterFinallyBlock=function(w,D,H){H?this.finallyContexts_[H]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=w||0;this.finallyAddress_=D||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(w,D){D=this.finallyContexts_.splice(D||0)[0];if(D=this.abruptCompletion_=this.abruptCompletion_||D){if(D.isException)return this.jumpToErrorHandler_();void 0!=D.jumpTo&&this.finallyAddress_<D.jumpTo?(this.nextAddress=D.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=w};$jscomp.generator.Context.prototype.forIn=function(w){return new $jscomp.generator.Context.PropertyIterator(w)};
$jscomp.generator.Context.PropertyIterator=function(w){this.object_=w;this.properties_=[];for(var D in w)this.properties_.push(D);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var w=this.properties_.pop();if(w in this.object_)return w}return null};$jscomp.generator.Engine_=function(w){this.context_=new $jscomp.generator.Context;this.program_=w};
$jscomp.generator.Engine_.prototype.next_=function(w){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,w,this.context_.next_);this.context_.next_(w);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(w){this.context_.start_();var D=this.context_.yieldAllIterator_;if(D)return this.yieldAllStep_("return"in D?D["return"]:function(H){return{value:H,done:!0}},w,this.context_.return);this.context_.return(w);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(w){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],w,this.context_.next_);this.context_.throw_(w);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(w,D,H){try{var E=w.call(this.context_.yieldAllIterator_,D);$jscomp.generator.ensureIteratorResultIsObject_(E);if(!E.done)return this.context_.stop_(),E;var N=E.value}catch(T){return this.context_.yieldAllIterator_=null,this.context_.throw_(T),this.nextStep_()}this.context_.yieldAllIterator_=null;H.call(this.context_,N);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var w=this.program_(this.context_);if(w)return this.context_.stop_(),{value:w.value,done:!1}}catch(D){this.context_.yieldResult=void 0,this.context_.throw_(D)}this.context_.stop_();if(this.context_.abruptCompletion_){w=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(w.isException)throw w.exception;return{value:w.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(w){this.next=function(D){return w.next_(D)};this.throw=function(D){return w.throw_(D)};this.return=function(D){return w.return_(D)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(w,D){D=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(D));$jscomp.setPrototypeOf&&w.prototype&&$jscomp.setPrototypeOf(D,w.prototype);return D};
$jscomp.asyncExecutePromiseGenerator=function(w){function D(E){return w.next(E)}function H(E){return w.throw(E)}return new Promise(function(E,N){function T(F){F.done?E(F.value):Promise.resolve(F.value).then(D,H).then(T,N)}T(w.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(w){return $jscomp.asyncExecutePromiseGenerator(w())};$jscomp.asyncExecutePromiseGeneratorProgram=function(w){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(w)))};
$jscomp.polyfill("Array.prototype.includes",function(w){return w?w:function(D,H){var E=this;E instanceof String&&(E=String(E));var N=E.length;H=H||0;for(0>H&&(H=Math.max(H+N,0));H<N;H++){var T=E[H];if(T===D||Object.is(T,D))return!0}return!1}},"es7","es3");$jscomp.polyfill("Promise.prototype.finally",function(w){return w?w:function(D){return this.then(function(H){return Promise.resolve(D()).then(function(){return H})},function(H){return Promise.resolve(D()).then(function(){throw H;})})}},"es9","es3");
var acapi=function(w){function D(a){function b(c,e){return c.reduce(function(d,h){var g;Array.isArray(h)&&(g=b(h,e+1));return g>d?g:d},e)}return b(a,1)}function H(a){let b=a.length,c=Array(b),e;for(let d=0;d<b;d++)e=a.charCodeAt(d),e=48<=e&&58>e?e-48:(e&223)-65+10,c[d]=e;return c.reduce((d,h)=>16*d+h,0)}function E(a){if(void 0!=a){var b=[];if(/^(rgb|RGB)/.test(a)){a=a.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(",");for(let c of a)b.push(Number((Number(c)/255).toFixed(1)))}else if(/^#/.test(a)){if(/^#[0-9A-F]{3}$/i.test(a)){let c=
"#";a.replace(/[0-9A-F]/ig,function(e){c+=e+e});a=c}/^#[0-9A-F]{6}$/i.test(a)&&a.replace(/[0-9A-F]{2}/ig,function(c){c=H(c);b.push(Number((c/255).toFixed(1)))})}else a instanceof Array&&(b=a);3==b.length&&b.push(1);return b}}function N(a){if(void 0!=a){var b,c=D(a);2==c?b=[[a]]:3==c?b=[a]:4==c&&(b=a);if(b)for(let e of b)for(let d of e)for(let h of d)2==h.length&&h.push(0);return b}}function T(a){if(void 0!=a)return 1==D(a)?[a]:a}function F(a){return a instanceof Array?a:[a]}function K(a){let b=[];
if(a instanceof Array)for(let c in a)b[c]=a[c].toString();else b=[a.toString()];return b}function ia(a){switch(typeof a){case "undefined":return!0;case "string":if(0===a.replace(/(^[ \t\n\r]*)|([ \t\n\r]*$)/g,"").length)return!0;break;case "boolean":if(!a)return!0;break;case "number":if(isNaN(a))return!0;break;case "object":if(null===a||0===a.length)return!0;for(var b in a)return!1;return!0}return!1}function oa(a,b){for(a=a.toString();a.length<b;)a="0"+a;return a}function Ca(a){switch(a){case ba.StartingProcess:return"starting process...";
case ba.CheckingBusy:return"checking...";case ba.ProcessStartFailed:return"process start failed!";case ba.ProcessStarted:return"process started";case ba.LoadingProject:return"loading project...";case ba.ProjectLoaded:return"project loaded"}}function Da(a){return Q.isIOSDevice&&Q.isInWeixinBrowser?!1:a==ra.abnormal||a==ra.instance_disconnected}function Y(a,b){return void 0!==a&&null!==a?a:b}function ua(a){"string"===typeof a&&(a=document.getElementById(a));return a}function va(a){return a.keyCode===
ca.Shift&&"ShiftRight"===a.code?ca.RightShift:a.keyCode===ca.Control&&"ControlRight"===a.code?ca.RightControl:a.keyCode===ca.Alt&&"AltRight"===a.code?ca.RightAlt:a.keyCode}var p={None:0,Camera_PlayAnimation:1,Camera_StopAnimation:2,Misc_EnterReportMode:3,Misc_ExitReportMode:4,Misc_SetDateTime:5,Camera_GetCamera:6,Camera_SetState:7,Camera_Set:8,Camera_LookAtBBox:9,Coord_World2Screen:10,Coord_Screen2World:11,InfoTree_SetVisibility:12,InfoTree_Show:13,InfoTree_Hide:14,InfoTree_EnableXRay:15,InfoTree_DisableXRay:16,
TileLayer_Add:17,HeatMap_Add:18,HeatMap_Update:19,HeatMap_AddPoints:20,HeatMap_RemovePoints:21,HeatMap_Delete:22,HeatMap_Show:23,HeatMap_Hide:24,HeatMap_Focus:25,HighlightArea_Add:26,HighlightArea_Delete:27,HighlightArea_Update:28,Polygon3D_Add:29,Polygon3D_Delete:30,Misc_AddImageButton:31,Misc_DeleteImageButton:32,Misc_AddAnimatedImageButton:33,Settings_SetMainUIVisibility:34,Settings_SetMousePickMask:35,Tag_Add:36,Tag_Delete:37,Tag_Update:38,Tag_Clear:39,Tag_Focus:40,Beam_Add:41,Beam_Update:42,
Beam_Delete:43,Beam_Clear:44,Beam_Focus:45,Beam_Show:350,Beam_Hide:351,Beam_ShowAll:352,Beam_HideAll:353,RadiationPoint_Add:46,RadiationPoint_Update:47,RadiationPoint_Delete:48,RadiationPoint_Clear:49,Polygon_Add:50,Polygon_Update:51,Polygon_Delete:52,Polygon_Clear:53,Polygon_Highlight:54,Polygon_StopHighlight:325,Polygon_Glow:55,Polygon_Focus:56,Tag_FocusAll:57,Tag_Show:58,Tag_Hide:59,Tag_ShowAll:60,Tag_HideAll:61,RadiationPoint_Focus:62,RadiationPoint_FocusAll:63,RadiationPoint_Show:64,RadiationPoint_Hide:65,
RadiationPoint_ShowAll:66,RadiationPoint_HideAll:67,Polygon_Show:68,Polygon_Hide:69,Polygon3D_Update:70,Polygon3D_Clear:71,Polygon3D_Focus:72,Polygon3D_Show:73,Polygon3D_Hide:74,Polygon3D_Highlight:75,Polygon3D_Glow:76,Polygon3D_StopGlow:77,HighlightArea_Clear:78,HighlightArea_Focus:79,HighlightArea_Show:80,HighlightArea_Hide:81,Misc_GetVersion:82,TileLayer_Update:83,TileLayer_Delete:84,TileLayer_Focus:85,TileLayer_EnableXRay:86,TileLayer_DisableXRay:87,TileLayer_Show:88,TileLayer_Hide:89,Tag_Get:90,
RadiationPoint_Get:91,Polygon_Get:92,Polygon3D_Get:93,HighlightArea_Get:94,TileLayer_Get:95,Beam_Get:96,HeatMap_Get:97,Settings_GetMapMode:98,Settings_SetMapMode:99,Settings_SetMapURL:100,Settings_SetWMTSLayerVisible:320,TileLayer_Actor_Show:101,TileLayer_Actor_Hide:102,TileLayer_Actor_Focus:103,TileLayer_Actor_Highlight:104,TileLayer_Actor_StopHightlight:105,CustomObject_Add:106,CustomObject_Update:107,CustomObject_Delete:108,CustomObject_Get:109,CustomObject_Focus:110,CustomObject_Show:111,CustomObject_Hide:112,
CustomObject_SetTintColor:326,HeatMap_Clear:113,CustomTag_Clear:39,CustomTag_Delete:37,CustomTag_Focus:40,CustomTag_FocusAll:57,CustomTag_Show:58,CustomTag_Hide:59,CustomTag_ShowAll:60,CustomTag_HideAll:61,CustomTag_Add:114,CustomTag_Update:115,CustomTag_Get:116,Polyline_Add:117,Polyline_Update:118,Polyline_Delete:119,Polyline_Clear:120,Polyline_Focus:121,Polyline_Get:122,Polyline_Show:123,Polyline_Hide:124,Polyline_ShowAll:125,Polyline_HideAll:126,VideoProjection_Add:127,VideoProjection_Update:128,
VideoProjection_Delete:129,VideoProjection_Show:130,VideoProjection_Hide:131,VideoProjection_Get:132,VideoProjection_Focus:133,Misc_PlayVideo:134,Misc_StopPlayVideo:135,Weather_SetParams:136,Weather_GetParams:137,Weather_SetDate:138,Weather_GetDate:139,ODLine_Add:140,ODLine_Update:141,ODLine_Delete:142,ODLine_Clear:143,ODLine_Focus:144,ODLine_Get:145,ODLine_Show:146,ODLine_Hide:147,ODLine_ShowAll:148,ODLine_HideAll:149,Misc_SetWindowResolution:150,Misc_CallBPFunction:151,Settings_SetHighlightColor:152,
InfoTree_ShowByGroupId:153,InfoTree_HideByGroupId:154,InfoTree_HighlightByGroupId:155,InfoTree_DeleteByGroupId:156,EditHelper_Start:157,EditHelper_Quit:158,EditHelper_Finish:159,EditHelper_SetParam:160,Settings_SetFovX:161,TileLayer_Actor_ShowAll:162,TileLayer_Actor_HideAll:163,CameraTour_Add:164,CameraTour_Update:165,CameraTour_Play:166,CameraTour_Stop:167,CameraTour_Delete:168,Tag_PopupWindow_Show:169,Tag_PopupWindow_Hide:170,Tag_PopupWindow_ShowAll:171,Tag_PopupWindow_HideAll:172,Settings_SetOceanColor:173,
Misc_ShowAllFoliages:174,Misc_HideAllFoliages:175,Tools_StartPolygonClip:176,Tools_StopClip:177,TileLayer_SetAllowClip:178,Panorama_Add:179,Panorama_Update:180,Panorama_Delete:181,Panorama_Clear:182,Panorama_Focus:183,Panorama_Get:184,Decal_Add:185,Decal_Update:186,Decal_Delete:187,Decal_Clear:188,Decal_Focus:189,Decal_FocusAll:190,Decal_Get:191,Misc_PlayMovie:192,Misc_StopMovie:193,Tools_SetMeasurement:194,Tools_StartMeasurement:195,Tools_StopMeasurement:196,Viewshed_Add:197,Viewshed_Update:198,
Viewshed_Focus:199,Viewshed_Delete:200,Viewshed_Clear:201,Viewshed_Get:202,TileLayer_SetStyle:203,Tools_LineIntersect:204,Coord_PCS2GCS:205,Coord_GCS2PCS:206,DynamicWater_Add:207,DynamicWater_Update:208,DynamicWater_Focus:209,DynamicWater_Delete:210,DynamicWater_Clear:211,DynamicWater_Get:212,DynamicWater_Show:213,DynamicWater_Hide:214,Quit:215,TileLayer_Actor_Unhighlight:216,InfoTree_Get:217,Reset:218,CustomObject_Clear:219,CustomObject_Highlight:220,CustomObject_Unhighlight:221,CustomObject_StopHighlight:222,
CustomObject_CallFunction:223,CustomObject_AddByTileLayer:224,Tools_StartPlaneClip:226,Tools_StopPlaneClip:228,Tools_StartVolumeClip:229,Tools_UpdateVolumeClip:230,Tools_StopVolumeClip:231,Tools_StartSkylineAnalysis:232,Tools_StopSkylineAnalysis:233,Tools_ExportSkyline:234,Tools_StartViewshedAnalysis:235,Tools_StopViewshedAnalysis:236,Camera_Move:237,TileLayer_SetCollision:238,TileLayer_Modifier_Add:239,TileLayer_Modifier_Update:240,TileLayer_Modifier_Delete:241,TileLayer_Modifier_Clear:242,Misc_StartProcess:243,
Settings_SetCampassVisible:244,Tools_StartGeometryEdit:245,Tools_StopGeometryEdit:246,Settings_SetEnableInteract:247,Camera_PauseAnimation:248,Camera_ResumeAnimation:249,Settings_SetInteractiveMode:250,CameraTour_Pause:251,CameraTour_Resume:252,Settings_SetTerrainAlpha:253,CustomMesh_Add:254,CustomMesh_Delete:255,CustomMesh_Clear:256,CustomMesh_Update:257,CustomMesh_Get:258,CustomMesh_Focus:259,CustomMesh_Show:260,CustomMesh_Hide:261,CustomMesh_ShowAll:262,CustomMesh_HideAll:263,Settings_EnableCameraMovingEvent:264,
Marker_Add:265,Marker_Update:266,Marker_Get:267,Marker_Delete:268,Marker_Clear:269,Marker_Focus:270,Marker_FocusAll:271,Marker_Show:272,Marker_Hide:273,Marker_ShowAll:274,Marker_HideAll:275,Marker_ShowPopupWindow:276,Marker_HidePopupWindow:277,Marker_ShowAllPopupWindow:278,Marker_HideAllPopupWindow:279,TileLayer_SetViewportVisible:280,TileLayer_GetObjectIDs:281,Polygon3D_StopHighlight:282,Tools_StartFloodFill:283,Tools_StopFloodFill:284,FloodFill_Add:285,FloodFill_Delete:286,FloodFill_Clear:287,FloodFill_Update:288,
FloodFill_Get:289,FloodFill_Focus:290,FloodFill_Show:291,FloodFill_Hide:292,FloodFill_ShowAll:293,FloodFill_HideAll:294,Cesium3DTile_Add:295,Cesium3DTile_Delete:296,Cesium3DTile_Clear:297,Cesium3DTile_Update:298,Cesium3DTile_Get:299,Cesium3DTile_Focus:300,Cesium3DTile_Show:301,Cesium3DTile_Hide:302,Cesium3DTile_ShowAll:303,Cesium3DTile_HideAll:304,TileLayer_GetActorInfoFromDB:305,ShapeFileLayer_Add:306,ShapeFileLayer_Delete:307,ShapeFileLayer_Clear:308,ShapeFileLayer_Update:309,ShapeFileLayer_Get:310,
ShapeFileLayer_Focus:311,ShapeFileLayer_Show:312,ShapeFileLayer_Hide:313,ShapeFileLayer_ShowAll:314,ShapeFileLayer_HideAll:315,ShapeFileLayer_OpenShapeFileLayer:316,Weather_SimulateTime:317,TileLayer_Actor_GetInfo:318,Camera_GetAnimationList:319,TileLayer_CutPolygon_Add:321,TileLayer_CutPolygon_Update:322,TileLayer_CutPolygon_Delete:323,TileLayer_CutPolygon_Clear:324,Marker3D_Add:327,Marker3D_Delete:328,Marker3D_Clear:329,Marker3D_Update:330,Marker3D_Get:331,Marker3D_Focus:332,Marker3D_Show:333,Marker3D_Hide:334,
Marker3D_ShowAll:335,Marker3D_HideAll:336,Camera_GetAnimationImage:337,Tools_ReplaceTexture:338,Tools_RestoreTexture:339,Light_Add:340,Light_Delete:341,Light_Update:343,Light_Get:344,Light_Clear:342,Light_Focus:345,Light_Show:346,Light_Hide:347,Light_ShowAll:348,Light_HideAll:349,WaterMesh_Add:354,WaterMesh_Update:355,WaterMesh_Delete:356,WaterMesh_Clear:357,WaterMesh_Get:358,WaterMesh_Focus:359,WaterMesh_Show:360,WaterMesh_Hide:361,WaterMesh_ShowAll:362,WaterMesh_HideAll:363,CustomObject_StartMove:364,
CustomObject_StopMove:365,CustomObject_OverrideMaterial:366,CustomObject_RestoreMaterial:367,Settings_SetReport:368,Settings_GetReport:369,Settings_SetControl:370,Settings_GetControl:371,Settings_SetPostProcess:372,Settings_GetPostProcess:373,Settings_SetCamera:374,Settings_GetCamera:375,CustomObject_SetViewportVisible:376,WaterFlowField_Add:377,WaterFlowField_Update:378,WaterFlowField_Delete:379,WaterFlowField_Clear:380,WaterFlowField_Get:381,WaterFlowField_Focus:382,WaterFlowField_Show:383,WaterFlowField_Hide:384,
TileLayer_SetViewHeightRange:385,Tools_StartVisiblityAnalysis:386,Tools_StopVisiblityAnalysis:387,Tools_StartViewDomeAnalysis:388,Tools_StopViewDomeAnalysis:389,Tools_StartCutFillAnalysis:390,Tools_StopCutFillAnalysis:391,Tools_StartSunshineAnalysis:392,Tools_StopSunshineAnalysis:393,Tools_StartTerrainSlopeAnalysis:394,Tools_StopTerrainSlopeAnalysis:395,Tools_StartContourLineAnalysis:396,Tools_StopContourLineAnalysis:397,TileLayer_GetAllFlattenData:398,Marker_SetupPOIAttachment:399,HeatMap3D_Add:400,
HeatMap3D_Update:401,HeatMap3D_Focus:402,HeatMap3D_Delete:403,HeatMap3D_Show:404,HeatMap3D_Hide:405,HeatMap3D_Get:406,HeatMap3D_Clear:407,ShapeFileLayer_HighlightFeature:408,ShapeFileLayer_UnHighlightFeature:409,ShapeFileLayer_FocusFeature:410,ShapeFileLayer_GetFeatureInfo:411,Misc_EnterMultiViewport:412,Misc_ExitMultiViewport:413,Misc_SetActivateMultiViewport:414,Misc_GetActivateMultiViewport:415,Panorama_Enter:416,Panorama_Exit:417,Panorama_Switch:418,VTPKService_Get:419,VTPKService_Set:420,SimulateTest__:421,
Settings_CursorAutoSync:422,InfoTree_Focus:423,Marker_ShowByGroupId:424,Marker_HideByGroupId:425,Marker_DeleteByGroupId:426,ImageryLayer_Init:427,ImageryLayer_Add:428,Camera_LockBBox:429,Camera_UnLockBBox:430,Settings_SetWMTSLayerOpacity:431,Camera_EnterEarthCapture:432,Camera_ExitEarthCapture:433,Tools_AnalysisPopupAttributes:434,Tools_AnalysisCloseAttributes:435,ImageryLayer_Show:436,ImageryLayer_Hide:437,ImageryLayer_Delete:438,Settings_GetInteractiveMode:439,VideoProjection_Clear:440,Misc_UpdateMultiViewport:441,
Misc_downloadPakFiles:442,Settings_SetCampassPosition:443,Polygon3D_ShowAll:444,Polygon3D_HideAll:445,Marker3D_ShowByGroupId:500,Marker3D_HideByGroupId:501,Marker3D_DeleteByGroupId:502,Command_End:1E4},wa=!1;(()=>{if(!wa){wa=!0;for(let a in p)p[p[a]]=a}})();const pa={MouseClick:1,MouseMove:2,MouseHover:4},Z={V1:1,V2:2,V3:4,V4:8,All:255};class Ea{constructor(a,b){this.id=a;this.visible=b}}class Fa{constructor(a,b,c,e){this.id=a.toString();this.coordinate=b;this.radius=c;this.heatValue=e}}class Ga{constructor(a,
b,c,e,d,h,g,r,k,f,l,t,v,q){this.id=a.toString();this.coordinate=b;this.imagePath=c;this.imageSize=e;this.url=d;this.text=h;this.range=g||[1,1E5];this.showLine=!!r;this.textColor=k||[0,0,0,1];this.textBackgroundColor=f||[1,1,1,.85];this.textBorderColor=l||[0,0,0,0];this.textRange=t||1E5;this.hoverImagePath=v;this.autoHidePopupWindow=q||!0}}class Ha{constructor(a,b,c){this.url=a;this.width=b;this.height=c}}class Ia{constructor(a,b,c,e,d,h,g,r){this.id=a.toString();this.coordinate=b;this.contentURL=
c.url;this.contentSize=[c.width,c.height];this.popupURL=e.url;this.popupSize=[e.width,e.height];this.pivot=d;this.range=h;this.autoHidePopupWindow=g||!0;this.popupPos=r}}class Ja{constructor(a,b,c,e,d,h){this.id=a.toString();this.coordinates=N(b);this.color=E(c);this.heightRange=e;this.intensity=d;this.depthTest=h||!0}}class Ka{constructor(a,b,c,e,d,h,g,r){this.id=a.toString();this.x=b;this.y=c;this.width=e;this.height=d;this.normalImage=h;this.hoverImage=g;this.tooltip=r}}class La{constructor(a,
b,c,e,d,h,g,r,k){this.id=a.toString();this.x=b;this.y=c;this.width=e;this.height=d;this.imageSequecePath=h;this.imageSequeceLength=g;this.loop=!!r;this.interactable=!!k}}class Ma{constructor(a,b,c,e,d,h,g){this.id=a.toString();this.duration=b;this.thickness=c;this.interval=e;this.velocity=d;this.color=E(h);this.coordinates=g}}class Na{constructor(a,b,c,e,d,h){this.id=a.toString();this.coordinate=b;this.radius=c;this.rippleNumber=e;this.color=E(d);this.brightness=h}}class Oa{constructor(a,b,c,e,d,
h,g,r){this.id=a.toString();this.style=b;this.coordinates=N(c);this.color=E(e);this.height=d;this.intensity=h;this.tillingX=g;this.tillingY=r}}class Pa{constructor(a,b,c,e,d,h,g,r,k,f){this.id=a.toString();this.color=E(b);this.coordinates=c;this.style=void 0==e?0:e;if(0>this.style||5<this.style)this.style=0;this.thickness=void 0==d?20:d;this.brightness=void 0==h?.5:h;this.flowRate=void 0==g?.5:g;this.tiling=r||0;this.depthTest=k||!0;this.shape=void 0==f?0:f}}class Qa{constructor(a,b,c,e,d,h,g,r,k,
f,l,t,v,q,y,u,A){this.id=a.toString();this.color=E(b);this.coordinates=c;this.flowRate=void 0==e?.5:e;this.brightness=void 0==d?.5:d;this.bendDegree=void 0==h?.5:h;this.tiling=g||0;this.lineThickness=void 0==r?20:r;this.flowPointSizeScale=void 0==k?20:k;this.labelSizeScale=void 0==f?100:f;this.lineShape=void 0==l?1:l;this.lineStyle=t||0;this.flowShape=v||0;this.startPointShape=q||0;this.endPointShape=y||0;this.startLabelShape=u||0;this.endLabelShape=A||0;this.endLabelStyle=this.startLabelStyle=this.endPointStyle=
this.startPointStyle=this.flowStyle=0}}class Ra{constructor(a,b,c,e,d,h,g,r){this.id=a.toString();this.color=E(b);this.coordinates=N(c);this.framecolor=E(e);this.framethickness=d;this.depthTest=h||!0;this.brightness=g;this.style=r;if(0>this.style||10<this.style)this.style=0}}class Sa{constructor(a,b,c,e,d,h){this.id=a.toString();this.imagePath=b;this.coordinate=c;this.yaw=e;this.groupId=d||"";this.userData=h||""}}class Ta{constructor(a,b,c,e,d,h,g,r){this.id=a.toString();this.order=b;this.texturePath=
c;this.location=e;this.rotation=d;this.scale=h;this.groupId=g;this.userData=r}}class Ua{constructor(a,b,c,e,d){this.id=a.toString();this.fileName=b;this.location=c;this.rotation=e;this.scale=d}}class Va{constructor(a,b,c,e,d,h,g){this.id=a;this.pakFilePath=b;this.assetPath=c;this.location=e;this.rotation=d;this.scale=h;this.smoothMotion=g}}class Wa{constructor(a,b,c,e,d,h,g){this.id=a;this.tileLayerId=b;this.objectId=c;this.location=e;this.rotation=d;this.scale=h;this.smoothMotion=g}}class Xa{constructor(a,
b,c,e,d,h,g){this.id=a;this.videoURL=b;this.location=c;this.rotation=e;this.fov=d;this.aspectRatio=h;this.distance=g}}class Ya{constructor(a,b,c,e,d){this.id=a;this.coordinates=N(b);this.style=c;this.groupId=e;this.userData=d}}class Za{constructor(a,b,c,e,d){this.actorTag=a;this.objectName=b;this.functionName=c;this.paramType=e;this.paramValue=d}}class da{constructor(a,b){this.tileLayerId=a;this.tileLayerActorNames=K(b)}}class $a{constructor(a,b,c,e){this.index=a;this.time=b;this.location=c;this.rotation=
e}}class ab{constructor(a,b,c){this.id=a.toString();this.name=b.toString();this.keyFrames=c}}class bb{constructor(){this.queue=[];this.dataMap=new Map}enqueue(a){if(null==a||void 0==a||!a.callbackIndex)return!1;this.queue.push(a.callbackIndex);this.dataMap.set(a.callbackIndex,a);return!0}dequeue(){if(0!=this.queue.length){const a=this.queue.shift();return this.dataMap.get(a)}}removeData(a){this.dataMap.has(a)&&this.dataMap.delete(a)}dataSize(){return this.dataMap.size}queueSize(){return this.queue.length}}
class cb extends bb{constructor(a){super();this.onSendAPI=a;this.timer=null;this.isMainThreadBusy=!1}onMainThreadBusy(a){this.isMainThreadBusy=a.busy}push(a){if(a.__noResponse)this.onSendAPI(a);else 0==this.dataSize()?(this.enqueue(a),this.callNext()):1E4<this.dataSize()?console.warn("The api queue has exceeded 10000, and subsequent calls will be ignored!"):this.enqueue(a)}callNext(a){a&&this.removeData(a);this.timer&&clearTimeout(this.timer);0!=this.dataSize()&&(a=this.dequeue())&&(this._callNextForTimeout(3E3),
this.onSendAPI(a))}_callNextForTimeout(a){this.timer=setTimeout(()=>{this.isMainThreadBusy?this._callNextForTimeout(5E3):this.callNext()},a)}}class P{constructor(a,b,c){this.int=a;this.type=b;this.colorProps=c;this._useBatchUpdate=!1;this._tempUpdateData=[]}_checkCommand(a){a=this.type+a;let b=p[a];void 0==b&&this.int.logWithColor("red",`Invalid command: ${a}`);return b}_convertFilePath(a){return this.int.resourcesPath?a.replace("@path:",this.int.resourcesPath+"/"):a}_processProps(a){a=F(a);for(var b of a)for(let c in b)"string"==
typeof b[c]&&b[c].startsWith("@path:")&&(b[c]=this._convertFilePath(b[c]));for(let c of a)"string"!=typeof c.id&&(c.id=c.id.toString());if(this.colorProps){b=this.colorProps.split("|");for(let c of a)for(let e of b)c.hasOwnProperty(e)&&(c[e]=E(c[e]))}if(-1!=["Polygon","Polygon3D","HighlightArea","DynamicWater"].indexOf(this.type))for(let c of a)c.coordinates=N(c.coordinates)}_add(a,b){this._processProps(a);return this.int.call({command:this._checkCommand("_Add"),data:F(a)},b)}_update(a,b){this._processProps(a);
return this.int.call({command:this._checkCommand("_Update"),data:F(a)},b)}_delete(a,b){return this.int.call({command:this._checkCommand("_Delete"),ids:K(a)},b)}_clear(a){return this.int.call0(this._checkCommand("_Clear"),a)}_get(a,b){return this.int.call({command:this._checkCommand("_Get"),ids:K(a)},b)}_focus(a,b,c,e,d){"function"==typeof c&&(d=c,c=void 0);"function"==typeof e&&(d=e,e=null);return this.int.call({command:this._checkCommand("_Focus"),ids:K(a),distance:b||0,flyTime:c,rotation:e},d)}_focusAll(a,
b,c,e){"function"==typeof b&&(e=b,b=void 0);"function"==typeof c&&(e=c,c=null);return this.int.call({command:this._checkCommand("_FocusAll"),ids:[],distance:a||0,flyTime:b,rotation:c},e)}_show(a,b){return this.int.call({command:this._checkCommand("_Show"),ids:K(a)},b)}_showAll(a){return this.int.call0(this._checkCommand("_ShowAll"),a)}_hide(a,b){return this.int.call({command:this._checkCommand("_Hide"),ids:K(a)},b)}_hideAll(a){return this.int.call0(this._checkCommand("_HideAll"),a)}_updateOneProp(a,
b,c,e){if(this._useBatchUpdate){e=!1;for(var d of this._tempUpdateData)if(d.id==a.toString()){e=!0;d[b]=c;break}e||(e={},e.id=a.toString(),e[b]=c,this._tempUpdateData.push(e))}else return d={},d.id=a.toString(),d[b]=c,this.update(d,e)}updateBegin(){this._useBatchUpdate=!0;this._tempUpdateData=[]}updateEnd(a){a=this.update(this._tempUpdateData,a);this._tempUpdateData=null;this._useBatchUpdate=!1;return a}test(){alert("test")}}class db extends P{constructor(a){super(a,"Beam","color")}add(a,b){return super._add(a,
b)}update(a,b){return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}show(a,b){return super._show(a,b)}hide(a,b){return super._hide(a,b)}showAll(a){return super._showAll(a)}hideAll(a){return super._hideAll(a)}get(a,b){return super._get(a,b)}setDuration(a,b,c){return super._updateOneProp(a,"duration",b,c)}setThickness(a,b,c){return super._updateOneProp(a,"thickness",b,c)}setInterval(a,b,c){return super._updateOneProp(a,
"interval",b,c)}setVelocity(a,b,c){return super._updateOneProp(a,"velocity",b,c)}setColor(a,b,c){return super._updateOneProp(a,"color",E(b),c)}setCoordinates(a,b,c){return super._updateOneProp(a,"coordinates",b,c)}}class eb extends P{constructor(a){super(a,"CameraTour")}add(a,b){return super._add(a,b)}update(a,b){return super._update(a,b)}delete(a,b){return super._delete(a,b)}play(a,b){return this.int.call({command:p.CameraTour_Play,ids:K(a)},b)}pause(a){return this.int.call0(p.CameraTour_Pause,a)}resume(a){return this.int.call0(p.CameraTour_Resume,
a)}stop(a){return this.int.call({command:p.CameraTour_Stop},a)}setUserData(a,b,c){return super._updateOneProp(a,"userData",b,c)}setDuration(a,b,c){return super._updateOneProp(a,"duration",b,c)}setKeyFrames(a,b,c){return super._updateOneProp(a,"keyFrames",b,c)}setName(a,b,c){return super._updateOneProp(a,"name",b,c)}}class fb extends P{constructor(a){super(a,"Cesium3DTile")}add(a,b){return super._add(a,b)}update(a,b){return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,
b,c,e,d){return super._focus(a,b,c,e,d)}show(a,b){return super._show(a,b)}showAll(a){return super._showAll(a)}hide(a,b){return super._hide(a,b)}hideAll(a){return super._hideAll(a)}get(a,b){return super._get(a,b)}setTileURL(a,b,c){return super._updateOneProp(a,"tileURL",b,c)}}class gb extends P{constructor(a){super(a,"CustomMesh","color")}add(a,b){return super._add(a,b)}update(a,b){return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,
b,c,e,d)}show(a,b){return super._show(a,b)}hide(a,b){return super._hide(a,b)}get(a,b){return super._get(a,b)}setCoordinates(a,b,c){return super._updateOneProp(a,"coordinates",b,c)}setIndices(a,b,c){return super._updateOneProp(a,"indices",b,c)}setColor(a,b,c){return super._updateOneProp(a,"color",b,c)}}class hb extends P{constructor(a){super(a,"CustomObject")}add(a,b){return super._add(a,b)}update(a,b){return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,
b,c,e,d){return super._focus(a,b,c,e,d)}show(a,b){return super._show(a,b)}hide(a,b){return super._hide(a,b)}get(a,b){return super._get(a,b)}addByTileLayer(a,b){if(a instanceof Array)for(let c of a)this._fixTileLayerProperty(c);else this._fixTileLayerProperty(a);return this.int.call({command:p.CustomObject_AddByTileLayer,data:F(a)},b)}_fixTileLayerProperty(a){a.tileLayerId instanceof Array||(a.tileLayerId=F(a.tileLayerId));a.objectId instanceof Array||(a.objectId=F(a.objectId))}highlight(a,b){return this.int.call({command:p.CustomObject_Highlight,
ids:K(a)},b)}unhighlight(a,b){return"undefined"==typeof a||"function"==typeof a?("function"==typeof a&&(b=a),this.int.call({command:p.CustomObject_StopHighlight},b)):this.int.call({command:p.CustomObject_Unhighlight,ids:K(a)},b)}callFunction(a,b,c,e,d,h){return this.int.call({command:p.CustomObject_CallFunction,data:F({id:a.toString(),functionName:b,paramType:c,paramValue:e,parameters:d})},h)}callFunction4CustomObjectArr(a,b){return this.int.call({command:p.CustomObject_CallFunction,data:F(a)},b)}setLocation(a,
b,c){return super._updateOneProp(a,"location",b,c)}setRotation(a,b,c){return super._updateOneProp(a,"rotation",b,c)}setScale(a,b,c){return super._updateOneProp(a,"scale",b,c)}setSmoothMotion(a,b,c){return super._updateOneProp(a,"smoothMotion",b,c)}setTintColor(a,b,c){a={ids:F(a),color:E(b)};return this.int.call({command:p.CustomObject_SetTintColor,data:F(a)},c)}overrideMaterial(a,b){return this.int.call({command:p.CustomObject_OverrideMaterial,data:F(a)},b)}restoreMaterial(a,b){return this.int.call({command:p.CustomObject_RestoreMaterial,
ids:F(a)},b)}setViewportVisible(a,b,c){let e=[];e.push({viewportIndex:1,viewportVisible:!!(b&Z.V1)});e.push({viewportIndex:2,viewportVisible:!!(b&Z.V2)});e.push({viewportIndex:3,viewportVisible:!!(b&Z.V3)});e.push({viewportIndex:4,viewportVisible:!!(b&Z.V4)});return this.int.call({command:p.CustomObject_SetViewportVisible,id:a,data:e},c)}startMove(a,b,c,e){return this.int.call({command:p.CustomObject_StartMove,id:a,coordinateType:b,data:F(c)},e)}stopMove(a,b){return this.int.call({command:p.CustomObject_StopMove,
id:a},b)}}class ib extends P{constructor(a){super(a,"CustomTag")}add(a,b){return super._add(a,b)}update(a,b){return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}focusAll(a,b,c,e){return super._focusAll(a,b,c,e)}show(a,b){return super._show(a,b)}showAll(a){return super._showAll(a)}hide(a,b){return super._hide(a,b)}hideAll(a){return super._hideAll(a)}get(a,b){return super._get(a,b)}setAutoHidePopupWindow(a,b,
c){return super._updateOneProp(a,"autoHidePopupWindow",b,c)}}class jb extends P{constructor(a){super(a,"Decal")}add(a,b){return super._add(a,b)}update(a,b){return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}focusAll(a,b,c,e){return super._focusAll(a,b,c,e)}get(a,b){return super._get(a,b)}}class kb extends P{constructor(a){super(a,"DynamicWater")}add(a,b){return super._add(a,b)}update(a,b){return super._update(a,
b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}focusAll(a,b,c,e){return super._focusAll(a,b,c,e)}get(a,b){return super._get(a,b)}setCoordinates(a,b,c){return super._updateOneProp(a,"coordinates",N(b),c)}setMaterialPath(a,b,c){return super._updateOneProp(a,"materialPath",b,c)}setStyle(a,b,c){return super._updateOneProp(a,"style",b,c)}}class lb extends P{constructor(a){super(a,"FloodFill","color")}add(a,b){return super._add(a,
b)}update(a,b){return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}show(a,b){return super._show(a,b)}showAll(a){return super._showAll(a)}hide(a,b){return super._hide(a,b)}hideAll(a){return super._hideAll(a)}get(a,b){return super._get(a,b)}setRange(a,b,c,e){b instanceof Array&&c instanceof Array?0<b.length&&0<c.length?this.update({id:a,min:b,max:c},e):console.error("\u6570\u7ec4\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a."):
console.error("\u6570\u7ec4\u53c2\u6570\u683c\u5f0f\u4e0d\u6b63\u786e.")}setMin(a,b,c){return super._updateOneProp(a,"min",b,c)}setMax(a,b,c){return super._updateOneProp(a,"max",b,c)}setSeed(a,b,c){return super._updateOneProp(a,"seed",b,c)}setElevation(a,b,c){return super._updateOneProp(a,"elevation",b,c)}setColor(a,b,c){return super._updateOneProp(a,"color",E(b),c)}setPrecision(a,b,c){return super._updateOneProp(a,"precision",b,c)}}class mb extends P{constructor(a){super(a,"HeatMap")}_checkBBox(a){if(a instanceof
Array){if(6!=a.length||a[0]>a[3]||a[1]>a[4]||a[2]>a[5])return!1}else return!1;return!0}add(a,b,c,e,d){return this._checkBBox(b)?this.int.call({command:p.HeatMap_Add,id:a.toString(),bbox:b,range:c,data:F(e)},d):(this.int.logWithColor("red","Invalid bbox value"),!1)}update(a,b,c,e,d){a={command:p.HeatMap_Update,id:a.toString()};if(b){if(!this._checkBBox(b))return this.int.logWithColor("red","Invalid bbox value"),!1;a.bbox=b}c&&(a.range=c);e&&(a.data=F(e));return this.int.call(a,d)}delete(a,b){return super._delete(a,
b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}show(a,b){return super._show(a,b)}hide(a,b){return super._hide(a,b)}get(a,b){return super._get(a,b)}addPoints(a,b,c){return this.int.call({command:p.HeatMap_AddPoints,id:a,data:F(b)},c)}removePoints(a,b,c){return this.int.call({command:p.HeatMap_RemovePoints,id:a,pointIds:F(b)},c)}setRange(a,b,c){return this.int.call({command:p.HeatMap_Update,id:a,range:b},c)}setBBox(a,b,c){return this._checkBBox(b)?this.int.call({command:p.HeatMap_Update,
id:a,bbox:b},c):(this.int.logWithColor("red","Invalid bbox value"),!1)}}class nb extends P{constructor(a){super(a,"HeatMap3D")}_checkBBox(a){if(a instanceof Array){if(6!=a.length||a[0]>a[3]||a[1]>a[4]||a[2]>a[5])return!1}else return!1;return!0}add(a,b){return this.int.call({command:p.HeatMap3D_Add,data:F(a)},b)}update(a,b){return this.int.call({command:p.HeatMap3D_Update,data:F(a)},b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,
e,d)}show(a,b){return super._show(a,b)}hide(a,b){return super._hide(a,b)}get(a,b){return super._get(a,b)}setDisplayMode(a,b,c){return this.int.call({command:p.HeatMap3D_Update,id:a,displayMode:b},c)}}class ob extends P{constructor(a){super(a,"HighlightArea","color")}add(a,b){return super._add(a,b)}update(a,b){return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}show(a,b){return super._show(a,b)}hide(a,b){return super._hide(a,
b)}get(a,b){return super._get(a,b)}setColor(a,b,c){return super._updateOneProp(a,"color",E(b),c)}setCoordinates(a,b,c){return super._updateOneProp(a,"coordinates",b,c)}setHeightRange(a,b,c){return super._updateOneProp(a,"heightRange",b,c)}setIntensity(a,b,c){return super._updateOneProp(a,"intensity",b,c)}setDepthTest(a,b,c){return super._updateOneProp(a,"depthTest",b,c)}}class pb extends P{constructor(a){super(a,"Light","color")}add(a,b){return super._add(a,b)}update(a,b){return super._update(a,b)}delete(a,
b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}show(a,b){return super._show(a,b)}showAll(a){return super._showAll(a)}hide(a,b){return super._hide(a,b)}hideAll(a){return super._hideAll(a)}get(a,b){return super._get(a,b)}}class qb extends P{constructor(a){super(a,"Marker","fontColor|fontOutlineColor|textBackgroundColor|lineColor")}add(a,b){this._fixMarkerData(a);return super._add(a,b)}_fixMarkerProperty(a){a.textColor&&(a.fontColor=a.textColor);
a.url&&(a.popupURL=a.url);a.dispalyMode&&(a.displayMode=a.dispalyMode);a.popupURL&&!a.popupSize&&(a.popupSize=[600,400]);0==a.showLine&&(a.lineSize=[0,0]);1!=a.showLine||null!=a.lineSize&&void 0!=a.lineSize||(a.lineSize=[2,100]);4==a.displayMode&&0<a.autoDisplayModeSwitchFirstRatio&&0<a.autoDisplayModeSwitchSecondRatio&&(a.autoDisplayModeSwitchRatio=[a.autoDisplayModeSwitchFirstRatio,a.autoDisplayModeSwitchSecondRatio])}_fixMarkerData(a){if(a instanceof Array)for(let b of a)this._fixMarkerProperty(b);
else this._fixMarkerProperty(a)}update(a,b){this._fixMarkerData(a);return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}focusAll(a,b,c,e){return super._focusAll(a,b,c,e)}show(a,b){return super._show(a,b)}showAll(a){return super._showAll(a)}hide(a,b){return super._hide(a,b)}hideAll(a){return super._hideAll(a)}showPopupWindow(a,b){return this.int.call({command:p.Marker_ShowPopupWindow,ids:K(a)},b)}hidePopupWindow(a,
b){return this.int.call({command:p.Marker_HidePopupWindow,ids:K(a)},b)}showAllPopupWindow(a){return this.int.call0(p.Marker_ShowAllPopupWindow,a)}hideAllPopupWindow(a){return this.int.call0(p.Marker_HideAllPopupWindow,a)}get(a,b){return super._get(a,b)}setGroupId(a,b,c){return super._updateOneProp(a,"groupId",b,c)}setUserData(a,b,c){return super._updateOneProp(a,"userData",b,c)}setScreenOffset(a,b,c){return super._updateOneProp(a,"screenOffset",b,c)}setCoordinate(a,b,c){return super._updateOneProp(a,
"coordinate",b,c)}setImagePath(a,b,c){return super._updateOneProp(a,"imagePath",b,c)}setImageSize(a,b,c){return super._updateOneProp(a,"imageSize",b,c)}setHoverImagePath(a,b,c){return super._updateOneProp(a,"hoverImagePath",b,c)}setURL(a,b,c){return super._updateOneProp(a,"url",b,c)}setText(a,b,c){return super._updateOneProp(a,"text",b,c)}setTextOffset(a,b,c){return super._updateOneProp(a,"textOffset",b,c)}setFontSize(a,b,c){return super._updateOneProp(a,"fontSize",b,c)}setFontOutlineSize(a,b,c){return super._updateOneProp(a,
"fontOutlineSize",b,c)}setRange(a,b,c){return super._updateOneProp(a,"range",b,c)}setTextRange(a,b,c){return super._updateOneProp(a,"textRange",b,c)}setFontColor(a,b,c){return super._updateOneProp(a,"fontColor",b,c)}setFontOutlineColor(a,b,c){return super._updateOneProp(a,"fontOutlineColor",b,c)}setTextBackgroundColor(a,b,c){return super._updateOneProp(a,"textBackgroundColor",b,c)}setAutoHidePopupWindow(a,b,c){return super._updateOneProp(a,"autoHidePopupWindow",b,c)}setPopupURL(a,b,c){return super._updateOneProp(a,
"popupURL",b,c)}setPopupSize(a,b,c){return super._updateOneProp(a,"popupSize",b,c)}setPopupOffset(a,b,c){return super._updateOneProp(a,"popupOffset",b,c)}setLineSize(a,b,c){return super._updateOneProp(a,"lineSize",b,c)}setLineColor(a,b,c){return super._updateOneProp(a,"lineColor",b,c)}setLineOffset(a,b,c){return super._updateOneProp(a,"lineOffset",b,c)}setPriority(a,b,c){return super._updateOneProp(a,"priority",b,c)}setOcclusionCull(a,b,c){return super._updateOneProp(a,"occlusionCull",b,c)}setAttachCustomObject(a,
b){return this.int.call({command:p.Marker_SetupPOIAttachment,data:F(a)},b)}showByGroupId(a,b){return this.int.call({command:p.Marker_ShowByGroupId,ids:F(a)},b)}hideByGroupId(a,b){return this.int.call({command:p.Marker_HideByGroupId,ids:F(a)},b)}deleteByGroupId(a,b){return this.int.call({command:p.Marker_DeleteByGroupId,ids:F(a)},b)}}class rb extends P{constructor(a){super(a,"Marker3D","textColor|textOutlineColor")}add(a,b){return super._add(a,b)}update(a,b){return super._update(a,b)}delete(a,b){return super._delete(a,
b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}show(a,b){return super._show(a,b)}showAll(a){return super._showAll(a)}hide(a,b){return super._hide(a,b)}hideAll(a){return super._hideAll(a)}get(a,b){return super._get(a,b)}showByGroupId(a,b){return this.int.call({command:p.Marker3D_ShowByGroupId,groupId:a},b)}hideByGroupId(a,b){return this.int.call({command:p.Marker3D_HideByGroupId,groupId:a},b)}deleteByGroupId(a,b){return this.int.call({command:p.Marker3D_DeleteByGroupId,
groupId:a},b)}}class sb extends P{constructor(a){super(a,"ODLine","color")}add(a,b){this._fixODlineData(a);return super._add(a,b)}_fixODlineProperty(a){a.intensity&&(a.brightness=a.intensity)}_fixODlineData(a){if(a instanceof Array)for(let b of a)this._fixODlineProperty(b);else this._fixODlineProperty(a)}update(a,b){this._fixODlineData(a);return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}show(a,b){return super._show(a,
b)}showAll(a){return super._showAll(a)}hide(a,b){return super._hide(a,b)}hideAll(a){return super._hideAll(a)}get(a,b){return super._get(a,b)}setCoordinates(a,b,c){return super._updateOneProp(a,"coordinates",b,c)}setColor(a,b,c){return super._updateOneProp(a,"color",E(b),c)}setFlowRate(a,b,c){return super._updateOneProp(a,"flowRate",b,c)}setBrightness(a,b,c){return super._updateOneProp(a,"brightness",b,c)}setTiling(a,b,c){return super._updateOneProp(a,"tiling",b,c)}setBendDegree(a,b,c){return super._updateOneProp(a,
"bendDegree",b,c)}setLineThickness(a,b,c){return super._updateOneProp(a,"lineThickness",b,c)}setflowPointSizeScale(a,b,c){return super._updateOneProp(a,"flowPointSizeScale",b,c)}setLabelSizeScale(a,b,c){return super._updateOneProp(a,"labelSizeScale",b,c)}setLineShape(a,b,c){return super._updateOneProp(a,"lineShape",b,c)}setLineStyle(a,b,c){return super._updateOneProp(a,"lineStyle",b,c)}setFlowShape(a,b,c){return super._updateOneProp(a,"flowShape",b,c)}setStartPointShape(a,b,c){return super._updateOneProp(a,
"startPointShape",b,c)}setEndPointShape(a,b,c){return super._updateOneProp(a,"endPointShape",b,c)}setStartLabelShape(a,b,c){return super._updateOneProp(a,"startLabelShape",b,c)}setEndLabelShape(a,b,c){return super._updateOneProp(a,"endLabelShape",b,c)}}class tb extends P{constructor(a){super(a,"Panorama")}add(a,b){return super._add(a,b)}update(a,b){return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}get(a,
b){return super._get(a,b)}enter(a,b){return this.int.call({command:p.Panorama_Enter,ids:K(a)},b)}exit(a){return this.int.call({command:p.Panorama_Exit},a)}switchMode(a){return this.int.call({command:p.Panorama_Switch},a)}}class ub extends P{constructor(a){super(a,"Polygon","color|frameColor")}add(a,b){this._fixPolygonData(a);return super._add(a,b)}_fixPolygonProperty(a){a.intensity&&(a.brightness=a.intensity)}_fixPolygonData(a){if(a instanceof Array)for(let b of a)this._fixPolygonProperty(b);else this._fixPolygonProperty(a)}update(a,
b){this._fixPolygonData(a);return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}show(a,b){return super._show(a,b)}hide(a,b){return super._hide(a,b)}get(a,b){return super._get(a,b)}glow(a,b,c){return this.int.call({command:p.Polygon_Glow,ids:K(a),duration:b},c)}highlight(a,b){return this.int.call({command:p.Polygon_Highlight,ids:K(a)},b)}stopHighlight(a,b){return this.int.call({command:p.Polygon_StopHighlight,
ids:K(a)},b)}setCoordinates(a,b,c){return super._updateOneProp(a,"coordinates",N(b),c)}setColor(a,b,c){return super._updateOneProp(a,"color",E(b),c)}setDepthTest(a,b,c){return super._updateOneProp(a,"depthTest",b,c)}}class vb extends P{constructor(a){super(a,"Polygon3D","color")}add(a,b){return super._add(a,b)}update(a,b){return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}show(a,b){return super._show(a,b)}hide(a,
b){return super._hide(a,b)}get(a,b){return super._get(a,b)}showAll(a){return super._showAll(a)}hideAll(a){return super._hideAll(a)}highlight(a,b){return this.int.call({command:p.Polygon3D_Highlight,ids:K(a)},b)}stopHighlight(a,b){return this.int.call({command:p.Polygon3D_StopHighlight,ids:K(a)},b)}glow(a,b,c){return this.int.call({command:p.Polygon3D_Glow,ids:K(a),duration:b},c)}stopGlow(a,b){return this.int.call({command:p.Polygon3D_StopGlow,ids:K(a)},b)}setStyle(a,b,c){return super._updateOneProp(a,
"style",b,c)}setCoordinates(a,b,c){return super._updateOneProp(a,"coordinates",b,c)}setColor(a,b,c){return super._updateOneProp(a,"color",E(b),c)}setHeight(a,b,c){return super._updateOneProp(a,"height",b,c)}setIntensity(a,b,c){return super._updateOneProp(a,"intensity",b,c)}setTillingX(a,b,c){return super._updateOneProp(a,"tillingX",b,c)}setTillingY(a,b,c){return super._updateOneProp(a,"tillingY",b,c)}}class wb extends P{constructor(a){super(a,"Polyline","color")}add(a,b){this._fixPolylineData(a);
return super._add(a,b)}_fixPolylineProperty(a){a.intensity&&(a.brightness=a.intensity)}_fixPolylineData(a){if(a instanceof Array)for(let b of a)this._fixPolylineProperty(b);else this._fixPolylineProperty(a)}update(a,b){this._fixPolylineData(a);return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}show(a,b){return super._show(a,b)}showAll(a){return super._showAll(a)}hide(a,b){return super._hide(a,b)}hideAll(a){return super._hideAll(a)}get(a,
b){return super._get(a,b)}setCoordinates(a,b,c){return super._updateOneProp(a,"coordinates",b,c)}setStyle(a,b,c){return super._updateOneProp(a,"style",b,c)}setThickness(a,b,c){return super._updateOneProp(a,"thickness",b,c)}setColor(a,b,c){return super._updateOneProp(a,"color",E(b),c)}setFlowRate(a,b,c){return super._updateOneProp(a,"flowRate",b,c)}setBrightness(a,b,c){return super._updateOneProp(a,"brightness",b,c)}setShape(a,b,c){return super._updateOneProp(a,"shape",b,c)}setDepth(a,b,c){return super._updateOneProp(a,
"depthTest",b,c)}}class xb extends P{constructor(a){super(a,"RadiationPoint","color")}add(a,b){this._fixRadiationPointData(a);return super._add(a,b)}_fixRadiationPointProperty(a){a.intensity&&(a.brightness=a.intensity)}_fixRadiationPointData(a){if(a instanceof Array)for(let b of a)this._fixRadiationPointProperty(b);else this._fixRadiationPointProperty(a)}update(a,b){this._fixRadiationPointData(a);return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,
b,c,e,d){return super._focus(a,b,c,e,d)}focusAll(a,b,c,e){return super._focusAll(a,b,c,e)}show(a,b){return super._show(a,b)}hide(a,b){return super._hide(a,b)}showAll(a){return super._showAll(a)}hideAll(a){return super._hideAll(a)}get(a,b){return super._get(a,b)}setCoordinate(a,b,c){return super._updateOneProp(a,"coordinate",b,c)}setRadius(a,b,c){return super._updateOneProp(a,"radius",b,c)}setRippleNumber(a,b,c){return super._updateOneProp(a,"rippleNumber",b,c)}setColor(a,b,c){return super._updateOneProp(a,
"color",E(b),c)}setBrightness(a,b,c){return super._updateOneProp(a,"brightness",b,c)}setAutoHeight(a,b,c){return super._updateOneProp(a,"autoHeight",b,c)}}class yb extends P{constructor(a){super(a,"ShapeFileLayer","color")}add(a,b){return super._add(a,b)}update(a,b){return super._update(a,b)}_fix_property(a){if(a instanceof Array){let b=[];for(let c of a)ia(c.cacheAllField)&&(c.cacheAllField=!1,b.push(c));a=b}else ia(a.cacheAllField)&&(a.cacheAllField=!1);return a}delete(a,b){return super._delete(a,
b)}clear(a){return super._clear(a)}get(a,b){return super._get(a,b)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}show(a,b){return super._show(a,b)}hide(a,b){return super._hide(a,b)}showAll(a){return super._showAll(a)}hideAll(a){return super._hideAll(a)}open(a,b){return this.int.call({command:p.ShapeFileLayer_OpenShapeFileLayer,data:F(a)},b)}highlightFeature(a,b,c){return this.int.call({command:p.ShapeFileLayer_HighlightFeature,data:F({shpId:a,featureIds:[b]})},c)}stopHighlightFeature(a,b,c){return this.int.call({command:p.ShapeFileLayer_UnHighlightFeature,
data:F({shpId:a,featureIds:[b]})},c)}highlightFeatures(a,b){return this.int.call({command:p.ShapeFileLayer_HighlightFeature,data:F(a)},b)}stopHighlightFeatures(a,b){return this.int.call({command:p.ShapeFileLayer_UnHighlightFeature,data:F(a)},b)}focusFeature(a,b,c,e,d,h){return this.int.call({command:p.ShapeFileLayer_FocusFeature,data:F({shpId:a,featureIds:[b]}),distance:c,flyTime:e,rotation:d},h)}getFeature(a,b){return this.int.call({command:p.ShapeFileLayer_GetFeatureInfo,data:F(a)},b)}}class zb extends P{constructor(a){super(a,
"Tag","textColor|textBackgroundColor|textBorderColor")}add(a,b){return super._add(a,b)}update(a,b){return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}focusAll(a,b,c,e){return super._focusAll(a,b,c,e)}show(a,b){return super._show(a,b)}showAll(a){return super._showAll(a)}hide(a,b){return super._hide(a,b)}hideAll(a){return super._hideAll(a)}get(a,b){return super._get(a,b)}setCoordinate(a,b,c){return super._updateOneProp(a,
"coordinate",b,c)}setImagePath(a,b,c){return super._updateOneProp(a,"imagePath",b,c)}setImageSize(a,b,c){return super._updateOneProp(a,"imageSize",b,c)}setText(a,b,c){return super._updateOneProp(a,"text",b,c)}setRange(a,b,c){return super._updateOneProp(a,"range",b,c)}setTextColor(a,b,c){return super._updateOneProp(a,"textColor",b,c)}setTextBackgroundColor(a,b,c){return super._updateOneProp(a,"textBackgroundColor",b,c)}setTextBorderColor(a,b,c){return super._updateOneProp(a,"textBorderColor",b,c)}setShowLine(a,
b,c){return super._updateOneProp(a,"showLine",b,c)}setAutoHidePopupWindow(a,b,c){return super._updateOneProp(a,"autoHidePopupWindow",b,c)}setURL(a,b,c){return super._updateOneProp(a,"url",b,c)}showPopupWindow(a,b){return this.int.call({command:p.Tag_PopupWindow_Show,ids:K(a)},b)}hidePopupWindow(a,b){return this.int.call({command:p.Tag_PopupWindow_Hide,ids:K(a)},b)}showAllPopupWindow(a){return this.int.call0(p.Tag_PopupWindow_ShowAll,a)}hideAllPopupWindow(a){return this.int.call0(p.Tag_PopupWindow_HideAll,
a)}}class Ab extends P{constructor(a){super(a,"TileLayer")}add(a,b){return super._add(a,b)}update(a,b){return super._update(a,b)}delete(a,b){return super._delete(a,b)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}show(a,b){return super._show(a,b)}hide(a,b){return super._hide(a,b)}get(a,b){return super._get(a,b)}getAllFlattenInfo(a){return this.int.call({command:p.TileLayer_GetAllFlattenData},a)}getActorInfoFromDB(a,b){return this.int.call({command:p.TileLayer_GetActorInfoFromDB,data:F(a)},b)}enableXRay(a,
b,c){return this.int.call({command:p.TileLayer_EnableXRay,ids:K(a),color:E(b)},c)}disableXRay(a,b){return this.int.call({command:p.TileLayer_DisableXRay,ids:K(a)},b)}enableClip(a,b){let c=[];a=F(a);for(let e of a)c.push({id:e,allowClip:!0});return this.int.call({command:p.TileLayer_SetAllowClip,data:c},b)}disableClip(a,b){let c=[];a=F(a);for(let e of a)c.push({id:e,allowClip:!1});return this.int.call({command:p.TileLayer_SetAllowClip,data:c},b)}setFileName(a,b,c){return super._updateOneProp(a,"fileName",
b,c)}setLocation(a,b,c){return super._updateOneProp(a,"location",b,c)}setTranslation(a,b,c){return this.setLocation(a,b,c)}setRotation(a,b,c){return super._updateOneProp(a,"rotation",b,c)}setScale(a,b,c){return super._updateOneProp(a,"scale",b,c)}showActor(a,b,c){a=new da(a,b);return this.int.call({command:p.TileLayer_Actor_Show,data:F(a)},c)}showActors(a,b){let c=[];if(a instanceof Array)for(let d=0;d<a.length;d++){var e=a[d];e={tileLayerId:e.id,tileLayerActorNames:K(e.objectIds)};c.push(e)}else a=
{tileLayerId:a.id,tileLayerActorNames:K(a.objectIds)},c.push(a);return this.int.call({command:p.TileLayer_Actor_Show,data:c},b)}hideActor(a,b,c){a=new da(a,b);return this.int.call({command:p.TileLayer_Actor_Hide,data:F(a)},c)}hideActors(a,b){let c=[];if(a instanceof Array)for(let d=0;d<a.length;d++){var e=a[d];e={tileLayerId:e.id,tileLayerActorNames:K(e.objectIds)};c.push(e)}else a={tileLayerId:a.id,tileLayerActorNames:K(a.objectIds)},c.push(a);return this.int.call({command:p.TileLayer_Actor_Hide,
data:c},b)}focusActor(a,b,c,e,d,h){a=new da(a,b);return this.int.call({command:p.TileLayer_Actor_Focus,data:F(a),distance:c,flyTime:e,rotation:d},h)}focusActors(a,b,c,e,d){a=new da(a.id,a.objectIds);return this.int.call({command:p.TileLayer_Actor_Focus,data:F(a),distance:b,flyTime:c,rotation:e},d)}highlightActor(a,b,c){a=new da(a,b);return this.int.call({command:p.TileLayer_Actor_Highlight,data:F(a)},c)}stopHighlightActor(a,b,c){let e=void 0==a;"function"==typeof a&&(c=a,e=!0);if(e)return this.stopHighlightActors(c);
if(ia(a)||ia(b))console.error("\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a!");else return this.stopHighlightActors({id:a,objectIds:[b]},c)}highlightActors(a,b){return this.int.call({command:p.TileLayer_Actor_Highlight,data:this._fix_highlight_actors_data(a)},b)}stopHighlightActors(a,b){let c=!a;"function"==typeof a&&(b=a,c=!0);return c?this.int.call0(p.TileLayer_Actor_StopHightlight,b):this.int.call({command:p.TileLayer_Actor_Unhighlight,data:this._fix_highlight_actors_data(a)},b)}_fix_highlight_actors_data(a){if(ia(a))console.error("\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a!");
else{var b=[];if(a instanceof Array)for(let c=0;c<a.length;c++){let e=new da(a[c].id,a[c].objectIds);b.push(e)}else a=new da(a.id,a.objectIds),b.push(a);return b}}stopHighlightAllActors(a){return this.int.call0(p.TileLayer_Actor_StopHightlight,a)}showAllActors(a,b){return this.int.call({command:p.TileLayer_Actor_ShowAll,ids:K(a)},b)}hideAllActors(a,b){return this.int.call({command:p.TileLayer_Actor_HideAll,ids:K(a)},b)}setStyle(a,b,c,e,d,h,g,r){return this.int.call({command:p.TileLayer_SetStyle,ids:K(a),
style:b,color:E(c),saturation:e,brightness:d,contrast:h,contrastbase:g},r)}setCollision(a,b,c,e,d,h){a=K(a);let g=[];for(let r of a)g.push({id:r,enableCollision:b,enableMouseRoma:c,enableFunctionInteract:e,enableCharacterCollision:d});return this.int.call({command:p.TileLayer_SetCollision,data:g},h)}addModifiers(a,b){return this.int.call({command:p.TileLayer_Modifier_Add,data:F(a)},b)}addModifierByShapeFile(a,b){return this.int.call({command:p.TileLayer_Modifier_Add,data:F(a)},b)}addModifier(a,b,
c,e,d){this.addModifiers([{id:a,tileLayerId:b,coordinates:c,ententBufferSize:e}])}updateModifier(a,b,c,e,d){return this.int.call({command:p.TileLayer_Modifier_Update,data:F([{id:a,tileLayerId:b,coordinates:c,ententBufferSize:e}])},d)}deleteModifier(a,b,c){return this.int.call({command:p.TileLayer_Modifier_Delete,id:a,tileLayerId:b},c)}clearModifier(a,b){return this.int.call({command:p.TileLayer_Modifier_Clear,ids:K(a)},b)}setViewportVisible(a,b,c){let e=[];e.push({viewportIndex:1,viewportVisible:!!(b&
Z.V1)});e.push({viewportIndex:2,viewportVisible:!!(b&Z.V2)});e.push({viewportIndex:3,viewportVisible:!!(b&Z.V3)});e.push({viewportIndex:4,viewportVisible:!!(b&Z.V4)});return this.int.call({command:p.TileLayer_SetViewportVisible,id:a,data:e},c)}getObjectIDs(a,b){return this.int.call({command:p.TileLayer_GetObjectIDs,ids:K(a)},b)}getActorInfo(a,b){return this.int.call({command:p.TileLayer_Actor_GetInfo,data:F(a)},b)}addHoleByShapeFile(a,b){return this.int.call({command:p.TileLayer_CutPolygon_Add,data:F(a)},
b)}addHole(a,b){return this.int.call({command:p.TileLayer_CutPolygon_Add,data:F(a)},b)}updateHole(a,b,c,e,d){return this.int.call({command:p.TileLayer_CutPolygon_Update,data:F({id:a,tileLayerId:b,coordinates:c,isReverseCut:e})},d)}deleteHole(a,b,c){return this.int.call({command:p.TileLayer_CutPolygon_Delete,id:a,tileLayerId:b},c)}clearHole(a,b){return this.int.call({command:p.TileLayer_CutPolygon_Clear,ids:K(a)},b)}setViewHeightRange(a,b,c,e){return this.int.call({command:p.TileLayer_SetViewHeightRange,
data:[{id:a,minVisibleHeight:b,maxVisibleHeight:c}]},e)}}class Bb extends P{constructor(a){super(a,"VideoProjection","frustumColor")}add(a,b){return super._add(a,b)}update(a,b){return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}show(a,b){return super._show(a,b)}hide(a,b){return super._hide(a,b)}get(a,b){return super._get(a,b)}setVideoURL(a,b,c){return super._updateOneProp(a,"videoURL",b,c)}setLocation(a,b,
c){return super._updateOneProp(a,"location",b,c)}setRotation(a,b,c){return super._updateOneProp(a,"rotation",b,c)}setFovy(a,b,c){return super._updateOneProp(a,"fov",b,c)}setAspectRatio(a,b,c){return super._updateOneProp(a,"aspectRatio",b,c)}setDistance(a,b,c){return super._updateOneProp(a,"distance",b,c)}setDepthCulling(a,b,c){return super._updateOneProp(a,"depthCulling",b,c)}setFrustumColor(a,b,c){return super._updateOneProp(a,"frustumColor",b,c)}}class Cb extends P{constructor(a){super(a,"WaterFlowField")}add(a,
b){return super._add(a,b)}update(a,b){return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,c,e,d){return super._focus(a,b,c,e,d)}show(a,b){return super._show(a,b)}hide(a,b){return super._hide(a,b)}get(a,b){return super._get(a,b)}}class Db extends P{constructor(a){super(a,"WaterMesh","waterColor")}add(a,b){return super._add(a,b)}update(a,b){return super._update(a,b)}delete(a,b){return super._delete(a,b)}clear(a){return super._clear(a)}focus(a,b,
c,e,d){return super._focus(a,b,c,e,d)}show(a,b){return super._show(a,b)}hide(a,b){return super._hide(a,b)}showAll(a){return super._showAll(a)}hideAll(a){return super._hideAll(a)}get(a,b){return super._get(a,b)}setCoordinates(a,b,c){return super._updateOneProp(a,"coordinates",b,c)}setIndices(a,b,c){return super._updateOneProp(a,"indices",b,c)}setNormals(a,b,c){return super._updateOneProp(a,"normals",b,c)}setWaterColor(a,b,c){return super._updateOneProp(a,"waterColor",b,c)}setWaterSpeed(a,b,c){return super._updateOneProp(a,
"waterSpeed",b,c)}setWaterUVRepeat(a,b,c){return super._updateOneProp(a,"waterUVRepeat",b,c)}setWaterDirection(a,b,c){return super._updateOneProp(a,"waterDirection",b,c)}setWaterWaveScale(a,b,c){return super._updateOneProp(a,"waveScale",b,c)}}class Eb extends P{constructor(a){super(a,"ImageryLayer")}init(a,b){return this.int.call({command:p.ImageryLayer_Init,xmlPath:a.xmlUrl,layerName:a.layerName,tileMatrixName:a.tileMatrixName,ogcEPSG:a.ogcEPSG,cachePath:a.cachePath,mapMode:a.mapMode,renderMode:a.renderMode},
b)}add(a,b){const c=this;return $jscomp.asyncExecutePromiseGeneratorFunction(function*(){return a instanceof Array?new Promise(e=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){let d;for(let h of a)if(d=yield c.addOne(h,b),0!=d.result){e(d);break}e(d)})):c.addOne(a,b)})}addOne(a,b){return this.int.call({command:p.ImageryLayer_Add,id:a.id,url:a.url},b)}show(a,b){return super._show(a,b)}hide(a,b){return super._hide(a,b)}delete(a,b){return super._delete(a,b)}}class Fb{constructor(a){this.int=
a;this._useOldDataFormat=!1}useOldDataFormat(a){this._useOldDataFormat=a||!0}get(a){return this.int.call0(p.Camera_GetCamera,a)}_setByArray(a,b,c){return this.set(a[0],a[1],a[2],a[3],a[4],b,c)}_setByObject(a,b,c){return this.set(a.x,a.y,a.z,a.pitch,a.yaw,b,c)}set(a,b,c,e,d,h,g){if(a instanceof Array&&5<=a.length)return this._setByArray(a,b,c);if("object"==typeof a&&a.hasOwnProperty("x"))return this._setByObject(a,b,c);"function"==typeof h&&(g=h,h=void 0);if(this._useOldDataFormat){let r=e;e=d;d=r}return this.int.call({command:p.Camera_Set,
coordinate:[a,b,c],pitch:e||0,yaw:d||0,flyTime:h},g)}lookAt(a,b,c,e,d,h,g,r){"function"==typeof g&&(r=g,g=void 0);if(this._useOldDataFormat){let k=d;d=h;h=k}return this.int.call({command:p.Camera_Set,coordinate:[a,b,c],distance:e,pitch:d||0,yaw:h||0,flyTime:g},r)}lookAtBBox(a,b,c,e,d){"function"==typeof e&&(d=e,e=void 0);if(this._useOldDataFormat){let h=b;b=c;c=h}return this.int.call({command:p.Camera_LookAtBBox,bbox:a,pitch:b||0,yaw:c||0,flyTime:e},d)}playAnimation(a,b){return this.int.call({command:p.Camera_PlayAnimation,
id:a},b)}stopAnimation(a){return this.int.call0(p.Camera_StopAnimation,a)}pauseAnimation(a){return this.int.call0(p.Camera_PauseAnimation,a)}resumeAnimation(a){return this.int.call0(p.Camera_ResumeAnimation,a)}getAnimationList(a){return this.int.call0(p.Camera_GetAnimationList,a)}getAnimationImage(a,b){return this.int.call({command:p.Camera_GetAnimationImage,name:a},b)}moveForward(a){return this.int.call({command:p.Camera_Move,moveForward:!0},a)}moveBackward(a){return this.int.call({command:p.Camera_Move,
moveBackward:!0},a)}moveLeft(a){return this.int.call({command:p.Camera_Move,moveLeft:!0},a)}moveRight(a){return this.int.call({command:p.Camera_Move,moveRight:!0},a)}moveUp(a){return this.int.call({command:p.Camera_Move,moveUp:!0},a)}moveDown(a){return this.int.call({command:p.Camera_Move,moveDown:!0},a)}turnLeft(a){return this.int.call({command:p.Camera_Move,turnLeft:!0},a)}turnRight(a){return this.int.call({command:p.Camera_Move,turnRight:!0},a)}turnUp(a){return this.int.call({command:p.Camera_Move,
turnUp:!0},a)}turnDown(a){return this.int.call({command:p.Camera_Move,turnDown:!0},a)}stop(a){return this.int.call({command:p.Camera_Move,stop:!0},a)}getEulerAngle(a,b){const c=360/(2*Math.PI);let e=b[0]-a[0],d=b[1]-a[1];return[Math.atan2(b[2]-a[2],Math.sqrt(e*e+d*d))*c,Math.atan2(e,d)*c-90,0]}lockByBBox(a,b){return this.int.call({command:p.Camera_LockBBox,bbox:a},b)}unlock(a){return this.int.call({command:p.Camera_UnLockBBox},a)}exitWorld(a,b,c){return this.int.call({command:p.Camera_ExitEarthCapture,
coordinate:a,rotation:b},c)}enterWorld(a){return this.int.call({command:p.Camera_EnterEarthCapture},a)}}class Gb{constructor(a){this.int=a}screen2World(a,b,c){return this.int.call({command:p.Coord_Screen2World,screenPosition:[a,b]},c)}world2Screen(a,b,c,e){return this.int.call({command:p.Coord_World2Screen,worldlocation:[a,b,c]},e)}gcs2pcs(a,b){return this.int.call({command:p.Coord_GCS2PCS,coordinates:T(a)},b)}pcs2gcs(a,b){return this.int.call({command:p.Coord_PCS2GCS,coordinates:T(a)},b)}}class Hb{constructor(a){this.int=
a}start(a){return this.int.call0(p.EditHelper_Start,a)}cancel(a){return this.int.call0(p.EditHelper_Quit,a)}finish(a,b){return this.int.call({command:p.EditHelper_Finish,withOffset:a||!0},b)}setParam(a,b,c,e){return this.int.call({command:p.EditHelper_SetParam,lineType:a,buildType:b,color:E(c)},e)}}class Ib{constructor(a){this.int=a}setVisibility(a,b){return this.int.call({command:p.InfoTree_SetVisibility,layers:F(a)},b)}show(a,b){return this.int.call({command:p.InfoTree_Show,ids:K(a)},b)}hide(a,
b){return this.int.call({command:p.InfoTree_Hide,ids:K(a)},b)}enableXRay(a,b,c){return this.int.call({command:p.InfoTree_EnableXRay,ids:F(a),color:E(b)},c)}disableXRay(a,b){return this.int.call({command:p.InfoTree_DisableXRay,ids:F(a)},b)}showByGroupId(a,b){return this.int.call({command:p.InfoTree_ShowByGroupId,ids:K(a)},b)}hideByGroupId(a,b){return this.int.call({command:p.InfoTree_HideByGroupId,ids:K(a)},b)}highlightByGroupId(a,b){return this.int.call({command:p.InfoTree_HighlightByGroupId,ids:K(a)},
b)}deleteByGroupId(a,b){return this.int.call({command:p.InfoTree_DeleteByGroupId,ids:K(a)},b)}get(a){return this.int.call0(p.InfoTree_Get,a)}focus(a,b){return this.int.call({command:p.InfoTree_Focus,ids:K(a)},b)}}class Jb{constructor(a){this.int=a;this.apiVersion="5.3";this.apiVersionServer=""}isApiVersionMatched(){return"5.3"==this.apiVersionServer}addImageButtons(a,b){return this.int.call({command:p.Misc_AddImageButton,data:F(a)},b)}deleteImageButtons(a,b){return this.int.call({command:p.Misc_DeleteImageButton,
ids:K(a)},b)}addAnimatedImageButtons(a,b){return this.int.call({command:p.Misc_AddAnimatedImageButton,data:F(a)},b)}setApiVersionReceived(a){this.int.onApiVersionReceived=a}playVideo(a,b,c,e,d,h,g){return this.int.call({command:p.Misc_PlayVideo,data:[{id:a.toString(),position:[b,c],size:[e,d],url:h}]},g)}stopPlayVideo(a,b){return this.int.call({command:p.Misc_StopPlayVideo,ids:K(a)},b)}playMovie(a,b,c){"function"==typeof b&&(c=b,b=!1);return this.int.call({command:p.Misc_PlayMovie,loop:b,url:a},c)}stopMovie(a){return this.int.call({command:p.Misc_StopMovie},
a)}setWindowResolution(a,b,c){return this.int.call({command:p.Misc_SetWindowResolution,cx:a,cy:b,mode:0},c)}callBPFunction(a,b){return this.int.call({command:p.Misc_CallBPFunction,data:F(a)},b)}enterReportMode(a){return this.int.call0(p.Misc_EnterReportMode)}exitReportMode(a){return this.int.call0(p.Misc_ExitReportMode,a)}showAllFoliages(a){return this.int.call0(p.Misc_ShowAllFoliages,a)}hideAllFoliages(a){return this.int.call0(p.Misc_HideAllFoliages,a)}startProcess(a,b,c,e){"function"==typeof c&&
(e=c,c=!0);return this.int.call({command:p.Misc_StartProcess,appName:a,commandLine:b,visible:c},e)}enterMultiViewportMode(a,b,c,e){if(null==b||void 0==b)b="#DEA309";if(null==c||void 0==c)c=2;return this.int.call({command:p.Misc_EnterMultiViewport,type:a,lineColor:E(b),lineThickness:c},e)}exitMultiViewportMode(a){return this.int.call({command:p.Misc_ExitMultiViewport},a)}setActiveViewport(a,b){return this.int.call({command:p.Misc_SetActivateMultiViewport,viewIndex:F(a)},b)}getActiveViewport(a){return this.int.call({command:p.Misc_GetActivateMultiViewport},
a)}setMultiviewportInteractSync(a,b){this.setCameraFollow4Viewport(a,b)}setCameraFollow4Viewport(a,b){return this.int.call({command:p.Misc_UpdateMultiViewport,moverTogether:a},b)}downloadPakFiles(a,b){return this.int.call({command:p.Misc_downloadPakFiles,ids:F(a)},b)}startPolygonClip(a,b,c){return this.int.tools.startPolygonClip(a,b,c)}stopClip(a){return this.int.tools.stopClip(a)}playAnimation(a,b){return this.int.camera.playAnimation(a,b)}stopAnimation(a){return this.int.camera.stopAnimation(a)}setDateTime(a,
b,c,e,d,h,g){return this.int.weather.setDateTime(a,b,c,e,d,h,g)}setQueryToolState(a,b){return this.int.call({"c.ommand":p.Settings_SetMousePickMask,mouseClick:a},b)}setCampassVisible(a,b){return this.int.settings.setCampassVisible(a,b)}setMainUIVisibility(a,b){return this.int.settings.setMainUIVisibility(a,b)}setMousePickMask(a,b){return this.int.settings.setMousePickMask(a,b)}}class Kb{constructor(a){this.int=a}setMapMode(a,b,c){b=b||{};return this.int.call({command:p.Settings_SetMapMode,mode:a,
serviceType:b.serviceType||0,coordType:b.coordType||0,mapPoint:b.mapPoint||[0,0],longitude:b.longitude||0,latitude:b.latitude||0,cache:b.cache||":memory:",style:b.style||"mapbox://styles/mapbox/streets-v10",groundHeight:b.groundHeight||0,renderMode:b.renderMode||0,serverURL:b.serverURL,coordOrder:b.coordOrder,maxLevel:b.maxLevel},c)}getMapMode(a){return this.int.call0(p.Settings_GetMapMode,a)}setWMTSLayerVisible(a,b){this.setwmtsLayerVisible(a,b)}setwmtsLayerVisible(a,b){return this.int.call({command:p.Settings_SetWMTSLayerVisible,
data:F(a)},b)}setWMTSLayerOpacity(a,b){return this.int.call({command:p.Settings_SetWMTSLayerOpacity,data:F(a)},b)}setMapURL(a,b){return this.int.call({command:p.Settings_SetMapURL,url:a},b)}highlightColor(a,b){return this.setHighlightColor(a,b)}setHighlightColor(a,b){return this.int.call({command:p.Settings_SetHighlightColor,color:E(a)},b)}setFovX(a,b){return this.int.call({command:p.Settings_SetFovX,value:a},b)}setOceanColor(a,b){return this.int.call({command:p.Settings_SetOceanColor,color:E(a)},
b)}setEnableInteract(a,b){return this.int.call({command:p.Settings_SetEnableInteract,enableInteract:a},b)}setInteractiveMode(a,b){return this.int.call({command:p.Settings_SetInteractiveMode,mode:a},b)}getInteractiveMode(a){return this.int.call({command:p.Settings_GetInteractiveMode},a)}setCampassVisible(a,b){return this.int.call({command:p.Settings_SetCampassVisible,visible:a},b)}setCampassPosition(a,b,c){return this.int.call({command:p.Settings_SetCampassPosition,position:[a,b]},c)}setMainUIVisibility(a,
b){return this.int.call({command:p.Settings_SetMainUIVisibility,visible:a},b)}setMousePickMask(a,b){let c=!1,e=!1,d=!1;a&pa.MouseClick&&(c=!0);a&pa.MouseMove&&(e=!0);a&pa.MouseHover&&(d=!0);return this.int.call({command:p.Settings_SetMousePickMask,mouseClick:c,mouseMove:e,mouseHover:d},b)}setTerrainAlpha(a,b){return this.int.call({command:p.Settings_SetTerrainAlpha,alpha:a},b)}setEnableCameraMovingEvent(a,b,c){return this.int.call({command:p.Settings_EnableCameraMovingEvent,bEnable:a,monitorThreshold:b},
c)}setLabelLayer(a,b){return this.int.call({command:p.VTPKService_Set,vtpk:a},b)}getLabelLayer(a){return this.int.call({command:p.VTPKService_Get},a)}removeLabelLayer(a){return this.int.call({command:p.VTPKService_Set,vtpk:""},a)}setRenderedCursorVisible(a,b){this.setCursorAutoSync(a,b)}setCursorAutoSync(a,b){return this.int.call({command:p.Settings_CursorAutoSync,useSoftwareCursor:a},b)}}class Lb{constructor(a){this.int=a}setReportMode(a,b,c,e){return this.int.call({command:p.Settings_SetReport,
alignment:a,playMode:b,moveInOtherView:c},e)}getReportMode(a){return this.int.call({command:p.Settings_GetReport},a)}setControlMode(a,b,c,e,d){return this.int.call({command:p.Settings_SetControl,speed:a,yawSpeed:b,rotateSelf:c,useFemale:e},d)}getControlMode(a){return this.int.call({command:p.Settings_GetControl},a)}setPostProcessMode(a,b){return this.int.call({command:p.Settings_SetPostProcess,contrast:a.contrast,saturation:a.saturation,lensFlareIntensity:a.lensFlareIntensity,ambientIntensity:a.ambientIntensity,
bloomIntensity:a.bloomIntensity,lutMode:a.lutMode,lutIntensity:a.lutIntensity,darkCorner:a.darkCorner,screenPercentage:a.screenPercentage,terrainGlobalAlpha:a.terrainGlobalAlpha,terrainGlobalLitStatus:a.terrainGlobalLitStatus,osgbGlobalLitStatus:a.osgbGlobalLitStatus,osgbGlobalAlpha:a.osgbGlobalAlpha,antiAliasing:a.antiAliasing,tonemapper:a.tonemapper,postProcessEffects:a.postProcessEffects,dofMode:a.dofMode,wireThickness:a.wireThickness,receiveDecalMode:a.receiveDecalMode},b)}getPostProcessMode(a){return this.int.call({command:p.Settings_GetPostProcess},
a)}setCameraMode(a,b,c,e,d){e&&"function"==typeof e&&(d=e);return this.int.call({command:p.Settings_SetCamera,nearClipPlane:a,fovH:b,minCamHeight:c,maxCamHeight:e},d)}getCameraMode(a){return this.int.call({command:p.Settings_GetCamera},a)}setMapMode(a,b,c){b=b||{};return this.int.call({command:p.Settings_SetMapMode,mode:a,serviceType:b.serviceType||0,coordType:b.coordType||0,mapPoint:b.mapPoint||[0,0],longitude:b.longitude||0,latitude:b.latitude||0,cache:b.cache||":memory:",style:b.style||"mapbox://styles/mapbox/streets-v10",
groundHeight:b.groundHeight||0,renderMode:b.renderMode||0,serverURL:b.serverURL,coordOrder:b.coordOrder,maxLevel:b.maxLevel},c)}getMapMode(a){return this.int.call0(p.Settings_GetMapMode,a)}}class Mb{constructor(a){this.int=a}startPolygonClip(a,b,c){return this.int.call({command:p.Tools_StartPolygonClip,data:F({id:"0",coordinates:N(a),toggleImageCut:b})},c)}startPlaneClip(a,b,c,e,d){return this.int.call({command:p.Tools_StartPlaneClip,location:a,rotation:b,isShowPlane:c,isEdit:e},d)}startVolumeClip(a,
b,c,e,d,h){return this.int.call({command:p.Tools_StartVolumeClip,bbox:a,rotation:d,value:b,isShowPlane:c,isEdit:e},h)}updateVolumeClip(a,b,c,e,d,h){return this.int.call({command:p.Tools_UpdateVolumeClip,bbox:a,rotation:d,value:b,isShowPlane:c,isEdit:e},h)}stopClip(a){return this.stopPolygonClip(a)}stopPolygonClip(a){return this.int.call0(p.Tools_StopClip,a)}stopPlaneClip(a){return this.int.call({command:p.Tools_StopPlaneClip},a)}stopVolumeClip(a){return this.int.call({command:p.Tools_StopVolumeClip},
a)}setMeasurement(a,b,c){b=b||{};return this.int.call({command:p.Tools_SetMeasurement,type:a,pointSize:b.pointSize,textSize:b.textSize,textColor:E(b.textColor),pointColor:E(b.pointColor),lineColor:E(b.lineColor),areaColor:E(b.areaColor),showCoordinateText:b.showCoordinateText},c)}startMeasurement(a){return this.int.call0(p.Tools_StartMeasurement,a)}stopMeasurement(a){return this.int.call0(p.Tools_StopMeasurement,a)}lineIntersect(a,b,c){return this.int.call({command:p.Tools_LineIntersect,data:[{start:a,
end:b}],highPrecision:!1,returnDetails:!0},c)}linesIntersect(a,b,c,e){return this.int.call({command:p.Tools_LineIntersect,data:F(a),highPrecision:b,returnDetails:c},e)}startGeometryEdit(a,b,c){return this.int.call({command:p.Tools_StartGeometryEdit,id:a,type:b},c)}stopGeometryEdit(a){return this.int.call0(p.Tools_StopGeometryEdit,a)}startSkylineAnalysis(a,b){a=a||{};a.outlineColor&&(a.outlineColor=E(a.outlineColor));a.sceneColor&&(a.sceneColor=E(a.sceneColor));a.skylineColor&&(a.skylineColor=E(a.skylineColor));
a.backgroundColor&&(a.backgroundColor=E(a.backgroundColor));if(a.tileLayers){a.tileLayers=F(a.tileLayers);for(let c of a.tileLayers)c.hasOwnProperty("color")&&(c.color=E(c.color))}a.command=p.Tools_StartSkylineAnalysis;return this.int.call(a,b)}stopSkylineAnalysis(a){return this.int.call0(p.Tools_StopSkylineAnalysis,a)}exportSkyline(a,b,c,e){c=c||{};c.skylineColor&&(c.skylineColor=E(c.skylineColor));c.backgroundColor&&(c.backgroundColor=E(c.backgroundColor));if(c.tileLayers){c.tileLayers=F(c.tileLayers);
for(let d of c.tileLayer)d.hasOwnProperty("color")&&(d.color=E(d.color))}return this.int.call({command:p.Tools_ExportSkyline,path:a,size:b,skylineColor:c.skylineColor,backgroundColor:c.backgroundColor},e)}startViewshedAnalysis(a,b){a=a||{};a.visibleColor&&(a.visibleColor=E(a.visibleColor));a.invisibleColor&&(a.invisibleColor=E(a.invisibleColor));a.command=p.Tools_StartViewshedAnalysis;return this.int.call(a,b)}stopViewshedAnalysis(a){return this.int.call0(p.Tools_StopViewshedAnalysis,a)}startVisiblityAnalysis(a,
b){a=a||{};a.visibleColor&&(a.visibleColor=E(a.visibleColor));a.invisibleColor&&(a.invisibleColor=E(a.invisibleColor));a.command=p.Tools_StartVisiblityAnalysis;return this.int.call(a,b)}stopVisiblityAnalysis(a){return this.int.call0(p.Tools_StopVisiblityAnalysis,a)}startViewDomeAnalysis(a,b){a=a||{};a.visibleColor&&(a.visibleColor=E(a.visibleColor));a.invisibleColor&&(a.invisibleColor=E(a.invisibleColor));a.command=p.Tools_StartViewDomeAnalysis;return this.int.call(a,b)}stopViewDomeAnalysis(a){return this.int.call0(p.Tools_StopViewDomeAnalysis,
a)}startCutFillAnalysis(a,b){a=a||{};a.cutLineColor&&(a.cutLineColor=E(a.cutLineColor));a.fillLineColor&&(a.fillLineColor=E(a.fillLineColor));a.cutPointColor&&(a.cutPointColor=E(a.cutPointColor));a.fillPointColor&&(a.fillPointColor=E(a.fillPointColor));a.gridColor&&(a.gridColor=E(a.gridColor));a.command=p.Tools_StartCutFillAnalysis;return this.int.call(a,b)}stopCutFillAnalysis(a){return this.int.call0(p.Tools_StopCutFillAnalysis,a)}startSunshineAnalysis(a,b){var c=/^(0?[0-9]|1[0-9]|[2][0-3]):(0?[0-9]|[1-5][0-9])$/;
if(null==a||void 0==a)console.error("\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a");else{let e=a.startTime,d=a.endTime;if(null==e||""==e||null==d||""==d)console.error("\u65f6\u95f4\u53c2\u6570\u683c\u5f0f\u4e0d\u6b63\u786e");else if(e.match(c)&&d.match(c))if(e.split(":"))if(a.startHour=parseInt(e.split(":")[0]),a.startMinute=parseInt(e.split(":")[1]),d.split(":"))if(a.endHour=parseInt(d.split(":")[0]),a.endMinute=parseInt(d.split(":")[1]),a.startHour>a.endHour)console.error("\u5f00\u59cb\u65f6\u95f4\u4e0d\u80fd\u5927\u4e8e\u7ed3\u675f\u65f6\u95f4");
else{if(a.startHour==a.endHour){if(a.startMinute==a.endMinute){console.error("\u5f00\u59cb\u65f6\u95f4\u4e0d\u80fd\u7b49\u4e8e\u7ed3\u675f\u65f6\u95f4");return}if(a.startMinute>a.endMinute){console.error("\u5f00\u59cb\u65f6\u95f4\u4e0d\u80fd\u5927\u4e8e\u7ed3\u675f\u65f6\u95f4");return}}ia(a.groundElevation)||(c=a.groundElevation,!isNaN(parseFloat(c))&&isFinite(c)&&(a.undersideHeight=a.groundElevation,delete a.groundElevation));a.command=p.Tools_StartSunshineAnalysis;return this.int.call(a,b)}else console.error("\u53c2\u6570endTime\u65f6\u95f4\u683c\u5f0f\u4e0d\u6b63\u786e");
else console.error("\u53c2\u6570startTime\u65f6\u95f4\u683c\u5f0f\u4e0d\u6b63\u786e");else console.error("\u65f6\u95f4\u53c2\u6570\u683c\u5f0f\u4e0d\u6b63\u786e")}}stopSunshineAnalysis(a){return this.int.call0(p.Tools_StopSunshineAnalysis,a)}startTerrainSlopeAnalysis(a,b){a.command=p.Tools_StartTerrainSlopeAnalysis;return this.int.call(a,b)}stopTerrainSlopeAnalysis(a){return this.int.call0(p.Tools_StopTerrainSlopeAnalysis,a)}startContourLineAnalysis(a,b){a.command=p.Tools_StartContourLineAnalysis;
return this.int.call(a,b)}stopContourLineAnalysis(a){return this.int.call0(p.Tools_StopContourLineAnalysis,a)}startFloodFill(a,b){a=a||{};a.color&&(a.color=E(a.color));a.command=p.Tools_StartFloodFill;return this.int.call(a,b)}stopFloodFill(a){return this.int.call0(p.Tools_StopFloodFill,a)}replaceTextureByVideo(a,b,c){return this.int.call({command:p.Tools_ReplaceTexture,texturePackage:a,newTexture:b,type:1},c)}replaceTextureByImage(a,b,c){return this.int.call({command:p.Tools_ReplaceTexture,texturePackage:a,
newTexture:b,type:2},c)}replaceTextureByUrl(a,b,c){return this.int.call({command:p.Tools_ReplaceTexture,texturePackage:a,newTexture:b,type:3},c)}restoreTexture(a,b){return this.int.call({command:p.Tools_RestoreTexture,ids:F(a)},b)}showPanel(a,b,c){this.showAnalysisPanel(a,b,c)}hidePanel(a){this.hideAnalysisPanel(a)}showAnalysisPanel(a,b,c){return this.int.call({command:p.Tools_AnalysisPopupAttributes,type:a,position:b},c)}hideAnalysisPanel(a){return this.int.call({command:p.Tools_AnalysisCloseAttributes},
a)}}class Nb{constructor(a){this.int=a}getParams(a){return this.int.call0(p.Weather_GetParams,a)}_setParam(a,b){return this.int.call({command:p.Weather_SetParams,data:a},b)}setDateTime(a,b,c,e,d,h,g){return this.int.call({command:p.Weather_SetDate,year:a,month:b,day:c,hour:e,minute:d,daynightLoop:h},g)}getDateTime(a){return this.int.call0(p.Weather_GetDate,a)}simulateTime(a,b,c,e){let d=0,h=0,g=0,r=0;a instanceof Array?(0<a.length&&(d=a[0]),1<a.length&&(h=a[1])):d=parseInt(a);b instanceof Array?(0<
b.length&&(g=b[0]),1<b.length&&(r=b[1])):g=parseInt(b);return this.int.call({command:p.Weather_SimulateTime,startHour:d,startMinute:h,endHour:g,endMinute:r,duration:c},e)}setCloudThickness(a,b){return this.int.call({command:p.Weather_SetParams,cloudThickness:a},b)}setCloudDensity(a,b){return this.int.call({command:p.Weather_SetParams,cloudDensity:a},b)}setCloudHeight(a,b){return this.int.call({command:p.Weather_SetParams,cloudHeight:a},b)}setRainParam(a,b,c,e){return this.int.call({command:p.Weather_SetParams,
rainsnow:0,rainsnowStrength:a,rainsnowSpeed:b,raindropSize:c},e)}setSnowParam(a,b,c,e){return this.int.call({command:p.Weather_SetParams,rainsnow:1,rainsnowStrength:a,rainsnowSpeed:b,snowflakeSize:c},e)}disableRainSnow(a){return this.int.call({command:p.Weather_SetParams,rainsnowStrength:0},a)}setFogParam(a,b,c,e,d){return this.int.call({command:p.Weather_SetParams,fogDensity:a,fogGroundDensity:b,fogGroundHeight:c,fogDistance:e},d)}setSunIntensity(a,b){return this.int.call({command:p.Weather_SetParams,
sunIntensity:a},b)}setMoonIntensity(a,b){return this.int.call({command:p.Weather_SetParams,moonIntensity:a},b)}setAmbientLightIntensity(a,b){return this.int.call({command:p.Weather_SetParams,ambientLightIntensity:a},b)}setTemperature(a,b){return this.int.call({command:p.Weather_SetParams,temperature:a},b)}setShadowQuality(a,b){return this.int.call({command:p.Weather_SetParams,shadowQuality:a},b)}setShadowDistance(a,b){return this.int.call({command:p.Weather_SetParams,shadowDistance:a},b)}setDarkMode(a,
b){return this.int.call({command:p.Weather_SetParams,darkMode:!!a},b)}}var sa=null;class qa{constructor(a,b){sa=this;this.options=b||{};this.player=this.options.player;"function"==typeof qa.__onApiConstructed&&qa.__onApiConstructed(this);this.isConnected=this.isCalledInCEF="object"==typeof ue&&"object"==typeof ue.dtspoi;this.callbackMap=new Map;this.websocket=null;this.callbackIndex=0;this.tickMarkerId="___tick_delegate_marker___";!this.player&&a&&(this.url=`ws://${a}`,this.connectWebSocket());this.initInterface();
this.apiQueue=new cb(c=>this.sendAPI(c))}setHost(a,b){this.url=`ws://${a}:${b}`}connectWebSocket(){if(!this.player){this.log(`Connecting: ${this.url}`);if("undefined"==typeof window)this.websocket=new (require("ws"))(this.url);else{if(!("WebSocket"in window)){console.error("Not Support WebSocket!");return}this.websocket=new WebSocket(this.url)}this.websocket.onopen=()=>this.onConnectionOpen();this.websocket.onmessage=a=>this.onConnectionMessage(a.data);this.websocket.onclose=a=>this.onConnectionClose(a);
this.websocket.onerror=a=>this.onConnectionError(a)}}setEventCallback(a){this.options.onEvent=a}destroy(){this.isDestroyed=!0;this.player&&this.player.destroy();this.websocket&&(this.websocket.close(),this.websocket=null)}reset(a){return this.call0(p.Reset,a)}registerTick(a,b){this.removeTick();a={id:this.tickMarkerId,coordinate:[0,0,0],popupURL:a,popupSize:[4,4],autoHidePopupWindow:!1,displayMode:2,priority:0,occlusionCull:!1};b&&(a.coordinate=[495269,2491073,25],a.coordinateType=0,a.range=[1,1E5],
a.text="TickMarker",a.textRange=[1,1E5],a.popupSize=[200,200],a.showLine=!0);this.marker.add(a,c=>this.marker.showPopupWindow(this.tickMarkerId))}removeTick(){this.marker.hidePopupWindow(this.tickMarkerId)}getVersion(){return"5.3.1114"}initInterface(){this.camera=new Fb(this);this.coord=new Gb(this);this.layers=this.infoTree=new Ib(this);this.ct=this.cameraTour=new eb(this);this.tl=this.tileLayer=new Ab(this);this.tag=new zb(this);this.marker=new qb(this);this.marker3d=new rb(this);this.ctag=this.customTag=
new ib(this);this.rp=this.radiationPoint=new xb(this);this.cm=this.customMesh=new gb(this);this.wm=this.waterMesh=new Db(this);this.waterFlowField=new Cb(this);this.wff=this.WaterFlowField;this.line=this.polyline=new wb(this);this.ol=this.odline=new sb(this);this.p3d=this.polygon3d=new vb(this);this.polygon=new ub(this);this.hm=this.heatmap=new mb(this);this.hm3d=this.heatmap3d=new nb(this);this.beam=new db(this);this.ha=this.highlightArea=new ob(this);this.co=this.customObject=new hb(this);this.vp=
this.videoProjection=new Bb(this);this.panorama=new tb(this);this.decal=new jb(this);this.dw=this.dynamicWater=new kb(this);this.ff=this.floodFill=new lb(this);this.c3d=this.cesium3DTileset=new fb(this);this.shapeFile=this.shp=this.shapeFileLayer=new yb(this);this.imagery=this.imageryLayer=new Eb(this);this.misc=new Jb(this);this.tools=new Mb(this);this.settings=new Kb(this);this.weather=new Nb(this);this.light=new pb(this);this.eh=this.editHelper=new Hb(this);this.sp=this.settingsPanel=new Lb(this)}_getCallbackIndex(){return++this.callbackIndex}call0(a,
b){return this.call({command:a},b)}call(a,b){if(!this.isConnected)return this.logWithColor("red","Not connected!"),b?void 0:Promise.reject("Not connected!");if(void 0==a.command||a.command==p.None)return this.logWithColor("red","command is undefined or None"),b?void 0:Promise.reject("command is undefined or None");a.timestamp=Date.now();a.callbackIndex=this._getCallbackIndex();a.__command=p[a.command]||"Unknown";a.__version=this.getVersion();null===b&&(a.__noResponse=!0);let c=a.command+"_"+a.callbackIndex;
b&&"function"==typeof b&&(this.callbackMap[c]=b);let e=JSON.stringify(a);this.log("");this.logWithColor("RoyalBlue",`Request: ${p[a.command]||"Unknown"}`,!0);this.logWithColor("green","\uff08"+(new Date(a.timestamp)).toLocaleTimeString()+"\uff09");this.logWithColor("gray",`${e}`);if(b||null===b)this.apiQueue.push(a);else return new Promise(d=>{this.callbackMap[c]=d;this.apiQueue.push(a)})}sendAPI(a){a&&(this.isCalledInCEF?ue.dtspoi.execute(JSON.stringify(a)):this.player?this.player.rtc&&this.player.rtc.sendAPI(a):
this.sendStringByWS(JSON.stringify(a)))}sendStringByWS(a){let b=a.length;if(16777216>=b)this.websocket.send(a);else{var c=Math.ceil(b/16777216),e=[];for(let d=0;d<c;d++)e[d]=(0==d?"__MI_SECTION_START__":d==c-1?"__MI_SECTION_END__":"__MI_SECTION__")+a.substr(16777216*d,d==c-1?b-16777216*d:16777216);for(let d of e)this.websocket.send(d)}}viewHome(a){switch(a){case 0:this.savedCamera?this.camera.set(this.savedCamera,0):this.initialCameraPosition&&this.camera.set(this.initialCameraPosition,0);break;case 1:this.savedCamera=
null;this.viewHome(0);break;case 2:this.camera.get(b=>this.savedCamera=b.camera)}}onReady(){if("function"==typeof this.options.onReady)this.options.onReady();this.call({command:p.Misc_GetVersion});if(this.player)this.player.onApiReady()}log(a,b,c){if("function"==typeof this.options.onLog)this.options.onLog(a,b,c)}logWithColor(a,b,c){"function"==typeof this.options.onLog&&(this.options.useColorLog?this.log(`<font color='${a}'>${b}</font>`,c):this.log(b,c))}onConnectionOpen(){this.isConnected=!0;this.logWithColor("blue",
"Connected!")}onConnectionClose(a){this.isConnected=!1;this.logWithColor("red",`Connection closed! code: ${a.code||"-"}, reason: ${1006==a.code?"\u8fde\u63a5\u65ad\u5f00":a.reason||a.message||"-"}`);this.log("");this.logWithColor("SpringGreen","Reconnecting...");this.isDestroyed||this.player||this.connectWebSocket()}onConnectionError(a){console.error("WebSocket error observed")}onConnectionMessage(a){this.log("");let b=null;try{b=JSON.parse(a)}catch(e){console.error(e.message);this.log("Response: [Unknown]");
return}if(b.command==p.Misc_GetVersion){this.misc.apiVersionServer=b.version||b.versionType;if("5.3"!=this.misc.apiVersionServer){var c=`\u8b66\u544a\uff1a\n--------------------------------------------------\n    ac.min.js\u6587\u4ef6\u7248\u672c\uff08${"5.3"}\uff09\u548c\u4e91\u6e32\u67d3\u670d\u52a1\u5668\u7248\u672c\uff08${this.misc.apiVersionServer}\uff09\u4e0d\u4e00\u81f4\uff0c\n    \u53ef\u80fd\u9020\u6210\u63a5\u53e3\u8c03\u7528\u9519\u8bef\u6216\u5d29\u6e83\uff0c\u8bf7\u786e\u8ba4!`;console.warn(c);
"undefined"!=typeof window&&alert(c)}if("function"==typeof this.options.onApiVersion)this.options.onApiVersion(this.misc.apiVersionServer)}if(b.command){this.apiQueue.callNext(b.callbackIndex);c=Date.now()-b.timestamp;this.logWithColor("RoyalBlue",`Response: ${p[b.command]||"Unknown"}`,!0);this.logWithColor("green",`\uff08\u8017\u65f6\uff1a${c}ms\uff09`);this.logWithColor("gray",`\u8bf7\u6c42\u65f6\u95f4\uff1a${(new Date(b.timestamp)).toLocaleTimeString()}`,!0);this.logWithColor("gray",`  \u54cd\u5e94\u65f6\u95f4\uff1a${(new Date(Date.now())).toLocaleTimeString()}`);
c=b.command+"_"+b.callbackIndex;let e=this.callbackMap[c];e&&(e(b),delete this.callbackMap[c])}else if(b.eventtype)if(this.log("Response: Event"),"CompleteInitialization"==b.eventtype)this.log("The initialization is complete, now you can call the interfaces in onReady callback function."),this.initialCameraPosition=b.InitialCamera,b.ResourcesPath&&(this.resourcesPath=b.ResourcesPath,this.log("ResourcesPath:"+this.resourcesPath)),this.onReady();else if("NodeConfiguration"==b.eventtype)this.resourcesPath=
b.ResourcesPath,this.log("ResourcesPath:"+this.resourcesPath);else if("MainThreadBusy"==b.eventtype)this.apiQueue.onMainThreadBusy(b),this.player&&this.player.onMainThreadBusy(b);else{if("function"==typeof this.options.onEvent)this.options.onEvent(b)}else this.log("Response: [Unknown]");this.logWithColor("gray",a)}quit(){return this.call0(p.Quit)}test(a,b,c){return this.call({command:p.SimulateTest__,type:a,int32Val:b},c)}}(function(a){"object"===typeof w&&"undefined"!==typeof module?module.exports=
a():"function"===typeof define&&define.amd?define([],a):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).adapter=a()})(function(){return function(){function a(b,c,e){function d(r,k){if(!c[r]){if(!b[r]){var f="function"==typeof require&&require;if(!k&&f)return f(r,!0);if(h)return h(r,!0);k=Error("Cannot find module '"+r+"'");throw k.code="MODULE_NOT_FOUND",k;}k=c[r]={exports:{}};b[r][0].call(k.exports,function(l){return d(b[r][1][l]||l)},k,
k.exports,a,b,c,e)}return c[r].exports}for(var h="function"==typeof require&&require,g=0;g<e.length;g++)d(e[g]);return d}return a}()({1:[function(a,b,c){a=(0,a("./adapter_factory.js").adapterFactory)({window:"undefined"==typeof window?{}:window});b.exports=a},{"./adapter_factory.js":2}],2:[function(a,b,c){function e(l){if(l&&l.__esModule)return l;var t={};if(null!=l)for(var v in l)Object.prototype.hasOwnProperty.call(l,v)&&(t[v]=l[v]);t.default=l;return t}Object.defineProperty(c,"__esModule",{value:!0});
c.adapterFactory=function(){var l=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},v=d.log,q=d.detectBrowser(l),y={browserDetails:q,commonShim:f,extractVersion:d.extractVersion,disableLog:d.disableLog,disableWarnings:d.disableWarnings};switch(q.browser){case "chrome":if(!h||!h.shimPeerConnection||!t.shimChrome){v("Chrome shim is not included in this adapter release.");
break}if(null===q.version){v("Chrome shim can not determine version, not shimming.");break}v("adapter.js shimming chrome.");y.browserShim=h;h.shimGetUserMedia(l);h.shimMediaStream(l);h.shimPeerConnection(l);h.shimOnTrack(l);h.shimAddTrackRemoveTrack(l);h.shimGetSendersWithDtmf(l);h.shimGetStats(l);h.shimSenderReceiverGetStats(l);h.fixNegotiationNeeded(l);f.shimRTCIceCandidate(l);f.shimConnectionState(l);f.shimMaxMessageSize(l);f.shimSendThrowTypeError(l);f.removeAllowExtmapMixed(l);break;case "firefox":if(!r||
!r.shimPeerConnection||!t.shimFirefox){v("Firefox shim is not included in this adapter release.");break}v("adapter.js shimming firefox.");y.browserShim=r;r.shimGetUserMedia(l);r.shimPeerConnection(l);r.shimOnTrack(l);r.shimRemoveStream(l);r.shimSenderGetStats(l);r.shimReceiverGetStats(l);r.shimRTCDataChannel(l);r.shimAddTransceiver(l);r.shimGetParameters(l);r.shimCreateOffer(l);r.shimCreateAnswer(l);f.shimRTCIceCandidate(l);f.shimConnectionState(l);f.shimMaxMessageSize(l);f.shimSendThrowTypeError(l);
break;case "edge":if(!g||!g.shimPeerConnection||!t.shimEdge){v("MS edge shim is not included in this adapter release.");break}v("adapter.js shimming edge.");y.browserShim=g;g.shimGetUserMedia(l);g.shimGetDisplayMedia(l);g.shimPeerConnection(l);g.shimReplaceTrack(l);f.shimMaxMessageSize(l);f.shimSendThrowTypeError(l);break;case "safari":if(!k||!t.shimSafari){v("Safari shim is not included in this adapter release.");break}v("adapter.js shimming safari.");y.browserShim=k;k.shimRTCIceServerUrls(l);k.shimCreateOfferLegacy(l);
k.shimCallbacksAPI(l);k.shimLocalStreamsAPI(l);k.shimRemoteStreamsAPI(l);k.shimTrackEventTransceiver(l);k.shimGetUserMedia(l);k.shimAudioContext(l);f.shimRTCIceCandidate(l);f.shimMaxMessageSize(l);f.shimSendThrowTypeError(l);f.removeAllowExtmapMixed(l);break;default:v("Unsupported browser!")}return y};b=a("./utils");var d=e(b);b=a("./chrome/chrome_shim");var h=e(b);b=a("./edge/edge_shim");var g=e(b);b=a("./firefox/firefox_shim");var r=e(b);b=a("./safari/safari_shim");var k=e(b);a=a("./common_shim");
var f=e(a)},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(a,b,c){function e(f,l,t){l in f?Object.defineProperty(f,l,{value:t,enumerable:!0,configurable:!0,writable:!0}):f[l]=t;return f}function d(f){f.RTCPeerConnection.prototype.getLocalStreams=function(){var y=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};return Object.keys(this._shimmedLocalStreams).map(function(u){return y._shimmedLocalStreams[u][0]})};
var l=f.RTCPeerConnection.prototype.addTrack;f.RTCPeerConnection.prototype.addTrack=function(y,u){if(!u)return l.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var A=l.apply(this,arguments);this._shimmedLocalStreams[u.id]?-1===this._shimmedLocalStreams[u.id].indexOf(A)&&this._shimmedLocalStreams[u.id].push(A):this._shimmedLocalStreams[u.id]=[u,A];return A};var t=f.RTCPeerConnection.prototype.addStream;f.RTCPeerConnection.prototype.addStream=function(y){var u=this;this._shimmedLocalStreams=
this._shimmedLocalStreams||{};y.getTracks().forEach(function(n){if(u.getSenders().find(function(x){return x.track===n}))throw new DOMException("Track already exists.","InvalidAccessError");});var A=this.getSenders();t.apply(this,arguments);var m=this.getSenders().filter(function(n){return-1===A.indexOf(n)});this._shimmedLocalStreams[y.id]=[y].concat(m)};var v=f.RTCPeerConnection.prototype.removeStream;f.RTCPeerConnection.prototype.removeStream=function(y){this._shimmedLocalStreams=this._shimmedLocalStreams||
{};delete this._shimmedLocalStreams[y.id];return v.apply(this,arguments)};var q=f.RTCPeerConnection.prototype.removeTrack;f.RTCPeerConnection.prototype.removeTrack=function(y){var u=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};y&&Object.keys(this._shimmedLocalStreams).forEach(function(A){var m=u._shimmedLocalStreams[A].indexOf(y);-1!==m&&u._shimmedLocalStreams[A].splice(m,1);1===u._shimmedLocalStreams[A].length&&delete u._shimmedLocalStreams[A]});return q.apply(this,arguments)}}Object.defineProperty(c,
"__esModule",{value:!0});c.shimGetDisplayMedia=c.shimGetUserMedia=void 0;var h="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(f){return typeof f}:function(f){return f&&"function"===typeof Symbol&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},g=a("./getusermedia");Object.defineProperty(c,"shimGetUserMedia",{enumerable:!0,get:function(){return g.shimGetUserMedia}});var r=a("./getdisplaymedia");Object.defineProperty(c,"shimGetDisplayMedia",{enumerable:!0,get:function(){return r.shimGetDisplayMedia}});
c.shimMediaStream=function(f){f.MediaStream=f.MediaStream||f.webkitMediaStream};c.shimOnTrack=function(f){if("object"!==("undefined"===typeof f?"undefined":h(f))||!f.RTCPeerConnection||"ontrack"in f.RTCPeerConnection.prototype)k.wrapPeerConnectionEvent(f,"track",function(t){t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}});return t});else{Object.defineProperty(f.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(t){this._ontrack&&
this.removeEventListener("track",this._ontrack);this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});var l=f.RTCPeerConnection.prototype.setRemoteDescription;f.RTCPeerConnection.prototype.setRemoteDescription=function(){var t=this;this._ontrackpoly||(this._ontrackpoly=function(v){v.stream.addEventListener("addtrack",function(q){var y=void 0;y=f.RTCPeerConnection.prototype.getReceivers?t.getReceivers().find(function(A){return A.track&&A.track.id===q.track.id}):{track:q.track};
var u=new Event("track");u.track=q.track;u.receiver=y;u.transceiver={receiver:y};u.streams=[v.stream];t.dispatchEvent(u)});v.stream.getTracks().forEach(function(q){var y=void 0;y=f.RTCPeerConnection.prototype.getReceivers?t.getReceivers().find(function(A){return A.track&&A.track.id===q.id}):{track:q};var u=new Event("track");u.track=q;u.receiver=y;u.transceiver={receiver:y};u.streams=[v.stream];t.dispatchEvent(u)})},this.addEventListener("addstream",this._ontrackpoly));return l.apply(this,arguments)}}};
c.shimGetSendersWithDtmf=function(f){if("object"===("undefined"===typeof f?"undefined":h(f))&&f.RTCPeerConnection&&!("getSenders"in f.RTCPeerConnection.prototype)&&"createDTMFSender"in f.RTCPeerConnection.prototype){var l=function(A,m){return{track:m,get dtmf(){void 0===this._dtmf&&(this._dtmf="audio"===m.kind?A.createDTMFSender(m):null);return this._dtmf},_pc:A}};if(!f.RTCPeerConnection.prototype.getSenders){f.RTCPeerConnection.prototype.getSenders=function(){this._senders=this._senders||[];return this._senders.slice()};
var t=f.RTCPeerConnection.prototype.addTrack;f.RTCPeerConnection.prototype.addTrack=function(A,m){var n=t.apply(this,arguments);n||(n=l(this,A),this._senders.push(n));return n};var v=f.RTCPeerConnection.prototype.removeTrack;f.RTCPeerConnection.prototype.removeTrack=function(A){v.apply(this,arguments);var m=this._senders.indexOf(A);-1!==m&&this._senders.splice(m,1)}}var q=f.RTCPeerConnection.prototype.addStream;f.RTCPeerConnection.prototype.addStream=function(A){var m=this;this._senders=this._senders||
[];q.apply(this,[A]);A.getTracks().forEach(function(n){m._senders.push(l(m,n))})};var y=f.RTCPeerConnection.prototype.removeStream;f.RTCPeerConnection.prototype.removeStream=function(A){var m=this;this._senders=this._senders||[];y.apply(this,[A]);A.getTracks().forEach(function(n){var x=m._senders.find(function(z){return z.track===n});x&&m._senders.splice(m._senders.indexOf(x),1)})}}else if("object"===("undefined"===typeof f?"undefined":h(f))&&f.RTCPeerConnection&&"getSenders"in f.RTCPeerConnection.prototype&&
"createDTMFSender"in f.RTCPeerConnection.prototype&&f.RTCRtpSender&&!("dtmf"in f.RTCRtpSender.prototype)){var u=f.RTCPeerConnection.prototype.getSenders;f.RTCPeerConnection.prototype.getSenders=function(){var A=this,m=u.apply(this,[]);m.forEach(function(n){return n._pc=A});return m};Object.defineProperty(f.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null);return this._dtmf}})}};c.shimGetStats=function(f){if(f.RTCPeerConnection){var l=
f.RTCPeerConnection.prototype.getStats;f.RTCPeerConnection.prototype.getStats=function(){var t=this,v=Array.prototype.slice.call(arguments),q=v[0],y=v[1];v=v[2];if(0<arguments.length&&"function"===typeof q)return l.apply(this,arguments);if(0===l.length&&(0===arguments.length||"function"!==typeof q))return l.apply(this,[]);var u=function(m){var n={};m.result().forEach(function(x){var z={id:x.id,timestamp:x.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[x.type]||
x.type};x.names().forEach(function(B){z[B]=x.stat(B)});n[z.id]=z});return n},A=function(m){return new Map(Object.keys(m).map(function(n){return[n,m[n]]}))};return 2<=arguments.length?l.apply(this,[function(m){y(A(u(m)))},q]):(new Promise(function(m,n){l.apply(t,[function(x){m(A(u(x)))},n])})).then(y,v)}}};c.shimSenderReceiverGetStats=function(f){if("object"===("undefined"===typeof f?"undefined":h(f))&&f.RTCPeerConnection&&f.RTCRtpSender&&f.RTCRtpReceiver){if(!("getStats"in f.RTCRtpSender.prototype)){var l=
f.RTCPeerConnection.prototype.getSenders;l&&(f.RTCPeerConnection.prototype.getSenders=function(){var y=this,u=l.apply(this,[]);u.forEach(function(A){return A._pc=y});return u});var t=f.RTCPeerConnection.prototype.addTrack;t&&(f.RTCPeerConnection.prototype.addTrack=function(){var y=t.apply(this,arguments);y._pc=this;return y});f.RTCRtpSender.prototype.getStats=function(){var y=this;return this._pc.getStats().then(function(u){return k.filterStats(u,y.track,!0)})}}if(!("getStats"in f.RTCRtpReceiver.prototype)){var v=
f.RTCPeerConnection.prototype.getReceivers;v&&(f.RTCPeerConnection.prototype.getReceivers=function(){var y=this,u=v.apply(this,[]);u.forEach(function(A){return A._pc=y});return u});k.wrapPeerConnectionEvent(f,"track",function(y){y.receiver._pc=y.srcElement;return y});f.RTCRtpReceiver.prototype.getStats=function(){var y=this;return this._pc.getStats().then(function(u){return k.filterStats(u,y.track,!1)})}}if("getStats"in f.RTCRtpSender.prototype&&"getStats"in f.RTCRtpReceiver.prototype){var q=f.RTCPeerConnection.prototype.getStats;
f.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof f.MediaStreamTrack){var y=arguments[0],u=void 0,A=void 0,m=void 0;this.getSenders().forEach(function(n){n.track===y&&(u?m=!0:u=n)});this.getReceivers().forEach(function(n){n.track===y&&(A?m=!0:A=n);return n.track===y});return m||u&&A?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):u?u.getStats():A?A.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.",
"InvalidAccessError"))}return q.apply(this,arguments)}}}};c.shimAddTrackRemoveTrackWithNative=d;c.shimAddTrackRemoveTrack=function(f){function l(n,x){var z=x.sdp;Object.keys(n._reverseStreams||[]).forEach(function(B){B=n._reverseStreams[B];z=z.replace(new RegExp(n._streams[B.id].id,"g"),B.id)});return new RTCSessionDescription({type:x.type,sdp:z})}function t(n,x){var z=x.sdp;Object.keys(n._reverseStreams||[]).forEach(function(B){B=n._reverseStreams[B];z=z.replace(new RegExp(B.id,"g"),n._streams[B.id].id)});
return new RTCSessionDescription({type:x.type,sdp:z})}if(f.RTCPeerConnection){var v=k.detectBrowser(f);if(f.RTCPeerConnection.prototype.addTrack&&65<=v.version)return d(f);var q=f.RTCPeerConnection.prototype.getLocalStreams;f.RTCPeerConnection.prototype.getLocalStreams=function(){var n=this,x=q.apply(this);this._reverseStreams=this._reverseStreams||{};return x.map(function(z){return n._reverseStreams[z.id]})};var y=f.RTCPeerConnection.prototype.addStream;f.RTCPeerConnection.prototype.addStream=function(n){var x=
this;this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};n.getTracks().forEach(function(B){if(x.getSenders().find(function(C){return C.track===B}))throw new DOMException("Track already exists.","InvalidAccessError");});if(!this._reverseStreams[n.id]){var z=new f.MediaStream(n.getTracks());this._streams[n.id]=z;this._reverseStreams[z.id]=n;n=z}y.apply(this,[n])};var u=f.RTCPeerConnection.prototype.removeStream;f.RTCPeerConnection.prototype.removeStream=function(n){this._streams=
this._streams||{};this._reverseStreams=this._reverseStreams||{};u.apply(this,[this._streams[n.id]||n]);delete this._reverseStreams[this._streams[n.id]?this._streams[n.id].id:n.id];delete this._streams[n.id]};f.RTCPeerConnection.prototype.addTrack=function(n,x){var z=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var B=[].slice.call(arguments,1);if(1!==B.length||!B[0].getTracks().find(function(C){return C===n}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.",
"NotSupportedError");if(this.getSenders().find(function(C){return C.track===n}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};(B=this._streams[x.id])?(B.addTrack(n),Promise.resolve().then(function(){z.dispatchEvent(new Event("negotiationneeded"))})):(B=new f.MediaStream([n]),this._streams[x.id]=B,this._reverseStreams[B.id]=x,this.addStream(B));return this.getSenders().find(function(C){return C.track===
n})};["createOffer","createAnswer"].forEach(function(n){var x=f.RTCPeerConnection.prototype[n],z=e({},n,function(){var B=this,C=arguments;return arguments.length&&"function"===typeof arguments[0]?x.apply(this,[function(G){G=l(B,G);C[0].apply(null,[G])},function(G){C[1]&&C[1].apply(null,G)},arguments[2]]):x.apply(this,arguments).then(function(G){return l(B,G)})});f.RTCPeerConnection.prototype[n]=z[n]});var A=f.RTCPeerConnection.prototype.setLocalDescription;f.RTCPeerConnection.prototype.setLocalDescription=
function(){if(!arguments.length||!arguments[0].type)return A.apply(this,arguments);arguments[0]=t(this,arguments[0]);return A.apply(this,arguments)};var m=Object.getOwnPropertyDescriptor(f.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(f.RTCPeerConnection.prototype,"localDescription",{get:function(){var n=m.get.apply(this);return""===n.type?n:l(this,n)}});f.RTCPeerConnection.prototype.removeTrack=function(n){var x=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.",
"InvalidStateError");if(!n._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(n._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var z=void 0;Object.keys(this._streams).forEach(function(B){x._streams[B].getTracks().find(function(C){return n.track===C})&&(z=x._streams[B])});z&&(1===z.getTracks().length?this.removeStream(this._reverseStreams[z.id]):
z.removeTrack(n.track),this.dispatchEvent(new Event("negotiationneeded")))}}};c.shimPeerConnection=function(f){var l=k.detectBrowser(f);!f.RTCPeerConnection&&f.webkitRTCPeerConnection&&(f.RTCPeerConnection=f.webkitRTCPeerConnection);if(f.RTCPeerConnection){var t=0===f.RTCPeerConnection.prototype.addIceCandidate.length;53>l.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(q){var y=f.RTCPeerConnection.prototype[q],u=e({},q,function(){arguments[0]=new ("addIceCandidate"===
q?f.RTCIceCandidate:f.RTCSessionDescription)(arguments[0]);return y.apply(this,arguments)});f.RTCPeerConnection.prototype[q]=u[q]});var v=f.RTCPeerConnection.prototype.addIceCandidate;f.RTCPeerConnection.prototype.addIceCandidate=function(){return t||arguments[0]?78>l.version&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():v.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};c.fixNegotiationNeeded=function(f){var l=k.detectBrowser(f);k.wrapPeerConnectionEvent(f,
"negotiationneeded",function(t){var v=t.target;if(!(72>l.version||v.getConfiguration&&"plan-b"===v.getConfiguration().sdpSemantics)||"stable"===v.signalingState)return t})};var k=function(f){if(f&&f.__esModule)return f;var l={};if(null!=f)for(var t in f)Object.prototype.hasOwnProperty.call(f,t)&&(l[t]=f[t]);l.default=f;return l}(a("../utils.js"))},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});c.shimGetDisplayMedia=
function(e,d){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||!e.navigator.mediaDevices||("function"!==typeof d?console.error("shimGetDisplayMedia: getSourceId argument is not a function"):e.navigator.mediaDevices.getDisplayMedia=function(h){return d(h).then(function(g){var r=h.video&&h.video.width,k=h.video&&h.video.height;h.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:g,maxFrameRate:h.video&&h.video.frameRate||3}};r&&(h.video.mandatory.maxWidth=r);k&&
(h.video.mandatory.maxHeight=k);return e.navigator.mediaDevices.getUserMedia(h)})})}},{}],5:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});var e="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"===typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g};c.shimGetUserMedia=function(g){var r=g&&g.navigator;if(r.mediaDevices){var k=d.detectBrowser(g),f=function(q){if("object"!==("undefined"===
typeof q?"undefined":e(q))||q.mandatory||q.optional)return q;var y={};Object.keys(q).forEach(function(u){if("require"!==u&&"advanced"!==u&&"mediaSource"!==u){var A="object"===e(q[u])?q[u]:{ideal:q[u]};void 0!==A.exact&&"number"===typeof A.exact&&(A.min=A.max=A.exact);var m=function(x,z){return x?x+z.charAt(0).toUpperCase()+z.slice(1):"deviceId"===z?"sourceId":z};if(void 0!==A.ideal){y.optional=y.optional||[];var n={};"number"===typeof A.ideal?(n[m("min",u)]=A.ideal,y.optional.push(n),n={},n[m("max",
u)]=A.ideal):n[m("",u)]=A.ideal;y.optional.push(n)}void 0!==A.exact&&"number"!==typeof A.exact?(y.mandatory=y.mandatory||{},y.mandatory[m("",u)]=A.exact):["min","max"].forEach(function(x){void 0!==A[x]&&(y.mandatory=y.mandatory||{},y.mandatory[m(x,u)]=A[x])})}});q.advanced&&(y.optional=(y.optional||[]).concat(q.advanced));return y},l=function(q,y){if(61<=k.version)return y(q);if((q=JSON.parse(JSON.stringify(q)))&&"object"===e(q.audio)){var u=function(n,x,z){x in n&&!(z in n)&&(n[z]=n[x],delete n[x])};
q=JSON.parse(JSON.stringify(q));u(q.audio,"autoGainControl","googAutoGainControl");u(q.audio,"noiseSuppression","googNoiseSuppression");q.audio=f(q.audio)}if(q&&"object"===e(q.video)){var A=q.video.facingMode;A=A&&("object"===("undefined"===typeof A?"undefined":e(A))?A:{ideal:A});u=66>k.version;if(!(!A||"user"!==A.exact&&"environment"!==A.exact&&"user"!==A.ideal&&"environment"!==A.ideal||r.mediaDevices.getSupportedConstraints&&r.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete q.video.facingMode;
var m=void 0;if("environment"===A.exact||"environment"===A.ideal)m=["back","rear"];else if("user"===A.exact||"user"===A.ideal)m=["front"];if(m)return r.mediaDevices.enumerateDevices().then(function(n){n=n.filter(function(z){return"videoinput"===z.kind});var x=n.find(function(z){return m.some(function(B){return z.label.toLowerCase().includes(B)})});!x&&n.length&&m.includes("back")&&(x=n[n.length-1]);x&&(q.video.deviceId=A.exact?{exact:x.deviceId}:{ideal:x.deviceId});q.video=f(q.video);h("chrome: "+
JSON.stringify(q));return y(q)})}q.video=f(q.video)}h("chrome: "+JSON.stringify(q));return y(q)},t=function(q){return 64<=k.version?q:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",
ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[q.name]||q.name,message:q.message,constraint:q.constraint||q.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};r.getUserMedia=function(q,y,u){l(q,function(A){r.webkitGetUserMedia(A,y,function(m){u&&u(t(m))})})}.bind(r);if(r.mediaDevices.getUserMedia){var v=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(q){return l(q,function(y){return v(y).then(function(u){if(y.audio&&
!u.getAudioTracks().length||y.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(function(A){A.stop()}),new DOMException("","NotFoundError");return u},function(u){return Promise.reject(t(u))})})}}}};var d=function(g){if(g&&g.__esModule)return g;var r={};if(null!=g)for(var k in g)Object.prototype.hasOwnProperty.call(g,k)&&(r[k]=g[k]);r.default=g;return r}(a("../utils.js")),h=d.log},{"../utils.js":15}],6:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});var e="function"===
typeof Symbol&&"symbol"===typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"===typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g};c.shimRTCIceCandidate=function(g){if(g.RTCIceCandidate&&!(g.RTCIceCandidate&&"foundation"in g.RTCIceCandidate.prototype)){var r=g.RTCIceCandidate;g.RTCIceCandidate=function(k){"object"===("undefined"===typeof k?"undefined":e(k))&&k.candidate&&0===k.candidate.indexOf("a=")&&(k=JSON.parse(JSON.stringify(k)),k.candidate=
k.candidate.substr(2));if(k.candidate&&k.candidate.length){var f=new r(k);k=d.default.parseCandidate(k.candidate);var l=Object.assign(f,k);l.toJSON=function(){return{candidate:l.candidate,sdpMid:l.sdpMid,sdpMLineIndex:l.sdpMLineIndex,usernameFragment:l.usernameFragment}};return l}return new r(k)};g.RTCIceCandidate.prototype=r.prototype;h.wrapPeerConnectionEvent(g,"icecandidate",function(k){k.candidate&&Object.defineProperty(k,"candidate",{value:new g.RTCIceCandidate(k.candidate),writable:"false"});
return k})}};c.shimMaxMessageSize=function(g){if(g.RTCPeerConnection){var r=h.detectBrowser(g);"sctp"in g.RTCPeerConnection.prototype||Object.defineProperty(g.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp}});var k=function(q){if(!q||!q.sdp)return!1;q=d.default.splitSections(q.sdp);q.shift();return q.some(function(y){return(y=d.default.parseMLine(y))&&"application"===y.kind&&-1!==y.protocol.indexOf("SCTP")})},f=function(q){q=q.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);
if(null===q||2>q.length)return-1;q=parseInt(q[1],10);return q!==q?-1:q},l=function(q){var y=65536;"firefox"===r.browser&&(y=57>r.version?-1===q?16384:2147483637:60>r.version?57===r.version?65535:65536:2147483637);return y},t=function(q,y){var u=65536;"firefox"===r.browser&&57===r.version&&(u=65535);q=d.default.matchPrefix(q.sdp,"a=max-message-size:");0<q.length?u=parseInt(q[0].substr(19),10):"firefox"===r.browser&&-1!==y&&(u=2147483637);return u},v=g.RTCPeerConnection.prototype.setRemoteDescription;
g.RTCPeerConnection.prototype.setRemoteDescription=function(){this._sctp=null;"chrome"===r.browser&&76<=r.version&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0});if(k(arguments[0])){var q=f(arguments[0]),y=l(q);q=t(arguments[0],q);var u=void 0;u=0===y&&0===q?Number.POSITIVE_INFINITY:0===y||0===q?Math.max(y,q):Math.min(y,q);y={};Object.defineProperty(y,"maxMessageSize",
{get:function(){return u}});this._sctp=y}return v.apply(this,arguments)}}};c.shimSendThrowTypeError=function(g){function r(f,l){var t=f.send;f.send=function(){var v=arguments[0];v=v.length||v.size||v.byteLength;if("open"===f.readyState&&l.sctp&&v>l.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+l.sctp.maxMessageSize+" bytes)");return t.apply(f,arguments)}}if(g.RTCPeerConnection&&"createDataChannel"in g.RTCPeerConnection.prototype){var k=g.RTCPeerConnection.prototype.createDataChannel;
g.RTCPeerConnection.prototype.createDataChannel=function(){var f=k.apply(this,arguments);r(f,this);return f};h.wrapPeerConnectionEvent(g,"datachannel",function(f){r(f.channel,f.target);return f})}};c.shimConnectionState=function(g){if(g.RTCPeerConnection&&!("connectionState"in g.RTCPeerConnection.prototype)){var r=g.RTCPeerConnection.prototype;Object.defineProperty(r,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},
enumerable:!0,configurable:!0});Object.defineProperty(r,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(k){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange);k&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=k)},enumerable:!0,configurable:!0});["setLocalDescription","setRemoteDescription"].forEach(function(k){var f=r[k];
r[k]=function(){this._connectionstatechangepoly||(this._connectionstatechangepoly=function(l){var t=l.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var v=new Event("connectionstatechange",l);t.dispatchEvent(v)}return l},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly));return f.apply(this,arguments)}})}};c.removeAllowExtmapMixed=function(g){if(g.RTCPeerConnection){var r=h.detectBrowser(g);if(!("chrome"===r.browser&&
71<=r.version||"safari"===r.browser&&605<=r.version)){var k=g.RTCPeerConnection.prototype.setRemoteDescription;g.RTCPeerConnection.prototype.setRemoteDescription=function(f){f&&f.sdp&&-1!==f.sdp.indexOf("\na=extmap-allow-mixed")&&(f.sdp=f.sdp.split("\n").filter(function(l){return"a=extmap-allow-mixed"!==l.trim()}).join("\n"));return k.apply(this,arguments)}}}};var d=(b=a("sdp"))&&b.__esModule?b:{default:b},h=function(g){if(g&&g.__esModule)return g;var r={};if(null!=g)for(var k in g)Object.prototype.hasOwnProperty.call(g,
k)&&(r[k]=g[k]);r.default=g;return r}(a("./utils"))},{"./utils":15,sdp:17}],7:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});c.shimGetDisplayMedia=c.shimGetUserMedia=void 0;var e=a("./getusermedia");Object.defineProperty(c,"shimGetUserMedia",{enumerable:!0,get:function(){return e.shimGetUserMedia}});var d=a("./getdisplaymedia");Object.defineProperty(c,"shimGetDisplayMedia",{enumerable:!0,get:function(){return d.shimGetDisplayMedia}});c.shimPeerConnection=function(k){var f=h.detectBrowser(k);
if(k.RTCIceGatherer&&(k.RTCIceCandidate||(k.RTCIceCandidate=function(v){return v}),k.RTCSessionDescription||(k.RTCSessionDescription=function(v){return v}),15025>f.version)){var l=Object.getOwnPropertyDescriptor(k.MediaStreamTrack.prototype,"enabled");Object.defineProperty(k.MediaStreamTrack.prototype,"enabled",{set:function(v){l.set.call(this,v);var q=new Event("enabled");q.enabled=v;this.dispatchEvent(q)}})}!k.RTCRtpSender||"dtmf"in k.RTCRtpSender.prototype||Object.defineProperty(k.RTCRtpSender.prototype,
"dtmf",{get:function(){void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new k.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null));return this._dtmf}});k.RTCDtmfSender&&!k.RTCDTMFSender&&(k.RTCDTMFSender=k.RTCDtmfSender);var t=(0,r.default)(k,f.version);k.RTCPeerConnection=function(v){v&&v.iceServers&&(v.iceServers=(0,g.filterIceServers)(v.iceServers,f.version),h.log("ICE servers after filtering:",v.iceServers));return new t(v)};k.RTCPeerConnection.prototype=t.prototype};c.shimReplaceTrack=
function(k){!k.RTCRtpSender||"replaceTrack"in k.RTCRtpSender.prototype||(k.RTCRtpSender.prototype.replaceTrack=k.RTCRtpSender.prototype.setTrack)};var h=function(k){if(k&&k.__esModule)return k;var f={};if(null!=k)for(var l in k)Object.prototype.hasOwnProperty.call(k,l)&&(f[l]=k[l]);f.default=k;return f}(a("../utils")),g=a("./filtericeservers"),r=(a=a("rtcpeerconnection-shim"))&&a.__esModule?a:{default:a}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],
8:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});c.filterIceServers=function(d,h){var g=!1;d=JSON.parse(JSON.stringify(d));return d.filter(function(r){if(r&&(r.urls||r.url)){var k=r.urls||r.url;r.url&&!r.urls&&e.deprecated("RTCIceServer.url","RTCIceServer.urls");var f="string"===typeof k;f&&(k=[k]);k=k.filter(function(l){return 0===l.indexOf("stun:")?!1:(l=l.startsWith("turn")&&!l.startsWith("turn:[")&&l.includes("transport=udp"))&&!g?g=!0:l&&!g});delete r.url;r.urls=f?k[0]:k;return!!k.length}})};
var e=function(d){if(d&&d.__esModule)return d;var h={};if(null!=d)for(var g in d)Object.prototype.hasOwnProperty.call(d,g)&&(h[g]=d[g]);h.default=d;return h}(a("../utils"))},{"../utils":15}],9:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});c.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&!(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)&&(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator))}},
{}],10:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});c.shimGetUserMedia=function(e){e=e&&e.navigator;var d=function(g){return{name:{PermissionDeniedError:"NotAllowedError"}[g.name]||g.name,message:g.message,constraint:g.constraint,toString:function(){return this.name}}},h=e.mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(g){return h(g).catch(function(r){return Promise.reject(d(r))})}}},{}],11:[function(a,b,c){function e(k,f,l){f in k?Object.defineProperty(k,
f,{value:l,enumerable:!0,configurable:!0,writable:!0}):k[f]=l;return k}Object.defineProperty(c,"__esModule",{value:!0});c.shimGetDisplayMedia=c.shimGetUserMedia=void 0;var d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(k){return typeof k}:function(k){return k&&"function"===typeof Symbol&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},h=a("./getusermedia");Object.defineProperty(c,"shimGetUserMedia",{enumerable:!0,get:function(){return h.shimGetUserMedia}});
var g=a("./getdisplaymedia");Object.defineProperty(c,"shimGetDisplayMedia",{enumerable:!0,get:function(){return g.shimGetDisplayMedia}});c.shimOnTrack=function(k){"object"===("undefined"===typeof k?"undefined":d(k))&&k.RTCTrackEvent&&"receiver"in k.RTCTrackEvent.prototype&&!("transceiver"in k.RTCTrackEvent.prototype)&&Object.defineProperty(k.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};c.shimPeerConnection=function(k){var f=r.detectBrowser(k);if("object"===
("undefined"===typeof k?"undefined":d(k))&&(k.RTCPeerConnection||k.mozRTCPeerConnection)){!k.RTCPeerConnection&&k.mozRTCPeerConnection&&(k.RTCPeerConnection=k.mozRTCPeerConnection);53>f.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(q){var y=k.RTCPeerConnection.prototype[q],u=e({},q,function(){arguments[0]=new ("addIceCandidate"===q?k.RTCIceCandidate:k.RTCSessionDescription)(arguments[0]);return y.apply(this,arguments)});k.RTCPeerConnection.prototype[q]=
u[q]});if(68>f.version){var l=k.RTCPeerConnection.prototype.addIceCandidate;k.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():l.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},v=k.RTCPeerConnection.prototype.getStats;k.RTCPeerConnection.prototype.getStats=
function(){var q=Array.prototype.slice.call(arguments),y=q[1],u=q[2];return v.apply(this,[q[0]||null]).then(function(A){if(53>f.version&&!y)try{A.forEach(function(m){m.type=t[m.type]||m.type})}catch(m){if("TypeError"!==m.name)throw m;A.forEach(function(n,x){A.set(x,Object.assign({},n,{type:t[n.type]||n.type}))})}return A}).then(y,u)}}};c.shimSenderGetStats=function(k){if("object"===("undefined"===typeof k?"undefined":d(k))&&k.RTCPeerConnection&&k.RTCRtpSender&&!(k.RTCRtpSender&&"getStats"in k.RTCRtpSender.prototype)){var f=
k.RTCPeerConnection.prototype.getSenders;f&&(k.RTCPeerConnection.prototype.getSenders=function(){var t=this,v=f.apply(this,[]);v.forEach(function(q){return q._pc=t});return v});var l=k.RTCPeerConnection.prototype.addTrack;l&&(k.RTCPeerConnection.prototype.addTrack=function(){var t=l.apply(this,arguments);t._pc=this;return t});k.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}};c.shimReceiverGetStats=function(k){if("object"===("undefined"===
typeof k?"undefined":d(k))&&k.RTCPeerConnection&&k.RTCRtpSender&&!(k.RTCRtpSender&&"getStats"in k.RTCRtpReceiver.prototype)){var f=k.RTCPeerConnection.prototype.getReceivers;f&&(k.RTCPeerConnection.prototype.getReceivers=function(){var l=this,t=f.apply(this,[]);t.forEach(function(v){return v._pc=l});return t});r.wrapPeerConnectionEvent(k,"track",function(l){l.receiver._pc=l.srcElement;return l});k.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}};c.shimRemoveStream=
function(k){!k.RTCPeerConnection||"removeStream"in k.RTCPeerConnection.prototype||(k.RTCPeerConnection.prototype.removeStream=function(f){var l=this;r.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(t){t.track&&f.getTracks().includes(t.track)&&l.removeTrack(t)})})};c.shimRTCDataChannel=function(k){k.DataChannel&&!k.RTCDataChannel&&(k.RTCDataChannel=k.DataChannel)};c.shimAddTransceiver=function(k){if("object"===("undefined"===typeof k?"undefined":d(k))&&k.RTCPeerConnection){var f=
k.RTCPeerConnection.prototype.addTransceiver;f&&(k.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var l=arguments[1],t=l&&"sendEncodings"in l;t&&l.sendEncodings.forEach(function(y){if("rid"in y&&!/^[a-z0-9]{0,16}$/i.test(y.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in y&&!(1<=parseFloat(y.scaleResolutionDownBy)))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in y&&!(0<=parseFloat(y.maxFramerate)))throw new RangeError("max_framerate must be >= 0.0");
});var v=f.apply(this,arguments);if(t){var q=v.sender;t=q.getParameters();"encodings"in t||(t.encodings=l.sendEncodings,q.sendEncodings=l.sendEncodings,this.setParametersPromises.push(q.setParameters(t).then(function(){delete q.sendEncodings}).catch(function(){delete q.sendEncodings})))}return v})}};c.shimGetParameters=function(k){if("object"===("undefined"===typeof k?"undefined":d(k))&&k.RTCRtpSender){var f=k.RTCRtpSender.prototype.getParameters;f&&(k.RTCRtpSender.prototype.getParameters=function(){var l=
f.apply(this,arguments);return"sendEncodings"in this?Object.assign({},{encodings:this.sendEncodings},l):l})}};c.shimCreateOffer=function(k){if("object"===("undefined"===typeof k?"undefined":d(k))&&k.RTCPeerConnection){var f=k.RTCPeerConnection.prototype.createOffer;k.RTCPeerConnection.prototype.createOffer=function(){var l=this,t=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return f.apply(l,t)}).finally(function(){l.setParametersPromises=
[]}):f.apply(this,arguments)}}};c.shimCreateAnswer=function(k){if("object"===("undefined"===typeof k?"undefined":d(k))&&k.RTCPeerConnection){var f=k.RTCPeerConnection.prototype.createAnswer;k.RTCPeerConnection.prototype.createAnswer=function(){var l=this,t=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return f.apply(l,t)}).finally(function(){l.setParametersPromises=[]}):f.apply(this,arguments)}}};var r=function(k){if(k&&
k.__esModule)return k;var f={};if(null!=k)for(var l in k)Object.prototype.hasOwnProperty.call(k,l)&&(f[l]=k[l]);f.default=k;return f}(a("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});c.shimGetDisplayMedia=function(e,d){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||!e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=function(h){if(!h||!h.video)return h=new DOMException("getDisplayMedia without video constraints is undefined"),
h.name="NotFoundError",h.code=8,Promise.reject(h);!0===h.video?h.video={mediaSource:d}:h.video.mediaSource=d;return e.navigator.mediaDevices.getUserMedia(h)})}},{}],13:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});var e="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(h){return typeof h}:function(h){return h&&"function"===typeof Symbol&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h};c.shimGetUserMedia=function(h){var g=d.detectBrowser(h),
r=h&&h.navigator;h=h&&h.MediaStreamTrack;r.getUserMedia=function(v,q,y){d.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");r.mediaDevices.getUserMedia(v).then(q,y)};if(!(55<g.version&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var k=function(v,q,y){q in v&&!(y in v)&&(v[y]=v[q],delete v[q])},f=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(v){"object"===("undefined"===typeof v?"undefined":e(v))&&"object"===e(v.audio)&&
(v=JSON.parse(JSON.stringify(v)),k(v.audio,"autoGainControl","mozAutoGainControl"),k(v.audio,"noiseSuppression","mozNoiseSuppression"));return f(v)};if(h&&h.prototype.getSettings){var l=h.prototype.getSettings;h.prototype.getSettings=function(){var v=l.apply(this,arguments);k(v,"mozAutoGainControl","autoGainControl");k(v,"mozNoiseSuppression","noiseSuppression");return v}}if(h&&h.prototype.applyConstraints){var t=h.prototype.applyConstraints;h.prototype.applyConstraints=function(v){"audio"===this.kind&&
"object"===("undefined"===typeof v?"undefined":e(v))&&(v=JSON.parse(JSON.stringify(v)),k(v,"autoGainControl","mozAutoGainControl"),k(v,"noiseSuppression","mozNoiseSuppression"));return t.apply(this,[v])}}}};var d=function(h){if(h&&h.__esModule)return h;var g={};if(null!=h)for(var r in h)Object.prototype.hasOwnProperty.call(h,r)&&(g[r]=h[r]);g.default=h;return g}(a("../utils"))},{"../utils":15}],14:[function(a,b,c){function e(g){return g&&void 0!==g.video?Object.assign({},g,{video:h.compactObject(g.video)}):
g}Object.defineProperty(c,"__esModule",{value:!0});var d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"===typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g};c.shimLocalStreamsAPI=function(g){if("object"===("undefined"===typeof g?"undefined":d(g))&&g.RTCPeerConnection){"getLocalStreams"in g.RTCPeerConnection.prototype||(g.RTCPeerConnection.prototype.getLocalStreams=function(){this._localStreams||
(this._localStreams=[]);return this._localStreams});if(!("addStream"in g.RTCPeerConnection.prototype)){var r=g.RTCPeerConnection.prototype.addTrack;g.RTCPeerConnection.prototype.addStream=function(k){var f=this;this._localStreams||(this._localStreams=[]);this._localStreams.includes(k)||this._localStreams.push(k);k.getAudioTracks().forEach(function(l){return r.call(f,l,k)});k.getVideoTracks().forEach(function(l){return r.call(f,l,k)})};g.RTCPeerConnection.prototype.addTrack=function(k){for(var f=this,
l=arguments.length,t=Array(1<l?l-1:0),v=1;v<l;v++)t[v-1]=arguments[v];t&&t.forEach(function(q){f._localStreams?f._localStreams.includes(q)||f._localStreams.push(q):f._localStreams=[q]});return r.apply(this,arguments)}}"removeStream"in g.RTCPeerConnection.prototype||(g.RTCPeerConnection.prototype.removeStream=function(k){var f=this;this._localStreams||(this._localStreams=[]);var l=this._localStreams.indexOf(k);if(-1!==l){this._localStreams.splice(l,1);var t=k.getTracks();this.getSenders().forEach(function(v){t.includes(v.track)&&
f.removeTrack(v)})}})}};c.shimRemoteStreamsAPI=function(g){if("object"===("undefined"===typeof g?"undefined":d(g))&&g.RTCPeerConnection&&("getRemoteStreams"in g.RTCPeerConnection.prototype||(g.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in g.RTCPeerConnection.prototype))){Object.defineProperty(g.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(k){var f=this;this._onaddstream&&
(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly));this.addEventListener("addstream",this._onaddstream=k);this.addEventListener("track",this._onaddstreampoly=function(l){l.streams.forEach(function(t){f._remoteStreams||(f._remoteStreams=[]);if(!f._remoteStreams.includes(t)){f._remoteStreams.push(t);var v=new Event("addstream");v.stream=t;f.dispatchEvent(v)}})})}});var r=g.RTCPeerConnection.prototype.setRemoteDescription;g.RTCPeerConnection.prototype.setRemoteDescription=
function(){var k=this;this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(f){f.streams.forEach(function(l){k._remoteStreams||(k._remoteStreams=[]);if(!(0<=k._remoteStreams.indexOf(l))){k._remoteStreams.push(l);var t=new Event("addstream");t.stream=l;k.dispatchEvent(t)}})});return r.apply(k,arguments)}}};c.shimCallbacksAPI=function(g){if("object"===("undefined"===typeof g?"undefined":d(g))&&g.RTCPeerConnection){g=g.RTCPeerConnection.prototype;var r=g.createOffer,k=g.createAnswer,
f=g.setLocalDescription,l=g.setRemoteDescription,t=g.addIceCandidate;g.createOffer=function(q,y){var u=r.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!y)return u;u.then(q,y);return Promise.resolve()};g.createAnswer=function(q,y){var u=k.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!y)return u;u.then(q,y);return Promise.resolve()};var v=function(q,y,u){q=f.apply(this,[q]);if(!u)return q;q.then(y,u);return Promise.resolve()};g.setLocalDescription=v;v=function(q,y,
u){q=l.apply(this,[q]);if(!u)return q;q.then(y,u);return Promise.resolve()};g.setRemoteDescription=v;v=function(q,y,u){q=t.apply(this,[q]);if(!u)return q;q.then(y,u);return Promise.resolve()};g.addIceCandidate=v}};c.shimGetUserMedia=function(g){var r=g&&g.navigator;if(r.mediaDevices&&r.mediaDevices.getUserMedia){g=r.mediaDevices;var k=g.getUserMedia.bind(g);r.mediaDevices.getUserMedia=function(f){return k(e(f))}}!r.getUserMedia&&r.mediaDevices&&r.mediaDevices.getUserMedia&&(r.getUserMedia=function(f,
l,t){r.mediaDevices.getUserMedia(f).then(l,t)}.bind(r))};c.shimConstraints=e;c.shimRTCIceServerUrls=function(g){var r=g.RTCPeerConnection;g.RTCPeerConnection=function(k,f){if(k&&k.iceServers){for(var l=[],t=0;t<k.iceServers.length;t++){var v=k.iceServers[t];!v.hasOwnProperty("urls")&&v.hasOwnProperty("url")?(h.deprecated("RTCIceServer.url","RTCIceServer.urls"),v=JSON.parse(JSON.stringify(v)),v.urls=v.url,delete v.url,l.push(v)):l.push(k.iceServers[t])}k.iceServers=l}return new r(k,f)};g.RTCPeerConnection.prototype=
r.prototype;"generateCertificate"in g.RTCPeerConnection&&Object.defineProperty(g.RTCPeerConnection,"generateCertificate",{get:function(){return r.generateCertificate}})};c.shimTrackEventTransceiver=function(g){"object"===("undefined"===typeof g?"undefined":d(g))&&g.RTCTrackEvent&&"receiver"in g.RTCTrackEvent.prototype&&!("transceiver"in g.RTCTrackEvent.prototype)&&Object.defineProperty(g.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};c.shimCreateOfferLegacy=
function(g){var r=g.RTCPeerConnection.prototype.createOffer;g.RTCPeerConnection.prototype.createOffer=function(k){if(k){"undefined"!==typeof k.offerToReceiveAudio&&(k.offerToReceiveAudio=!!k.offerToReceiveAudio);var f=this.getTransceivers().find(function(l){return"audio"===l.receiver.track.kind});!1===k.offerToReceiveAudio&&f?"sendrecv"===f.direction?f.setDirection?f.setDirection("sendonly"):f.direction="sendonly":"recvonly"===f.direction&&(f.setDirection?f.setDirection("inactive"):f.direction="inactive"):
!0!==k.offerToReceiveAudio||f||this.addTransceiver("audio");"undefined"!==typeof k.offerToReceiveVideo&&(k.offerToReceiveVideo=!!k.offerToReceiveVideo);f=this.getTransceivers().find(function(l){return"video"===l.receiver.track.kind});!1===k.offerToReceiveVideo&&f?"sendrecv"===f.direction?f.setDirection?f.setDirection("sendonly"):f.direction="sendonly":"recvonly"===f.direction&&(f.setDirection?f.setDirection("inactive"):f.direction="inactive"):!0!==k.offerToReceiveVideo||f||this.addTransceiver("video")}return r.apply(this,
arguments)}};c.shimAudioContext=function(g){"object"!==("undefined"===typeof g?"undefined":d(g))||g.AudioContext||(g.AudioContext=g.webkitAudioContext)};var h=function(g){if(g&&g.__esModule)return g;var r={};if(null!=g)for(var k in g)Object.prototype.hasOwnProperty.call(g,k)&&(r[k]=g[k]);r.default=g;return r}(a("../utils"))},{"../utils":15}],15:[function(a,b,c){function e(f,l,t){return(f=f.match(l))&&f.length>=t&&parseInt(f[t],10)}function d(f){return"[object Object]"!==Object.prototype.toString.call(f)?
f:Object.keys(f).reduce(function(l,t){var v="[object Object]"===Object.prototype.toString.call(f[t]),q=v?d(f[t]):f[t];v=v&&!Object.keys(q).length;if(void 0===q||v)return l;v=Object;var y=v.assign,u={};t in u?Object.defineProperty(u,t,{value:q,enumerable:!0,configurable:!0,writable:!0}):u[t]=q;return y.call(v,l,u)},{})}function h(f,l,t){l&&!t.has(l.id)&&(t.set(l.id,l),Object.keys(l).forEach(function(v){v.endsWith("Id")?h(f,f.get(l[v]),t):v.endsWith("Ids")&&l[v].forEach(function(q){h(f,f.get(q),t)})}))}
Object.defineProperty(c,"__esModule",{value:!0});var g="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(f){return typeof f}:function(f){return f&&"function"===typeof Symbol&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f};c.extractVersion=e;c.wrapPeerConnectionEvent=function(f,l,t){if(f.RTCPeerConnection){f=f.RTCPeerConnection.prototype;var v=f.addEventListener;f.addEventListener=function(y,u){if(y!==l)return v.apply(this,arguments);var A=function(m){(m=t(m))&&
(u.handleEvent?u.handleEvent(m):u(m))};this._eventMap=this._eventMap||{};this._eventMap[l]||(this._eventMap[l]=new Map);this._eventMap[l].set(u,A);return v.apply(this,[y,A])};var q=f.removeEventListener;f.removeEventListener=function(y,u){if(y!==l||!this._eventMap||!this._eventMap[l]||!this._eventMap[l].has(u))return q.apply(this,arguments);var A=this._eventMap[l].get(u);this._eventMap[l].delete(u);0===this._eventMap[l].size&&delete this._eventMap[l];0===Object.keys(this._eventMap).length&&delete this._eventMap;
return q.apply(this,[y,A])};Object.defineProperty(f,"on"+l,{get:function(){return this["_on"+l]},set:function(y){this["_on"+l]&&(this.removeEventListener(l,this["_on"+l]),delete this["_on"+l]);y&&this.addEventListener(l,this["_on"+l]=y)},enumerable:!0,configurable:!0})}};c.disableLog=function(f){return"boolean"!==typeof f?Error("Argument type: "+("undefined"===typeof f?"undefined":g(f))+". Please use a boolean."):(r=f)?"adapter.js logging disabled":"adapter.js logging enabled"};c.disableWarnings=
function(f){if("boolean"!==typeof f)return Error("Argument type: "+("undefined"===typeof f?"undefined":g(f))+". Please use a boolean.");k=!f;return"adapter.js deprecation warnings "+(f?"disabled":"enabled")};c.log=function(){"object"!==("undefined"===typeof window?"undefined":g(window))||r||"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)};c.deprecated=function(f,l){k&&console.warn(f+" is deprecated, please use "+l+" instead.")};c.detectBrowser=function(f){var l=
f.navigator,t={browser:null,version:null};if("undefined"===typeof f||!f.navigator)return t.browser="Not a browser.",t;l.mozGetUserMedia?(t.browser="firefox",t.version=e(l.userAgent,/Firefox\/(\d+)\./,1)):l.webkitGetUserMedia||!1===f.isSecureContext&&f.webkitRTCPeerConnection&&!f.RTCIceGatherer?(t.browser="chrome",t.version=e(l.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):l.mediaDevices&&l.userAgent.match(/Edge\/(\d+).(\d+)$/)?(t.browser="edge",t.version=e(l.userAgent,/Edge\/(\d+).(\d+)$/,2)):f.RTCPeerConnection&&
l.userAgent.match(/AppleWebKit\/(\d+)\./)?(t.browser="safari",t.version=e(l.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=f.RTCRtpTransceiver&&"currentDirection"in f.RTCRtpTransceiver.prototype):t.browser="Not a supported browser.";return t};c.compactObject=d;c.walkStats=h;c.filterStats=function(f,l,t){var v=t?"outbound-rtp":"inbound-rtp",q=new Map;if(null===l)return q;var y=[];f.forEach(function(u){"track"===u.type&&u.trackIdentifier===l.id&&y.push(u)});y.forEach(function(u){f.forEach(function(A){A.type===
v&&A.trackId===u.id&&h(f,A,q)})});return q};var r=!0,k=!0},{}],16:[function(a,b,c){function e(l,t,v,q,y){t=f.writeRtpDescription(l.kind,t);t+=f.writeIceParameters(l.iceGatherer.getLocalParameters());t+=f.writeDtlsParameters(l.dtlsTransport.getLocalParameters(),"offer"===v?"actpass":y||"active");t+="a=mid:"+l.mid+"\r\n";t=l.rtpSender&&l.rtpReceiver?t+"a=sendrecv\r\n":l.rtpSender?t+"a=sendonly\r\n":l.rtpReceiver?t+"a=recvonly\r\n":t+"a=inactive\r\n";l.rtpSender&&(v=l.rtpSender._initialTrackId||l.rtpSender.track.id,
l.rtpSender._initialTrackId=v,q="msid:"+(q?q.id:"-")+" "+v+"\r\n",t=t+("a="+q)+("a=ssrc:"+l.sendEncodingParameters[0].ssrc+" "+q),l.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+l.sendEncodingParameters[0].rtx.ssrc+" "+q,t+="a=ssrc-group:FID "+l.sendEncodingParameters[0].ssrc+" "+l.sendEncodingParameters[0].rtx.ssrc+"\r\n"));t+="a=ssrc:"+l.sendEncodingParameters[0].ssrc+" cname:"+f.localCName+"\r\n";l.rtpSender&&l.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+l.sendEncodingParameters[0].rtx.ssrc+" cname:"+
f.localCName+"\r\n");return t}function d(l,t){var v=!1;l=JSON.parse(JSON.stringify(l));return l.filter(function(q){if(q&&(q.urls||q.url)){var y=q.urls||q.url;q.url&&!q.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var u="string"===typeof y;u&&(y=[y]);y=y.filter(function(A){return 0!==A.indexOf("turn:")||-1===A.indexOf("transport=udp")||-1!==A.indexOf("turn:[")||v?0===A.indexOf("stun:")&&14393<=t&&-1===A.indexOf("?transport=udp"):v=!0});delete q.url;q.urls=u?y[0]:y;return!!y.length}})}
function h(l,t){var v={codecs:[],headerExtensions:[],fecMechanisms:[]},q=function(u,A){u=parseInt(u,10);for(var m=0;m<A.length;m++)if(A[m].payloadType===u||A[m].preferredPayloadType===u)return A[m]},y=function(u,A,m,n){u=q(u.parameters.apt,m);A=q(A.parameters.apt,n);return u&&A&&u.name.toLowerCase()===A.name.toLowerCase()};l.codecs.forEach(function(u){for(var A=0;A<t.codecs.length;A++){var m=t.codecs[A];if(u.name.toLowerCase()===m.name.toLowerCase()&&u.clockRate===m.clockRate&&("rtx"!==u.name.toLowerCase()||
!u.parameters||!m.parameters.apt||y(u,m,l.codecs,t.codecs))){m=JSON.parse(JSON.stringify(m));m.numChannels=Math.min(u.numChannels,m.numChannels);v.codecs.push(m);m.rtcpFeedback=m.rtcpFeedback.filter(function(n){for(var x=0;x<u.rtcpFeedback.length;x++)if(u.rtcpFeedback[x].type===n.type&&u.rtcpFeedback[x].parameter===n.parameter)return!0;return!1});break}}});l.headerExtensions.forEach(function(u){for(var A=0;A<t.headerExtensions.length;A++){var m=t.headerExtensions[A];if(u.uri===m.uri){v.headerExtensions.push(m);
break}}});return v}function g(l,t,v){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][l].indexOf(v)}function r(l,t){var v=l.getRemoteCandidates().find(function(q){return t.foundation===q.foundation&&t.ip===q.ip&&t.port===q.port&&t.priority===q.priority&&t.protocol===q.protocol&&t.type===
q.type});v||l.addRemoteCandidate(t);return!v}function k(l,t){t=Error(t);t.name=l;t.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[l];return t}var f=a("sdp");b.exports=function(l,t){function v(m,n){n.addTrack(m);n.dispatchEvent(new l.MediaStreamTrackEvent("addtrack",{track:m}))}function q(m,n){n.removeTrack(m);n.dispatchEvent(new l.MediaStreamTrackEvent("removetrack",{track:m}))}function y(m,n,x,z){var B=new Event("track");B.track=n;B.receiver=
x;B.transceiver={receiver:x};B.streams=z;l.setTimeout(function(){m._dispatchEvent("track",B)})}var u=function(m){var n=this,x=document.createDocumentFragment();["addEventListener","removeEventListener","dispatchEvent"].forEach(function(B){n[B]=x[B].bind(x)});this.canTrickleIceCandidates=null;this.needNegotiation=!1;this.localStreams=[];this.remoteStreams=[];this._remoteDescription=this._localDescription=null;this.signalingState="stable";this.iceGatheringState=this.connectionState=this.iceConnectionState=
"new";m=JSON.parse(JSON.stringify(m||{}));this.usingBundle="max-bundle"===m.bundlePolicy;if("negotiate"===m.rtcpMuxPolicy)throw k("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");m.rtcpMuxPolicy||(m.rtcpMuxPolicy="require");switch(m.iceTransportPolicy){case "all":case "relay":break;default:m.iceTransportPolicy="all"}switch(m.bundlePolicy){case "balanced":case "max-compat":case "max-bundle":break;default:m.bundlePolicy="balanced"}m.iceServers=d(m.iceServers||[],t);this._iceGatherers=
[];if(m.iceCandidatePoolSize)for(var z=m.iceCandidatePoolSize;0<z;z--)this._iceGatherers.push(new l.RTCIceGatherer({iceServers:m.iceServers,gatherPolicy:m.iceTransportPolicy}));else m.iceCandidatePoolSize=0;this._config=m;this.transceivers=[];this._sdpSessionId=f.generateSessionId();this._sdpSessionVersion=0;this._dtlsRole=void 0;this._isClosed=!1};Object.defineProperty(u.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}});Object.defineProperty(u.prototype,
"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}});u.prototype.onicecandidate=null;u.prototype.onaddstream=null;u.prototype.ontrack=null;u.prototype.onremovestream=null;u.prototype.onsignalingstatechange=null;u.prototype.oniceconnectionstatechange=null;u.prototype.onconnectionstatechange=null;u.prototype.onicegatheringstatechange=null;u.prototype.onnegotiationneeded=null;u.prototype.ondatachannel=null;u.prototype._dispatchEvent=function(m,n){if(!this._isClosed&&
(this.dispatchEvent(n),"function"===typeof this["on"+m]))this["on"+m](n)};u.prototype._emitGatheringStateChange=function(){var m=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",m)};u.prototype.getConfiguration=function(){return this._config};u.prototype.getLocalStreams=function(){return this.localStreams};u.prototype.getRemoteStreams=function(){return this.remoteStreams};u.prototype._createTransceiver=function(m,n){var x=0<this.transceivers.length;m={track:null,
iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:m,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};this.usingBundle&&x?(m.iceTransport=this.transceivers[0].iceTransport,m.dtlsTransport=this.transceivers[0].dtlsTransport):(x=this._createIceAndDtlsTransports(),m.iceTransport=x.iceTransport,m.dtlsTransport=x.dtlsTransport);n||this.transceivers.push(m);
return m};u.prototype.addTrack=function(m,n){if(this._isClosed)throw k("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find(function(B){return B.track===m}))throw k("InvalidAccessError","Track already exists.");for(var x,z=0;z<this.transceivers.length;z++)this.transceivers[z].track||this.transceivers[z].kind!==m.kind||(x=this.transceivers[z]);x||(x=this._createTransceiver(m.kind));this._maybeFireNegotiationNeeded();-1===this.localStreams.indexOf(n)&&
this.localStreams.push(n);x.track=m;x.stream=n;x.rtpSender=new l.RTCRtpSender(m,x.dtlsTransport);return x.rtpSender};u.prototype.addStream=function(m){var n=this;if(15025<=t)m.getTracks().forEach(function(z){n.addTrack(z,m)});else{var x=m.clone();m.getTracks().forEach(function(z,B){var C=x.getTracks()[B];z.addEventListener("enabled",function(G){C.enabled=G.enabled})});x.getTracks().forEach(function(z){n.addTrack(z,x)})}};u.prototype.removeTrack=function(m){if(this._isClosed)throw k("InvalidStateError",
"Attempted to call removeTrack on a closed peerconnection.");if(!(m instanceof l.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find(function(z){return z.rtpSender===m});if(!n)throw k("InvalidAccessError","Sender was not created by this connection.");var x=n.stream;n.rtpSender.stop();n.rtpSender=null;n.track=null;n.stream=null;-1===this.transceivers.map(function(z){return z.stream}).indexOf(x)&&-1<
this.localStreams.indexOf(x)&&this.localStreams.splice(this.localStreams.indexOf(x),1);this._maybeFireNegotiationNeeded()};u.prototype.removeStream=function(m){var n=this;m.getTracks().forEach(function(x){var z=n.getSenders().find(function(B){return B.track===x});z&&n.removeTrack(z)})};u.prototype.getSenders=function(){return this.transceivers.filter(function(m){return!!m.rtpSender}).map(function(m){return m.rtpSender})};u.prototype.getReceivers=function(){return this.transceivers.filter(function(m){return!!m.rtpReceiver}).map(function(m){return m.rtpReceiver})};
u.prototype._createIceGatherer=function(m,n){var x=this;if(n&&0<m)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var z=new l.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});Object.defineProperty(z,"state",{value:"new",writable:!0});this.transceivers[m].bufferedCandidateEvents=[];this.transceivers[m].bufferCandidates=function(B){var C=!B.candidate||0===Object.keys(B.candidate).length;z.state=C?
"completed":"gathering";null!==x.transceivers[m].bufferedCandidateEvents&&x.transceivers[m].bufferedCandidateEvents.push(B)};z.addEventListener("localcandidate",this.transceivers[m].bufferCandidates);return z};u.prototype._gather=function(m,n){var x=this,z=this.transceivers[n].iceGatherer;if(!z.onlocalcandidate){var B=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null;z.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates);z.onlocalcandidate=
function(C){if(!(x.usingBundle&&0<n)){var G=new Event("icecandidate");G.candidate={sdpMid:m,sdpMLineIndex:n};var L=C.candidate;if(C=!L||0===Object.keys(L).length){if("new"===z.state||"gathering"===z.state)z.state="completed"}else"new"===z.state&&(z.state="gathering"),L.component=1,L.ufrag=z.getLocalParameters().usernameFragment,L=f.writeCandidate(L),G.candidate=Object.assign(G.candidate,f.parseCandidate(L)),G.candidate.candidate=L,G.candidate.toJSON=function(){return{candidate:G.candidate.candidate,
sdpMid:G.candidate.sdpMid,sdpMLineIndex:G.candidate.sdpMLineIndex,usernameFragment:G.candidate.usernameFragment}};L=f.getMediaSections(x._localDescription.sdp);L[G.candidate.sdpMLineIndex]=C?L[G.candidate.sdpMLineIndex]+"a=end-of-candidates\r\n":L[G.candidate.sdpMLineIndex]+("a="+G.candidate.candidate+"\r\n");x._localDescription.sdp=f.getDescription(x._localDescription.sdp)+L.join("");L=x.transceivers.every(function(W){return W.iceGatherer&&"completed"===W.iceGatherer.state});"gathering"!==x.iceGatheringState&&
(x.iceGatheringState="gathering",x._emitGatheringStateChange());C||x._dispatchEvent("icecandidate",G);L&&(x._dispatchEvent("icecandidate",new Event("icecandidate")),x.iceGatheringState="complete",x._emitGatheringStateChange())}};l.setTimeout(function(){B.forEach(function(C){z.onlocalcandidate(C)})},0)}};u.prototype._createIceAndDtlsTransports=function(){var m=this,n=new l.RTCIceTransport(null);n.onicestatechange=function(){m._updateIceConnectionState();m._updateConnectionState()};var x=new l.RTCDtlsTransport(n);
x.ondtlsstatechange=function(){m._updateConnectionState()};x.onerror=function(){Object.defineProperty(x,"state",{value:"failed",writable:!0});m._updateConnectionState()};return{iceTransport:n,dtlsTransport:x}};u.prototype._disposeIceAndDtlsTransports=function(m){var n=this.transceivers[m].iceGatherer;n&&(delete n.onlocalcandidate,delete this.transceivers[m].iceGatherer);if(n=this.transceivers[m].iceTransport)delete n.onicestatechange,delete this.transceivers[m].iceTransport;if(n=this.transceivers[m].dtlsTransport)delete n.ondtlsstatechange,
delete n.onerror,delete this.transceivers[m].dtlsTransport};u.prototype._transceive=function(m,n,x){var z=h(m.localCapabilities,m.remoteCapabilities);n&&m.rtpSender&&(z.encodings=m.sendEncodingParameters,z.rtcp={cname:f.localCName,compound:m.rtcpParameters.compound},m.recvEncodingParameters.length&&(z.rtcp.ssrc=m.recvEncodingParameters[0].ssrc),m.rtpSender.send(z));x&&m.rtpReceiver&&0<z.codecs.length&&("video"===m.kind&&m.recvEncodingParameters&&15019>t&&m.recvEncodingParameters.forEach(function(B){delete B.rtx}),
z.encodings=m.recvEncodingParameters.length?m.recvEncodingParameters:[{}],z.rtcp={compound:m.rtcpParameters.compound},m.rtcpParameters.cname&&(z.rtcp.cname=m.rtcpParameters.cname),m.sendEncodingParameters.length&&(z.rtcp.ssrc=m.sendEncodingParameters[0].ssrc),m.rtpReceiver.receive(z))};u.prototype.setLocalDescription=function(m){var n=this;if(-1===["offer","answer"].indexOf(m.type))return Promise.reject(k("TypeError",'Unsupported type "'+m.type+'"'));if(!g("setLocalDescription",m.type,n.signalingState)||
n._isClosed)return Promise.reject(k("InvalidStateError","Can not set local "+m.type+" in state "+n.signalingState));if("offer"===m.type){var x=f.splitSections(m.sdp);var z=x.shift();x.forEach(function(C,G){C=f.parseRtpParameters(C);n.transceivers[G].localCapabilities=C});n.transceivers.forEach(function(C,G){n._gather(C.mid,G)})}else if("answer"===m.type){x=f.splitSections(n._remoteDescription.sdp);z=x.shift();var B=0<f.matchPrefix(z,"a=ice-lite").length;x.forEach(function(C,G){var L=n.transceivers[G],
W=L.iceGatherer,J=L.iceTransport,I=L.dtlsTransport,O=L.localCapabilities,R=L.remoteCapabilities;if(!(f.isRejected(C)&&0===f.matchPrefix(C,"a=bundle-only").length||L.rejected)){var X=f.getIceParameters(C,z);C=f.getDtlsParameters(C,z);B&&(C.role="server");n.usingBundle&&0!==G||(n._gather(L.mid,G),"new"===J.state&&J.start(W,X,B?"controlling":"controlled"),"new"===I.state&&I.start(C));G=h(O,R);n._transceive(L,0<G.codecs.length,!1)}})}n._localDescription={type:m.type,sdp:m.sdp};"offer"===m.type?n._updateSignalingState("have-local-offer"):
n._updateSignalingState("stable");return Promise.resolve()};u.prototype.setRemoteDescription=function(m){var n=this;if(-1===["offer","answer"].indexOf(m.type))return Promise.reject(k("TypeError",'Unsupported type "'+m.type+'"'));if(!g("setRemoteDescription",m.type,n.signalingState)||n._isClosed)return Promise.reject(k("InvalidStateError","Can not set remote "+m.type+" in state "+n.signalingState));var x={};n.remoteStreams.forEach(function(J){x[J.id]=J});var z=[],B=f.splitSections(m.sdp),C=B.shift(),
G=0<f.matchPrefix(C,"a=ice-lite").length,L=0<f.matchPrefix(C,"a=group:BUNDLE ").length;n.usingBundle=L;var W=f.matchPrefix(C,"a=ice-options:")[0];n.canTrickleIceCandidates=W?0<=W.substr(14).split(" ").indexOf("trickle"):!1;B.forEach(function(J,I){var O=f.splitLines(J),R=f.getKind(J),X=f.isRejected(J)&&0===f.matchPrefix(J,"a=bundle-only").length,ja=O[0].substr(2).split(" ")[2];O=f.getDirection(J,C);var U=f.parseMsid(J),ma=f.getMid(J)||f.generateIdentifier();if(X||"application"===R&&("DTLS/SCTP"===
ja||"UDP/DTLS/SCTP"===ja))n.transceivers[I]={mid:ma,kind:R,protocol:ja,rejected:!0};else{!X&&n.transceivers[I]&&n.transceivers[I].rejected&&(n.transceivers[I]=n._createTransceiver(R,!0));var xa=f.parseRtpParameters(J);if(!X){var na=f.getIceParameters(J,C);var ya=f.getDtlsParameters(J,C);ya.role="client"}ja=f.parseRtpEncodingParameters(J);var za=f.parseRtcpParameters(J),Aa=0<f.matchPrefix(J,"a=end-of-candidates",C).length,ka=f.matchPrefix(J,"a=candidate:").map(function(V){return f.parseCandidate(V)}).filter(function(V){return 1===
V.component});("offer"===m.type||"answer"===m.type)&&!X&&L&&0<I&&n.transceivers[I]&&(n._disposeIceAndDtlsTransports(I),n.transceivers[I].iceGatherer=n.transceivers[0].iceGatherer,n.transceivers[I].iceTransport=n.transceivers[0].iceTransport,n.transceivers[I].dtlsTransport=n.transceivers[0].dtlsTransport,n.transceivers[I].rtpSender&&n.transceivers[I].rtpSender.setTransport(n.transceivers[0].dtlsTransport),n.transceivers[I].rtpReceiver&&n.transceivers[I].rtpReceiver.setTransport(n.transceivers[0].dtlsTransport));
if("offer"!==m.type||X)"answer"!==m.type||X||(M=n.transceivers[I],ha=M.iceGatherer,R=M.iceTransport,ma=M.dtlsTransport,ea=M.rtpReceiver,X=M.sendEncodingParameters,J=M.localCapabilities,n.transceivers[I].recvEncodingParameters=ja,n.transceivers[I].remoteCapabilities=xa,n.transceivers[I].rtcpParameters=za,ka.length&&"new"===R.state&&(!G&&!Aa||L&&0!==I?ka.forEach(function(V){r(M.iceTransport,V)}):R.setRemoteCandidates(ka)),L&&0!==I||("new"===R.state&&R.start(ha,na,"controlling"),"new"===ma.state&&ma.start(ya)),
!h(M.localCapabilities,M.remoteCapabilities).codecs.filter(function(V){return"rtx"===V.name.toLowerCase()}).length&&M.sendEncodingParameters[0].rtx&&delete M.sendEncodingParameters[0].rtx,n._transceive(M,"sendrecv"===O||"recvonly"===O,"sendrecv"===O||"sendonly"===O),!ea||"sendrecv"!==O&&"sendonly"!==O?delete M.rtpReceiver:(O=ea.track,U?(x[U.stream]||(x[U.stream]=new l.MediaStream),v(O,x[U.stream]),z.push([O,ea,x[U.stream]])):(x.default||(x.default=new l.MediaStream),v(O,x.default),z.push([O,ea,x.default]))));
else{var M=n.transceivers[I]||n._createTransceiver(R);M.mid=ma;M.iceGatherer||(M.iceGatherer=n._createIceGatherer(I,L));ka.length&&"new"===M.iceTransport.state&&(!Aa||L&&0!==I?ka.forEach(function(V){r(M.iceTransport,V)}):M.iceTransport.setRemoteCandidates(ka));J=l.RTCRtpReceiver.getCapabilities(R);15019>t&&(J.codecs=J.codecs.filter(function(V){return"rtx"!==V.name}));X=M.sendEncodingParameters||[{ssrc:1001*(2*I+2)}];na=!1;if("sendrecv"===O||"sendonly"===O){na=!M.rtpReceiver;var ea=M.rtpReceiver||
new l.RTCRtpReceiver(M.dtlsTransport,R);if(na){O=ea.track;if(!U||"-"!==U.stream)if(U){x[U.stream]||(x[U.stream]=new l.MediaStream,Object.defineProperty(x[U.stream],"id",{get:function(){return U.stream}}));Object.defineProperty(O,"id",{get:function(){return U.track}});var ha=x[U.stream]}else x.default||(x.default=new l.MediaStream),ha=x.default;ha&&(v(O,ha),M.associatedRemoteMediaStreams.push(ha));z.push([O,ea,ha])}}else M.rtpReceiver&&M.rtpReceiver.track&&(M.associatedRemoteMediaStreams.forEach(function(V){var Ba=
V.getTracks().find(function(Ob){return Ob.id===M.rtpReceiver.track.id});Ba&&q(Ba,V)}),M.associatedRemoteMediaStreams=[]);M.localCapabilities=J;M.remoteCapabilities=xa;M.rtpReceiver=ea;M.rtcpParameters=za;M.sendEncodingParameters=X;M.recvEncodingParameters=ja;n._transceive(n.transceivers[I],!1,na)}}});void 0===n._dtlsRole&&(n._dtlsRole="offer"===m.type?"active":"passive");n._remoteDescription={type:m.type,sdp:m.sdp};"offer"===m.type?n._updateSignalingState("have-remote-offer"):n._updateSignalingState("stable");
Object.keys(x).forEach(function(J){var I=x[J];if(I.getTracks().length){if(-1===n.remoteStreams.indexOf(I)){n.remoteStreams.push(I);var O=new Event("addstream");O.stream=I;l.setTimeout(function(){n._dispatchEvent("addstream",O)})}z.forEach(function(R){I.id===R[2].id&&y(n,R[0],R[1],[I])})}});z.forEach(function(J){J[2]||y(n,J[0],J[1],[])});l.setTimeout(function(){n&&n.transceivers&&n.transceivers.forEach(function(J){J.iceTransport&&"new"===J.iceTransport.state&&0<J.iceTransport.getRemoteCandidates().length&&
(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),J.iceTransport.addRemoteCandidate({}))})},4E3);return Promise.resolve()};u.prototype.close=function(){this.transceivers.forEach(function(m){m.iceTransport&&m.iceTransport.stop();m.dtlsTransport&&m.dtlsTransport.stop();m.rtpSender&&m.rtpSender.stop();m.rtpReceiver&&m.rtpReceiver.stop()});this._isClosed=!0;this._updateSignalingState("closed")};u.prototype._updateSignalingState=function(m){this.signalingState=
m;m=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",m)};u.prototype._maybeFireNegotiationNeeded=function(){var m=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,l.setTimeout(function(){if(m.needNegotiation){m.needNegotiation=!1;var n=new Event("negotiationneeded");m._dispatchEvent("negotiationneeded",n)}},0))};u.prototype._updateIceConnectionState=function(){var m={"new":0,closed:0,checking:0,connected:0,completed:0,disconnected:0,
failed:0};this.transceivers.forEach(function(x){x.iceTransport&&!x.rejected&&m[x.iceTransport.state]++});var n="new";0<m.failed?n="failed":0<m.checking?n="checking":0<m.disconnected?n="disconnected":0<m.new?n="new":0<m.connected?n="connected":0<m.completed&&(n="completed");n!==this.iceConnectionState&&(this.iceConnectionState=n,n=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",n))};u.prototype._updateConnectionState=function(){var m={"new":0,closed:0,connecting:0,
connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(x){x.iceTransport&&x.dtlsTransport&&!x.rejected&&(m[x.iceTransport.state]++,m[x.dtlsTransport.state]++)});m.connected+=m.completed;var n="new";0<m.failed?n="failed":0<m.connecting?n="connecting":0<m.disconnected?n="disconnected":0<m.new?n="new":0<m.connected&&(n="connected");n!==this.connectionState&&(this.connectionState=n,n=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",n))};u.prototype.createOffer=
function(m){var n=this;if(n._isClosed)return Promise.reject(k("InvalidStateError","Can not call createOffer after close"));var x=n.transceivers.filter(function(C){return"audio"===C.kind}).length,z=n.transceivers.filter(function(C){return"video"===C.kind}).length;if(m){if(m.mandatory||m.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==m.offerToReceiveAudio&&(x=!0===m.offerToReceiveAudio?1:!1===m.offerToReceiveAudio?0:m.offerToReceiveAudio);void 0!==m.offerToReceiveVideo&&
(z=!0===m.offerToReceiveVideo?1:!1===m.offerToReceiveVideo?0:m.offerToReceiveVideo)}for(n.transceivers.forEach(function(C){"audio"===C.kind?(x--,0>x&&(C.wantReceive=!1)):"video"===C.kind&&(z--,0>z&&(C.wantReceive=!1))});0<x||0<z;)0<x&&(n._createTransceiver("audio"),x--),0<z&&(n._createTransceiver("video"),z--);var B=f.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach(function(C,G){var L=C.track,W=C.kind,J=C.mid||f.generateIdentifier();C.mid=J;C.iceGatherer||(C.iceGatherer=
n._createIceGatherer(G,n.usingBundle));J=l.RTCRtpSender.getCapabilities(W);15019>t&&(J.codecs=J.codecs.filter(function(I){return"rtx"!==I.name}));J.codecs.forEach(function(I){"H264"===I.name&&void 0===I.parameters["level-asymmetry-allowed"]&&(I.parameters["level-asymmetry-allowed"]="1");C.remoteCapabilities&&C.remoteCapabilities.codecs&&C.remoteCapabilities.codecs.forEach(function(O){I.name.toLowerCase()===O.name.toLowerCase()&&I.clockRate===O.clockRate&&(I.preferredPayloadType=O.payloadType)})});
J.headerExtensions.forEach(function(I){(C.remoteCapabilities&&C.remoteCapabilities.headerExtensions||[]).forEach(function(O){I.uri===O.uri&&(I.id=O.id)})});G=C.sendEncodingParameters||[{ssrc:1001*(2*G+1)}];L&&15019<=t&&"video"===W&&!G[0].rtx&&(G[0].rtx={ssrc:G[0].ssrc+1});C.wantReceive&&(C.rtpReceiver=new l.RTCRtpReceiver(C.dtlsTransport,W));C.localCapabilities=J;C.sendEncodingParameters=G});"max-compat"!==n._config.bundlePolicy&&(B+="a=group:BUNDLE "+n.transceivers.map(function(C){return C.mid}).join(" ")+
"\r\n");B+="a=ice-options:trickle\r\n";n.transceivers.forEach(function(C,G){B+=e(C,C.localCapabilities,"offer",C.stream,n._dtlsRole);B+="a=rtcp-rsize\r\n";!C.iceGatherer||"new"===n.iceGatheringState||0!==G&&n.usingBundle||(C.iceGatherer.getLocalCandidates().forEach(function(L){L.component=1;B+="a="+f.writeCandidate(L)+"\r\n"}),"completed"===C.iceGatherer.state&&(B+="a=end-of-candidates\r\n"))});m=new l.RTCSessionDescription({type:"offer",sdp:B});return Promise.resolve(m)};u.prototype.createAnswer=
function(){var m=this;if(m._isClosed)return Promise.reject(k("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==m.signalingState&&"have-local-pranswer"!==m.signalingState)return Promise.reject(k("InvalidStateError","Can not call createAnswer in signalingState "+m.signalingState));var n=f.writeSessionBoilerplate(m._sdpSessionId,m._sdpSessionVersion++);m.usingBundle&&(n+="a=group:BUNDLE "+m.transceivers.map(function(B){return B.mid}).join(" ")+"\r\n");n+="a=ice-options:trickle\r\n";
var x=f.getMediaSections(m._remoteDescription.sdp).length;m.transceivers.forEach(function(B,C){if(!(C+1>x))if(B.rejected)"application"===B.kind?n="DTLS/SCTP"===B.protocol?n+"m=application 0 DTLS/SCTP 5000\r\n":n+("m=application 0 "+B.protocol+" webrtc-datachannel\r\n"):"audio"===B.kind?n+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===B.kind&&(n+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),n+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+B.mid+"\r\n";else{if(B.stream){var G;
"audio"===B.kind?G=B.stream.getAudioTracks()[0]:"video"===B.kind&&(G=B.stream.getVideoTracks()[0]);G&&15019<=t&&"video"===B.kind&&!B.sendEncodingParameters[0].rtx&&(B.sendEncodingParameters[0].rtx={ssrc:B.sendEncodingParameters[0].ssrc+1})}C=h(B.localCapabilities,B.remoteCapabilities);!C.codecs.filter(function(L){return"rtx"===L.name.toLowerCase()}).length&&B.sendEncodingParameters[0].rtx&&delete B.sendEncodingParameters[0].rtx;n+=e(B,C,"answer",B.stream,m._dtlsRole);B.rtcpParameters&&B.rtcpParameters.reducedSize&&
(n+="a=rtcp-rsize\r\n")}});var z=new l.RTCSessionDescription({type:"answer",sdp:n});return Promise.resolve(z)};u.prototype.addIceCandidate=function(m){var n=this,x;return m&&void 0===m.sdpMLineIndex&&!m.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(z,B){if(n._remoteDescription)if(m&&""!==m.candidate){var C=m.sdpMLineIndex;if(m.sdpMid)for(var G=0;G<n.transceivers.length;G++)if(n.transceivers[G].mid===m.sdpMid){C=G;break}var L=n.transceivers[C];if(L){if(L.rejected)return z();
G=0<Object.keys(m.candidate).length?f.parseCandidate(m.candidate):{};if("tcp"===G.protocol&&(0===G.port||9===G.port)||G.component&&1!==G.component)return z();if((0===C||0<C&&L.iceTransport!==n.transceivers[0].iceTransport)&&!r(L.iceTransport,G))return B(k("OperationError","Can not add ICE candidate"));B=m.candidate.trim();0===B.indexOf("a=")&&(B=B.substr(2));x=f.getMediaSections(n._remoteDescription.sdp);x[C]+="a="+(G.type?B:"end-of-candidates")+"\r\n";n._remoteDescription.sdp=f.getDescription(n._remoteDescription.sdp)+
x.join("")}else return B(k("OperationError","Can not add ICE candidate"))}else for(C=0;C<n.transceivers.length&&(n.transceivers[C].rejected||(n.transceivers[C].iceTransport.addRemoteCandidate({}),x=f.getMediaSections(n._remoteDescription.sdp),x[C]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=f.getDescription(n._remoteDescription.sdp)+x.join(""),!n.usingBundle));C++);else return B(k("InvalidStateError","Can not add ICE candidate without a remote description"));z()})};u.prototype.getStats=function(m){if(m&&
m instanceof l.MediaStreamTrack){var n=null;this.transceivers.forEach(function(z){z.rtpSender&&z.rtpSender.track===m?n=z.rtpSender:z.rtpReceiver&&z.rtpReceiver.track===m&&(n=z.rtpReceiver)});if(!n)throw k("InvalidAccessError","Invalid selector.");return n.getStats()}var x=[];this.transceivers.forEach(function(z){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(B){z[B]&&x.push(z[B].getStats())})});return Promise.all(x).then(function(z){var B=new Map;z.forEach(function(C){C.forEach(function(G){B.set(G.id,
G)})});return B})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(m){if((m=l[m])&&m.prototype&&m.prototype.getStats){var n=m.prototype.getStats;m.prototype.getStats=function(){return n.apply(this).then(function(x){var z=new Map;Object.keys(x).forEach(function(B){var C=x[B];x[B].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[C.type]||
C.type;z.set(B,x[B])});return z})}}});var A=["createOffer","createAnswer"];A.forEach(function(m){var n=u.prototype[m];u.prototype[m]=function(){var x=arguments;return"function"===typeof x[0]||"function"===typeof x[1]?n.apply(this,[arguments[2]]).then(function(z){"function"===typeof x[0]&&x[0].apply(null,[z])},function(z){"function"===typeof x[1]&&x[1].apply(null,[z])}):n.apply(this,arguments)}});A=["setLocalDescription","setRemoteDescription","addIceCandidate"];A.forEach(function(m){var n=u.prototype[m];
u.prototype[m]=function(){var x=arguments;return"function"===typeof x[1]||"function"===typeof x[2]?n.apply(this,arguments).then(function(){"function"===typeof x[1]&&x[1].apply(null)},function(z){"function"===typeof x[2]&&x[2].apply(null,[z])}):n.apply(this,arguments)}});["getStats"].forEach(function(m){var n=u.prototype[m];u.prototype[m]=function(){var x=arguments;return"function"===typeof x[1]?n.apply(this,arguments).then(function(){"function"===typeof x[1]&&x[1].apply(null)}):n.apply(this,arguments)}});
return u}},{sdp:17}],17:[function(a,b,c){var e={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};e.localCName=e.generateIdentifier();e.splitLines=function(d){return d.trim().split("\n").map(function(h){return h.trim()})};e.splitSections=function(d){return d.split("\nm=").map(function(h,g){return(0<g?"m="+h:h).trim()+"\r\n"})};e.getDescription=function(d){return(d=e.splitSections(d))&&d[0]};e.getMediaSections=function(d){d=e.splitSections(d);d.shift();return d};e.matchPrefix=
function(d,h){return e.splitLines(d).filter(function(g){return 0===g.indexOf(h)})};e.parseCandidate=function(d){d=0===d.indexOf("a=candidate:")?d.substring(12).split(" "):d.substring(10).split(" ");for(var h={foundation:d[0],component:parseInt(d[1],10),protocol:d[2].toLowerCase(),priority:parseInt(d[3],10),ip:d[4],address:d[4],port:parseInt(d[5],10),type:d[7]},g=8;g<d.length;g+=2)switch(d[g]){case "raddr":h.relatedAddress=d[g+1];break;case "rport":h.relatedPort=parseInt(d[g+1],10);break;case "tcptype":h.tcpType=
d[g+1];break;case "ufrag":h.ufrag=d[g+1];h.usernameFragment=d[g+1];break;default:h[d[g]]=d[g+1]}return h};e.writeCandidate=function(d){var h=[];h.push(d.foundation);h.push(d.component);h.push(d.protocol.toUpperCase());h.push(d.priority);h.push(d.address||d.ip);h.push(d.port);var g=d.type;h.push("typ");h.push(g);"host"!==g&&d.relatedAddress&&d.relatedPort&&(h.push("raddr"),h.push(d.relatedAddress),h.push("rport"),h.push(d.relatedPort));d.tcpType&&"tcp"===d.protocol.toLowerCase()&&(h.push("tcptype"),
h.push(d.tcpType));if(d.usernameFragment||d.ufrag)h.push("ufrag"),h.push(d.usernameFragment||d.ufrag);return"candidate:"+h.join(" ")};e.parseIceOptions=function(d){return d.substr(14).split(" ")};e.parseRtpMap=function(d){d=d.substr(9).split(" ");var h={payloadType:parseInt(d.shift(),10)};d=d[0].split("/");h.name=d[0];h.clockRate=parseInt(d[1],10);h.channels=3===d.length?parseInt(d[2],10):1;h.numChannels=h.channels;return h};e.writeRtpMap=function(d){var h=d.payloadType;void 0!==d.preferredPayloadType&&
(h=d.preferredPayloadType);var g=d.channels||d.numChannels||1;return"a=rtpmap:"+h+" "+d.name+"/"+d.clockRate+(1!==g?"/"+g:"")+"\r\n"};e.parseExtmap=function(d){d=d.substr(9).split(" ");return{id:parseInt(d[0],10),direction:0<d[0].indexOf("/")?d[0].split("/")[1]:"sendrecv",uri:d[1]}};e.writeExtmap=function(d){return"a=extmap:"+(d.id||d.preferredId)+(d.direction&&"sendrecv"!==d.direction?"/"+d.direction:"")+" "+d.uri+"\r\n"};e.parseFmtp=function(d){for(var h={},g=d.substr(d.indexOf(" ")+1).split(";"),
r=0;r<g.length;r++)d=g[r].trim().split("="),h[d[0].trim()]=d[1];return h};e.writeFmtp=function(d){var h="",g=d.payloadType;void 0!==d.preferredPayloadType&&(g=d.preferredPayloadType);if(d.parameters&&Object.keys(d.parameters).length){var r=[];Object.keys(d.parameters).forEach(function(k){d.parameters[k]?r.push(k+"="+d.parameters[k]):r.push(k)});h+="a=fmtp:"+g+" "+r.join(";")+"\r\n"}return h};e.parseRtcpFb=function(d){d=d.substr(d.indexOf(" ")+1).split(" ");return{type:d.shift(),parameter:d.join(" ")}};
e.writeRtcpFb=function(d){var h="",g=d.payloadType;void 0!==d.preferredPayloadType&&(g=d.preferredPayloadType);d.rtcpFeedback&&d.rtcpFeedback.length&&d.rtcpFeedback.forEach(function(r){h+="a=rtcp-fb:"+g+" "+r.type+(r.parameter&&r.parameter.length?" "+r.parameter:"")+"\r\n"});return h};e.parseSsrcMedia=function(d){var h=d.indexOf(" "),g={ssrc:parseInt(d.substr(7,h-7),10)},r=d.indexOf(":",h);-1<r?(g.attribute=d.substr(h+1,r-h-1),g.value=d.substr(r+1)):g.attribute=d.substr(h+1);return g};e.parseSsrcGroup=
function(d){d=d.substr(13).split(" ");return{semantics:d.shift(),ssrcs:d.map(function(h){return parseInt(h,10)})}};e.getMid=function(d){if(d=e.matchPrefix(d,"a=mid:")[0])return d.substr(6)};e.parseFingerprint=function(d){d=d.substr(14).split(" ");return{algorithm:d[0].toLowerCase(),value:d[1]}};e.getDtlsParameters=function(d,h){return{role:"auto",fingerprints:e.matchPrefix(d+h,"a=fingerprint:").map(e.parseFingerprint)}};e.writeDtlsParameters=function(d,h){var g="a=setup:"+h+"\r\n";d.fingerprints.forEach(function(r){g+=
"a=fingerprint:"+r.algorithm+" "+r.value+"\r\n"});return g};e.parseCryptoLine=function(d){d=d.substr(9).split(" ");return{tag:parseInt(d[0],10),cryptoSuite:d[1],keyParams:d[2],sessionParams:d.slice(3)}};e.writeCryptoLine=function(d){return"a=crypto:"+d.tag+" "+d.cryptoSuite+" "+("object"===typeof d.keyParams?e.writeCryptoKeyParams(d.keyParams):d.keyParams)+(d.sessionParams?" "+d.sessionParams.join(" "):"")+"\r\n"};e.parseCryptoKeyParams=function(d){if(0!==d.indexOf("inline:"))return null;d=d.substr(7).split("|");
return{keyMethod:"inline",keySalt:d[0],lifeTime:d[1],mkiValue:d[2]?d[2].split(":")[0]:void 0,mkiLength:d[2]?d[2].split(":")[1]:void 0}};e.writeCryptoKeyParams=function(d){return d.keyMethod+":"+d.keySalt+(d.lifeTime?"|"+d.lifeTime:"")+(d.mkiValue&&d.mkiLength?"|"+d.mkiValue+":"+d.mkiLength:"")};e.getCryptoParameters=function(d,h){return e.matchPrefix(d+h,"a=crypto:").map(e.parseCryptoLine)};e.getIceParameters=function(d,h){var g=e.matchPrefix(d+h,"a=ice-ufrag:")[0];d=e.matchPrefix(d+h,"a=ice-pwd:")[0];
return g&&d?{usernameFragment:g.substr(12),password:d.substr(10)}:null};e.writeIceParameters=function(d){return"a=ice-ufrag:"+d.usernameFragment+"\r\na=ice-pwd:"+d.password+"\r\n"};e.parseRtpParameters=function(d){for(var h={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},g=e.splitLines(d)[0].split(" "),r=3;r<g.length;r++){var k=g[r],f=e.matchPrefix(d,"a=rtpmap:"+k+" ")[0];if(f){f=e.parseRtpMap(f);var l=e.matchPrefix(d,"a=fmtp:"+k+" ");f.parameters=l.length?e.parseFmtp(l[0]):{};f.rtcpFeedback=
e.matchPrefix(d,"a=rtcp-fb:"+k+" ").map(e.parseRtcpFb);h.codecs.push(f);switch(f.name.toUpperCase()){case "RED":case "ULPFEC":h.fecMechanisms.push(f.name.toUpperCase())}}}e.matchPrefix(d,"a=extmap:").forEach(function(t){h.headerExtensions.push(e.parseExtmap(t))});return h};e.writeRtpDescription=function(d,h){var g="";g+="m="+d+" ";g+=0<h.codecs.length?"9":"0";g+=" UDP/TLS/RTP/SAVPF ";g+=h.codecs.map(function(k){return void 0!==k.preferredPayloadType?k.preferredPayloadType:k.payloadType}).join(" ")+
"\r\n";g+="c=IN IP4 0.0.0.0\r\n";g+="a=rtcp:9 IN IP4 0.0.0.0\r\n";h.codecs.forEach(function(k){g+=e.writeRtpMap(k);g+=e.writeFmtp(k);g+=e.writeRtcpFb(k)});var r=0;h.codecs.forEach(function(k){k.maxptime>r&&(r=k.maxptime)});0<r&&(g+="a=maxptime:"+r+"\r\n");g+="a=rtcp-mux\r\n";h.headerExtensions&&h.headerExtensions.forEach(function(k){g+=e.writeExtmap(k)});return g};e.parseRtpEncodingParameters=function(d){var h=[],g=e.parseRtpParameters(d),r=-1!==g.fecMechanisms.indexOf("RED"),k=-1!==g.fecMechanisms.indexOf("ULPFEC"),
f=e.matchPrefix(d,"a=ssrc:").map(function(q){return e.parseSsrcMedia(q)}).filter(function(q){return"cname"===q.attribute}),l=0<f.length&&f[0].ssrc,t;f=e.matchPrefix(d,"a=ssrc-group:FID").map(function(q){return q.substr(17).split(" ").map(function(y){return parseInt(y,10)})});0<f.length&&1<f[0].length&&f[0][0]===l&&(t=f[0][1]);g.codecs.forEach(function(q){"RTX"===q.name.toUpperCase()&&q.parameters.apt&&(q={ssrc:l,codecPayloadType:parseInt(q.parameters.apt,10)},l&&t&&(q.rtx={ssrc:t}),h.push(q),r&&(q=
JSON.parse(JSON.stringify(q)),q.fec={ssrc:l,mechanism:k?"red+ulpfec":"red"},h.push(q)))});0===h.length&&l&&h.push({ssrc:l});var v=e.matchPrefix(d,"b=");v.length&&(v=0===v[0].indexOf("b=TIAS:")?parseInt(v[0].substr(7),10):0===v[0].indexOf("b=AS:")?950*parseInt(v[0].substr(5),10)-16E3:void 0,h.forEach(function(q){q.maxBitrate=v}));return h};e.parseRtcpParameters=function(d){var h={},g=e.matchPrefix(d,"a=ssrc:").map(function(r){return e.parseSsrcMedia(r)}).filter(function(r){return"cname"===r.attribute})[0];
g&&(h.cname=g.value,h.ssrc=g.ssrc);g=e.matchPrefix(d,"a=rtcp-rsize");h.reducedSize=0<g.length;h.compound=0===g.length;d=e.matchPrefix(d,"a=rtcp-mux");h.mux=0<d.length;return h};e.parseMsid=function(d){var h=e.matchPrefix(d,"a=msid:");if(1===h.length)return d=h[0].substr(7).split(" "),{stream:d[0],track:d[1]};d=e.matchPrefix(d,"a=ssrc:").map(function(g){return e.parseSsrcMedia(g)}).filter(function(g){return"msid"===g.attribute});if(0<d.length)return d=d[0].value.split(" "),{stream:d[0],track:d[1]}};
e.parseSctpDescription=function(d){var h=e.parseMLine(d),g=e.matchPrefix(d,"a=max-message-size:"),r;0<g.length&&(r=parseInt(g[0].substr(19),10));isNaN(r)&&(r=65536);g=e.matchPrefix(d,"a=sctp-port:");if(0<g.length)return{port:parseInt(g[0].substr(12),10),protocol:h.fmt,maxMessageSize:r};if(0<e.matchPrefix(d,"a=sctpmap:").length)return d=e.matchPrefix(d,"a=sctpmap:")[0].substr(10).split(" "),{port:parseInt(d[0],10),protocol:d[1],maxMessageSize:r}};e.writeSctpDescription=function(d,h){d="DTLS/SCTP"!==
d.protocol?["m="+d.kind+" 9 "+d.protocol+" "+h.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+h.port+"\r\n"]:["m="+d.kind+" 9 "+d.protocol+" "+h.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+h.port+" "+h.protocol+" 65535\r\n"];void 0!==h.maxMessageSize&&d.push("a=max-message-size:"+h.maxMessageSize+"\r\n");return d.join("")};e.generateSessionId=function(){return Math.random().toString().substr(2,21)};e.writeSessionBoilerplate=function(d,h,g){h=void 0!==h?h:2;d=d?d:e.generateSessionId();return"v=0\r\no="+
(g||"thisisadapterortc")+" "+d+" "+h+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"};e.writeMediaSection=function(d,h,g,r){h=e.writeRtpDescription(d.kind,h);h+=e.writeIceParameters(d.iceGatherer.getLocalParameters());h+=e.writeDtlsParameters(d.dtlsTransport.getLocalParameters(),"offer"===g?"actpass":"active");h+="a=mid:"+d.mid+"\r\n";h=d.direction?h+("a="+d.direction+"\r\n"):d.rtpSender&&d.rtpReceiver?h+"a=sendrecv\r\n":d.rtpSender?h+"a=sendonly\r\n":d.rtpReceiver?h+"a=recvonly\r\n":h+"a=inactive\r\n";d.rtpSender&&
(g="msid:"+r.id+" "+d.rtpSender.track.id+"\r\n",h=h+("a="+g)+("a=ssrc:"+d.sendEncodingParameters[0].ssrc+" "+g),d.sendEncodingParameters[0].rtx&&(h+="a=ssrc:"+d.sendEncodingParameters[0].rtx.ssrc+" "+g,h+="a=ssrc-group:FID "+d.sendEncodingParameters[0].ssrc+" "+d.sendEncodingParameters[0].rtx.ssrc+"\r\n"));h+="a=ssrc:"+d.sendEncodingParameters[0].ssrc+" cname:"+e.localCName+"\r\n";d.rtpSender&&d.sendEncodingParameters[0].rtx&&(h+="a=ssrc:"+d.sendEncodingParameters[0].rtx.ssrc+" cname:"+e.localCName+
"\r\n");return h};e.getDirection=function(d,h){d=e.splitLines(d);for(var g=0;g<d.length;g++)switch(d[g]){case "a=sendrecv":case "a=sendonly":case "a=recvonly":case "a=inactive":return d[g].substr(2)}return h?e.getDirection(h):"sendrecv"};e.getKind=function(d){return e.splitLines(d)[0].split(" ")[0].substr(2)};e.isRejected=function(d){return"0"===d.split(" ",2)[1]};e.parseMLine=function(d){d=e.splitLines(d)[0].substr(2).split(" ");return{kind:d[0],port:parseInt(d[1],10),protocol:d[2],fmt:d.slice(3).join(" ")}};
e.parseOLine=function(d){d=e.matchPrefix(d,"o=")[0].substr(2).split(" ");return{username:d[0],sessionId:d[1],sessionVersion:parseInt(d[2],10),netType:d[3],addressType:d[4],address:d[5]}};e.isValidSDP=function(d){if("string"!==typeof d||0===d.length)return!1;d=e.splitLines(d);for(var h=0;h<d.length;h++)if(2>d[h].length||"="!==d[h].charAt(1))return!1;return!0};"object"===typeof b&&(b.exports=e)},{}]},{},[1])(1)});const S={WS_Disconnected:0,WS_Connecting:1,WS_Connected:2,RTC_Opened:3,Video_LoadedMetaData:4,
OnReady:5},ba={StartingProcess:0,CheckingBusy:1,ConfirmBusy:2,ProcessStartFailed:3,ProcessStarted:4,LoadingProject:5,ProjectLoaded:6};class Pb{constructor(){"undefined"!=typeof navigator&&(this.isUnix="Mac68K"==navigator.platform||"MacPPC"==navigator.platform||"Macintosh"==navigator.platform||"MacIntel"==navigator.platform||-1!=navigator.platform.indexOf("Linux"),this.isChrome=-1!=navigator.userAgent.indexOf("Chrome"),this.isMobileDevice=/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent),
this.isIOSDevice=/iPhone|iPad|iPod/i.test(navigator.userAgent),this.isAndroidDevice=/Android/i.test(navigator.userAgent),this.isInWeixinBrowser)}fullscreen(a){a&&(a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.msRequestFullscreen?a.msRequestFullscreen:a.webkitRequestFullscreen&&a.webkitRequestFullscreen())}exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen||(document.mozCancelFullScreen?document.mozCancelFullScreen():
document.webkitCancelFullScreen&&document.webkitCancelFullScreen())}isFullscreen(){return document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen}isFunction(a){return"function"==typeof a}}var Q=new Pb;const ra={abnormal:1006,invalid_message:1008,no_free_instance:1013,out_of_control:4E3,instance_disconnected:4001,instance_not_found:4002,instance_start_failed:4003,webrtc_connection_error:4004,one_client_allowed:4005,timeout:4006,iid_required:4007,locked:4008,invalid_project:4009,kicked:4100,
syncing_data:4101,instance_killed_by_user:4102,invalid_password:4103,nodeservice_stopped:4105,instance_is_busy:4107,ip_not_authorized:4108,invalid_token:4109};class Qb{constructor(a){this.FrameDisplayDeltaTimeMs=this.BrowserReceiptTimeMs=this.UETransmissionTimeMs=this.UECaptureToSendMs=this.UEEncodeMs=this.UEReceiptTimeMs=this.TestStartTimeMs=null;this.onReady=a}reset(){this.FrameDisplayDeltaTimeMs=this.BrowserReceiptTimeMs=this.UETransmissionTimeMs=this.UEEncodeMs=this.UECaptureToSendMs=this.UEReceiptTimeMs=
this.TestStartTimeMs=null}start(){this.reset();this.TestStartTimeMs=Date.now();if(this.onReady)this.onReady()}setUETimings(a){this.UEReceiptTimeMs=a.ReceiptTimeMs;this.UEEncodeMs=a.EncodeMs;this.UECaptureToSendMs=a.CaptureToSendMs;this.UETransmissionTimeMs=a.TransmissionTimeMs;this.BrowserReceiptTimeMs=Date.now();this.latencyTimingsReady()}setFrameDisplayDeltaTime(a){null==this.FrameDisplayDeltaTimeMs&&(this.FrameDisplayDeltaTimeMs=Math.round(a),this.latencyTimingsReady())}latencyTimingsReady(){if(this.BrowserReceiptTimeMs){var a=
this.BrowserReceiptTimeMs-this.TestStartTimeMs,b=this.UECaptureToSendMs,c=this.UETransmissionTimeMs-this.UEReceiptTimeMs,e=a-c,d={latencyExcludingDecode:a,encodeLatency:this.UEEncodeMs.toFixed(1),uePixelStreamLatency:b.toFixed(1),ueTestDuration:c.toFixed(1),networkLatency:e.toFixed(1)};this.FrameDisplayDeltaTimeMs&&this.BrowserReceiptTimeMs&&(d.endToEndLatency=this.FrameDisplayDeltaTimeMs+e+("string"===typeof b?0:b),d.browserSideLatency=this.FrameDisplayDeltaTimeMs+(a-e-c),d.endToEndLatency=d.endToEndLatency.toFixed(1),
d.browserSideLatency=d.browserSideLatency.toFixed(1));if(this.onReady)this.onReady(d)}}}class Rb{constructor(a){this.useStats=a.useStats;this.events=a.events;this.webRtcConfig=a.peerConnectionOptions||{};this.webRtcConfig.sdpSemantics="unified-plan";this.tnClient=this.dcClient=this.pcClient=null;this.sdpConstraints={offerToReceiveAudio:0,offerToReceiveVideo:1,voiceActivityDetection:!1};this.dataChannelOptions={ordered:!0};this.lastStats={};this.playerId=0;this.latencyTestTimings=new Qb(this.events.onLatencyTimingsReady);
this._bSendingAPI=!1;this._apiSendingQueue=[]}setVideo(a){this.video=a}logStartupInfo(a){if(this.events.onlog)this.events.onlog(a)}setupPeerConnection(){this.pcClient||(this.pcClient=new RTCPeerConnection(this.webRtcConfig),this.pcClient.addTransceiver("video",{direction:"recvonly"}),this.pcClient.onsignalingstatechange=a=>this.onStateChanged(a),this.pcClient.oniceconnectionstatechange=a=>this.onStateChanged(a),this.pcClient.onicegatheringstatechange=a=>this.onStateChanged(a),this.pcClient.ontrack=
a=>this.events.ontrack(a),this.pcClient.onicecandidate=a=>this.events.onicecandidate(a),this.pcClient.ondatachannel=a=>{this.dcClient=a.channel;this.setupDataChannelCallbacks()})}close(){this.dcClient&&"open"==this.dcClient.readyState&&(this.dcClient.close(),this.dcClient=null);this.pcClient&&(this.pcClient.close(),this.pcClient=null);this.clearStatsTimer()}setupDataChannelCallbacks(){this.dcClient.binaryType="arraybuffer";this.dcClient.onopen=a=>{this.isDatachannelOpened=!0;if(this.events&&this.events.ondatachannelopen)this.events.ondatachannelopen(a);
this.logStartupInfo("video: loading...")};this.dcClient.onclose=a=>{this.isDatachannelOpened=!1;this.clearStatsTimer();if(this.events&&this.events.ondatachannelclose)this.events.ondatachannelclose(a)};this.dcClient.onerror=a=>{this.isDatachannelOpened=!1;this.logStartupInfo("channel error");if(this.events&&this.events.ondatachannelerror)this.events.ondatachannelerror(a)};this.dcClient.onmessage=a=>this.onDatachannelMessage(a)}createOffer(){this.close();this.setupPeerConnection();try{this.dcClient=
this.pcClient.createDataChannel("cirrus",this.dataChannelOptions),this.setupDataChannelCallbacks(),this.logStartupInfo("channel created")}catch(a){this.logStartupInfo("no channel"),this.dcClient=null}this.pcClient.createOffer(this.sdpConstraints).then(a=>{a.sdp=a.sdp.replace("useinbandfec=1","useinbandfec=1;stereo=1;sprop-maxcapturerate=48000");this.pcClient.setLocalDescription(a);this.events.onOfferCreated(a)},()=>{this.logStartupInfo("couldn't create offer")})}onReceiveOffer(a){a=new RTCSessionDescription(a);
this.setupPeerConnection();this.pcClient.setRemoteDescription(a).then(()=>{this.pcClient.createAnswer().then(b=>this.pcClient.setLocalDescription(b)).then(()=>{if(this.events.onAnswerCreated)this.events.onAnswerCreated(this.pcClient.currentLocalDescription)}).then(()=>{let b=this.pcClient.getReceivers();for(let c of b)c.playoutDelayHint=0}).catch(b=>console.error("createAnswer() failed:",b))});this.setupLiveStats()}onIceCandidate(a){a=new RTCIceCandidate(a);this.pcClient.addIceCandidate(a).then(b=>
{this.logStartupInfo("candidate added")})}onReceiveAnswer(a){this.playerId=a.playerId;this.logStartupInfo(`received answer: ${this.playerId}`);a=new RTCSessionDescription(a);this.pcClient.setRemoteDescription(a);a=this.pcClient.getReceivers();for(let b of a)b.playoutDelayHint=0;this.setupLiveStats()}setupLiveStats(){this.clearStatsTimer();this.useStats&&!this.aggregateStatsIntervalId&&(this.aggregateStatsIntervalId=setInterval(()=>{this.pcClient&&this.pcClient.getStats(null).then(a=>this.processLiveStats(a))},
1E3))}onStateChanged(a){this.signalingState!=this.pcClient.signalingState&&(this.signalingState=this.pcClient.signalingState,this.logStartupInfo(`__signaling: ${this.signalingState}`));this.iceConnectionState!=this.pcClient.iceConnectionState&&(this.iceConnectionState=this.pcClient.iceConnectionState,this.logStartupInfo(`__ice_connection: ${this.iceConnectionState}`),"disconnected"!=this.iceConnectionState||this.isDatachannelOpened||this.logStartupInfo("\u8fde\u63a5\u5efa\u7acb\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u670d\u52a1\u5668\u7aef\u53e3\u8bbe\u7f6e"),
"failed"!=this.iceConnectionState||this.isDatachannelOpened||this.logStartupInfo("\u8fde\u63a5\u5efa\u7acb\u5931\u8d25\uff0c\u65e0\u53ef\u7528\u7684\u5019\u9009\u8fde\u63a5"));this.iceGatheringState!=this.pcClient.iceGatheringState&&(this.iceGatheringState=this.pcClient.iceGatheringState,this.logStartupInfo(`__ice_gathering: ${this.iceGatheringState}`))}clearStatsTimer(){this.aggregateStatsIntervalId&&(clearInterval(this.aggregateStatsIntervalId),this.aggregateStatsIntervalId=void 0)}send(a){return this.dcClient&&
"open"==this.dcClient.readyState?(this.dcClient.send(a),!0):!1}requestInitialSettings(){this.send((new Uint8Array([7])).buffer)}requestQualityControl(){this.send((new Uint8Array([1])).buffer)}sendEnableIntervalSendQP(a){this.send((new Uint8Array([11,a?1:0])).buffer)}_continueSendAPI(){if(0<this._apiSendingQueue.length){let a=this._apiSendingQueue.shift();this.sendAPI(a)}}sendAPI(a){if(this._bSendingAPI)this._apiSendingQueue.push(a);else{this._bSendingAPI=!0;a.__playerId=this.playerId;var b=JSON.stringify(a),
c=b.length,e=this.pcClient.sctp?Math.min(this.pcClient.sctp.maxMessageSize,65536):65536,d=(e-4)/2;if(c>d){this.numOfEventCalls=0;let g=Math.ceil(c/d),r=[];for(var h=0;h<g;h++){let t=h==g-1?c-h*d:d;r[h]={type:0==h?1:h==g-1?3:2,stringLength:t,content:b.substr(h*d,t)}}let k=0,f=t=>{for(t=this.dcClient.bufferedAmount;k<r.length;){var v=r[k++];let q=new DataView(new ArrayBuffer(4+2*v.stringLength)),y=0;q.setUint8(y,52);y++;q.setUint8(y,v.type);y++;q.setUint16(y,v.stringLength,!0);y+=2;v=v.content;for(let u=
0;u<v.length;u++)q.setUint16(y,v.charCodeAt(u),!0),y+=2;t+=q.byteLength;this.send(q.buffer);if(k==g-1)console.log(`api(command: ${a.command}) slices send finished. bufferedamountlow calls: ${this.numOfEventCalls}`),this.dcClient.onbufferedamountlow=null,this._bSendingAPI=!1,setTimeout(()=>this._continueSendAPI(),100);else if(t>l)break}},l=Math.max(8*e,1048576);this.dcClient.bufferedAmountLowThreshold=e;this.dcClient.onbufferedamountlow=t=>{this.numOfEventCalls++;f()};console.log(`sending api(command: ${a.command}) slices, count: ${g}`);
f()}else{e=new DataView(new ArrayBuffer(4+2*c));d=0;e.setUint8(d,52);d++;e.setUint8(d,0);d++;e.setUint16(d,c,!0);d+=2;for(h=0;h<c;h++)e.setUint16(d,b.charCodeAt(h),!0),d+=2;this.send(e.buffer);this._bSendingAPI=!1;this._continueSendAPI()}}}sendDescriptor(a,b){b=JSON.stringify(b);let c=new DataView(new ArrayBuffer(3+2*b.length)),e=0;c.setUint8(e,a);e++;c.setUint16(e,b.length,!0);e+=2;for(a=0;a<b.length;a++)c.setUint16(e,b.charCodeAt(a),!0),e+=2;this.send(c.buffer)}updateRenderResolution(a,b){a={Console:"setres "+
a+"x"+b+"w"};console.log(JSON.stringify(a));this.sendDescriptor(50,a)}updateParams(a){a.encodeMaxQP&&this.sendDescriptor(50,{Console:"PixelStreaming.Encoder.MaxQP "+a.encodeMaxQP});a.keyframeInterval&&this.sendDescriptor(50,{Console:"PixelStreaming.Encoder.KeyframeInterval "+a.keyframeInterval});a.maxBitrate&&this.sendDescriptor(50,{Console:"PixelStreaming.WebRTC.MaxBitrate "+a.maxBitrate})}processLiveStats(a){let b={};a.forEach(c=>{"inbound-rtp"!=c.type||c.isRemote||"video"!=c.mediaType&&!c.id.toLowerCase().includes("video")||
(b.timestamp=c.timestamp,b.timestampStart=this.lastStats&&this.lastStats.timestampStart?this.lastStats.timestampStart:c.timestamp,b.bytesReceived=c.bytesReceived,b.packetsLost=c.packetsLost,b.framesDropped=c.framesDropped,b.framesPerSecond=c.framesPerSecond,b.framesReceived=c.framesReceived,b.framesDecoded=c.framesDecoded,b.keyFramesDecoded=c.keyFramesDecoded,this.lastStats&&(b.bitrate=8*(b.bytesReceived-this.lastStats.bytesReceived)/(b.timestamp-this.lastStats.timestamp)));"track"==c.type&&c.frameWidth&&
(c.framesDropped&&(b.framesDropped=c.framesDropped),c.framesReceived&&(b.framesReceived=c.framesReceived),b.frameWidth=c.frameWidth,b.frameHeight=c.frameHeight);"candidate-pair"==c.type&&c.hasOwnProperty("currentRoundTripTime")&&0!=c.currentRoundTripTime&&(b.currentRoundTripTime=c.currentRoundTripTime)});this.lastStats.receiveToCompositeMs&&(b.receiveToCompositeMs=this.lastStats.receiveToCompositeMs,this.latencyTestTimings.setFrameDisplayDeltaTime(this.lastStats.receiveToCompositeMs));this.lastStats=
b;this.events.onstats(this.lastStats)}onDatachannelMessage(a){var b=new Uint8Array(a.data);switch(b[0]){case 0:this.events.ondatachannelmessage("QualityControlOwnership",1==b[1]);break;case 1:if((a=(new TextDecoder("utf-16")).decode(a.data.slice(1)))&&""!=a)this.events.ondatachannelmessage("ResponseAPI",a);break;case 101:b=b[1];a=(new TextDecoder("utf-8")).decode(a.data.slice(2));switch(b){case 0:this.events.ondatachannelmessage("ResponseAPI",a);break;case 1:this.reponse_api_json_string=a;break;case 2:this.reponse_api_json_string+=
a;break;case 3:this.reponse_api_json_string+=a,this.events.ondatachannelmessage("ResponseAPI",this.reponse_api_json_string)}break;case 6:a=(new TextDecoder("utf-16")).decode(a.data.slice(1));a=JSON.parse(a);this.latencyTestTimings.setUETimings(a);break;case 7:a=(new TextDecoder("utf-16")).decode(a.data.slice(1));a=JSON.parse(a);if(a.Encoder)this.events.ondatachannelmessage("InitialSettings",a);break;case 5:this.events.ondatachannelmessage("VideoEncoderAvgQP",a)}}startLatencyTest(){this.video&&(this.latencyTestTimings.start(),
this.sendDescriptor(6,{StartTime:this.latencyTestTimings.TestStartTimeMs}))}}class Sb{constructor(a){this.options=a;this.checkParamsMap=new Map}connect(a){window.WebSocket=window.WebSocket||window.MozWebSocket;window.WebSocket?(this.websocket=new WebSocket(a),this.websocket.onopen=()=>{if(this.options.onopen)this.options.onopen();setInterval(()=>{this.send({type:"ping",time:(new Date).getTime()})},6E4)},this.websocket.onmessage=b=>{if(b=JSON.parse(b.data)){switch(b.type){case "checkParamsResult":this.onCheckParamsResponse(o);
return;case "detectResponse":this.send(b);return}if(this.options.onmessage)this.options.onmessage(b)}},this.websocket.onerror=b=>{if(this.options.onerror)this.options.onerror(b)},this.websocket.onclose=b=>{this.websocket=void 0;if(this.options.onclose)this.options.onclose(b)}):alert("Your browser does not support WebSocket")}isOpened(){return this.websocket&&1===this.websocket.readyState}send(a){a&&this.isOpened()&&this.websocket.send(JSON.stringify(a))}close(a){console.log(`call SignallingConnection.close: ${a||
" "}`);this.isOpened()&&(this.websocket.close(a),this.websocket=null)}sendReady(){this.send({type:"ready"})}sendCandidate(a){a.candidate&&a.candidate.candidate&&this.send({type:"iceCandidate",candidate:a.candidate})}sendOffer(a,b){this.send({type:"offer",sdp:a,hasVideo:b})}updateParams(a){this.send({type:"updateParams",data:a})}checkParams(a){a.timestamp=Date.now();return new Promise(b=>{this.checkParamsMap[a.timestamp]=b;this.send({type:"checkParams",data:a});this.timerOfCheckParams=setTimeout(()=>
{let c=this.checkParamsMap[a.timestamp];c&&(delete this.checkParamsMap[a.timestamp],c(null))},1E3)})}onCheckParamsResponse(a){let b=this.checkParamsMap[a.timestamp];b&&(clearTimeout(this.timerOfCheckParams),delete this.checkParamsMap[a.timestamp],b(a))}}Y.EMPTY_OBJECT=Object.freeze({});class la{}la.doParamsCompatibility=a=>{a.apiOptions=a.apiOptions||{};a.events=a.events||{};a.ui=a.ui||{};a.showMarker&&(a.showStatus=a.showMarker,delete a.showMarker);a.actionEventHander&&(a.onaction=a.actionEventHander,
delete a.actionEventHander);a.useBuiltinCursor&&(a.useBuiltinCursors=a.useBuiltinCursor,delete a.useBuiltinCursor);a.keyEventReceiver&&(a.keyEventTarget=a.keyEventReceiver,delete a.keyEventReceiver);var b=(c,e)=>{let d=a[c];d&&(a.events[e]=d,delete a[c])};b("onclose","onConnClose");b("onloaded","onVideoLoaded");b("onvideostatus","onRtcStatsReport");b("onaction","mouseKeyListener");b=(c,e)=>{let d=a.events.mouseKeyListener[c];d&&(a.events.mouseKeyListener[e]=d,delete a.events.mouseKeyListener[c])};
a.events.mouseKeyListener&&(b("onmouseenter","onMouseEnter"),b("onmouseleave","onMouseLeave"),b("onmousemove","onMouseMove"),b("onmousedown","onMouseDown"),b("onmouseup","onMouseUp"),b("onkeydown","onKeyDown"),b("onkeyup","onKeyUp"),b("onkeypress","onKeyPress"));b=(c,e)=>{"undefined"!=typeof a[c]&&(a.ui[e]=a[c],delete a[c])};b("showStartupInfo","startupInfo");b("showStatus","statusButton");b("showFullscreenButton","fullscreenButton");b("showHomeButton","homeButton");b("showTaskList","taskListBar")};
la.setDefaultParamValues=a=>{a.keyEventTarget=Y(a.keyEventTarget,"video");a.useBuiltinCursors=Y(a.useBuiltinCursors,!0);a.ui.startupInfo=Y(a.ui.startupInfo,!0);a.ui.statusIndicator=Y(a.ui.statusIndicator,!0);a.ui.statusButton=Y(a.ui.statusButton,!1);a.ui.fullscreenButton=Y(a.ui.fullscreenButton,!1);a.ui.homeButton=Y(a.ui.homeButton,!1);a.ui.taskListBar=Y(a.ui.taskListBar,1);a.ui.debugTouchPanel=Y(a.ui.debugTouchPanel,!1);a.offer=1};la.processParams=a=>{la.doParamsCompatibility(a);la.setDefaultParamValues(a)};
class Tb{constructor(){this.css("@keyframes __fadeoutframes {0%{opacity:1;} 100%{opacity:0;}}.__fadeoutComp {animation-duration:600ms; animation-name:__fadeoutframes;}@keyframes __fadeinframes {0%{opacity:0;} 100%{opacity:0.65;}}.__fadeinComp {animation-duration:100ms; animation-name:__fadeinframes;}@keyframes twinkling{0%{opacity:0;}100%{opacity:1;}}.__statusIndicator {position:absolute;display:block;left:5px;top:5px;width:6px;height:6px;border-radius:50%;background-color:red;animation:twinkling 0.25s infinite ease-in-out;}.__startupInfoPanel { position:absolute;left:3px;top:0px;width:350px;background-color:transparent !important;text-shadow:black 0.1em 0.1em 0.2em;color:white;font-family:Verdana;font-size:12px !important;overflow:auto;}.__liveStatusPanel {position:absolute;left:5px;top:10px;width:164px;height:300px;background-color:rgba(50,50,50,0.8);color:#00FF00;font-family:Verdana;font-size:10px;box-shadow:0px 0px 5px 5px rgba(200,200,200,0.5);-moz-border-radius:8px;-webkit-border-radius:8px;}.__liveStatusPanel a:link { color: rgb(0,255,128); text-decoration: none; }.__liveStatusPanel a:hover { color: yellow; background:transparent; }.__liveStatusPanel input {background:transparent; border:1px solid gray; color: #00FF00;}.__liveStatusPanel select {background:transparent; border:1px solid gray; color: #00FF00;}.__liveStatusPanel option {background:#333; color: #00FF00;}.__liveStatusSwitchButton{position:absolute;padding:0;left:6px;width:26px;height:26px;opacity:0.65;cursor:pointer;background-size:conver;}.__fullscreeButton {position:absolute;padding:0;left:38px;width:26px;height:26px;opacity:0.65;cursor:pointer;background-size:conver;}.__viewHomeButton {position:absolute;padding:0;left:70px;width:26px;height:26px;opacity:0.65;cursor:pointer;background-size:conver;}.__taskWaiting {position:absolute;z-index:30;text-align:center;padding-left:5px;text-shadow:black 0.1em 0.1em 0.2em;color:lime;font-family:Verdana;font-size:12px !important;overflow:hidden;display:none;}.__touchEventsPanel {position:absolute;left:3px;top:0px;width:600px;height:200px;background-color:rgba(64,64,64,0.5) !important;text-shadow:black 0.1em 0.1em 0.2em;color:white;font-family:Verdana;font-size:12px !important;overflow:auto;}.streamingVideoNoCursor {width:100%;height:100%;}.streamingVideoCursorMove {width:100%;height:100%;cursor:move;}.streamingVideoCursorPan {width:100%;height:100%;cursor:url(data:application/octet-stream;base64,AAACAAEAICAAAA8ADwCoDAAAFgAAACgAAAAgAAAAQAAAAAEAGAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////////8AAAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAD///////8AAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD////////////////////////////////////////////4B///+Af///AH///gA///wAP//8AB///gAf//8AH//+AB///gA///8k///////////////////////////////////////////////////////////////////////w==),auto;}.streamingVideoCursorPointer {width:100%;height:100%;cursor:url(data:application/octet-stream;base64,AAACAAEAICAAAA0ACACoDAAAFgAAACgAAAAgAAAAQAAAAAEAGAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////////////////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAD///////8AAAD///////8AAAD///////8AAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAD///////8AAAD///////8AAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAD///////8AAAD///////8AAAAAAAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAD///////8AAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD////////////////////////////////////////////4B///+Af///AH///gA///wAP//8AB//+AAf//AAD//wAA//+AAP//4AD//+AF///gT///4f///+H////h////8////////////////////////////////////////w==),auto;}.streamingVideoCursorRotate {width:100%;height:100%;cursor:url(data:application/octet-stream;base64,AAACAAEAICAAAA8ADwCoDAAAFgAAACgAAAAgAAAAQAAAAAEAGAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAD///////////////////////////////////////8AAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAD///////////////////////////////////////////8AAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////////////8AAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////////////8AAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAD///////////////////////////////8AAAD///8AAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAD///////8AAAD///////8AAAD///////8AAAAAAAAAAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD////////////////////////////////////////////4B///+Af///AH//hgAh/wwAMP4cABh+HgAYfh8AGH4eABh+HgA4eAck4BwP//A+H//4fz///P/////////////////////////////////////////////////////w==),auto;}")}css(a){let b=
document.createElement("style");try{b.appendChild(document.createTextNode(a))}catch(c){b.styleSheet.cssText=a}(a=document.getElementsByTagName("head")[0])?a.appendChild(b):console.error("[AirCityCloud] No head element found, cannot create css.")}}const ca={BackSpace:8,Shift:16,Control:17,Alt:18,RightShift:253,RightControl:254,RightAlt:255};class fa{constructor(a){this.player=a;this.uid=a.uid;this.container=a.container}appendElement(a){this.container.appendChild(a);this.setNeedReposUI()}removeElement(a){this.container.removeChild(a)}get(a){return ua(a+
"_"+this.uid)}getValue(a){if(a=this.get(a))return a.value}setValue(a,b){(a=this.get(a))&&(a.value=b)}setText(a,b){(a=this.get(a))&&(a.innerText=b)}setHtml(a,b){(a=this.get(a))&&(a.innerHTML=b)}resize(){this.player.resize()}setNeedReposUI(){this.player.bNeedReposUI=!0}}class Ub extends fa{constructor(a,b){super(a);this.video=null;this.useBuiltinCursors=b.useBuiltinCursors;this.keyEventTargetStr=b.keyEventTarget;this.keyEventTarget="document"==b.keyEventTarget?document:"none"==b.keyEventTarget?null:
"video";this.callOnUserInteraction=()=>this.player.resetInteractTimestamp();this.fakeMouseWithTouches=!1;this.mouseKeyListener=b.mouseKeyListener;this.onActionEnable=!0;this.onTouch=b.onTouch;this.onVideoLoaded=b.onVideoLoaded;document.addEventListener("WeixinJSBridgeReady",()=>{Q.isInWeixinBrowser=!0;this.video.play()});this.create()}isVideoLoaded(){return!!this._isVideoLoaded}create(){this.video&&this.destroy();this.video||(this.video=document.createElement("video"),this.video.id=`streamingVideo_${this.uid}`,
this.video.style="position:absolute;",this.video.playsInline=!0,this.video.muted=!0,this.video.autoplay=!0,this.video.disablepictureinpicture=!0,"video"===this.keyEventTarget&&(this.video.tabIndex=1,this.keyEventTarget=this.video),this.appendElement(this.video),this.player.logStartupInfo("video element created"),this._isVideoLoaded=!1,this.video.addEventListener("loadedmetadata",()=>{this._isVideoLoaded=!0;this.video.onmouseenter({button:0,x:0,y:0});this.onVideoLoaded()},!0),this.setCursor());if("requestVideoFrameCallback"in
HTMLVideoElement.prototype){const a=(b,c)=>{c.receiveTime&&c.expectedDisplayTime&&(this.rtc.lastStats.receiveToCompositeMs=c.presentationTime-c.receiveTime);this.video&&this.video.requestVideoFrameCallback(a)};this.video.requestVideoFrameCallback(a)}}setWebRtcPlayer(a){(!this.video||Q.isAndroidDevice||Q.isIOSDevice&&!Q.isInWeixinBrowser)&&this.create();this.rtc=a;this.rtc.setVideo(this.video)}setActionEventEnabled(a){this.onActionEnable=a}destroy(){this.video&&(this.removeElement(this.video),this.video=
null)}valid(){return!!this.video}videoWidth(){if(this.video)return this.video.videoWidth}videoHeight(){if(this.video)return this.video.videoHeight}clientWidth(){if(this.video)return this.video.clientWidth}clientHeight(){if(this.video)return this.video.clientHeight}setTrack(a){let b=a.streams[0];this.player.logStartupInfo("track: "+a.track.kind);"audio"==a.track.kind?(a=document.createElement("Audio"),a.autoplay=!0,a.srcObject=b,a.play(),this.player.logStartupInfo("audio element created")):"video"==
a.track.kind&&this.video.srcObject!==b&&(this.video.srcObject=b)}setKeyEventTarget(a){this.keyEventTargetStr!=a&&(this.clearKeyboardEvents(),"video"==a?(this.video&&(this.video.tabIndex=1),this.keyEventTarget=this.video,this.video.focus()):"document"==a?(this.keyEventTarget=document,this.video.focus()):this.keyEventTarget&&(this.keyEventTarget=null),this.keyEventTargetStr=a,this.registerKeyboardEvents())}clearKeyboardEvents(){this.keyEventTarget&&(this.keyEventTarget.onkeydown=null,this.keyEventTarget.onkeyup=
null,this.keyEventTarget.onkeypress=null)}registerKeyboardEvents(){this.keyEventTarget&&(this.keyEventTarget.onkeydown=a=>{112<=a.keyCode&&123>=a.keyCode||a.ctrlKey||this.sendKeydown(a);if(a.keyCode===ca.BackSpace)this.keyEventTarget.onkeypress({charCode:ca.BackSpace});this.callActionEventHander(5,a)},this.keyEventTarget.onkeyup=a=>{112<=a.keyCode&&123>=a.keyCode||a.ctrlKey||this.sendKeyup(a);this.callActionEventHander(6,a)},this.keyEventTarget.onkeypress=a=>{112<=a.keyCode&&123>=a.keyCode||this.sendKeypress(a);
this.callActionEventHander(7,a)})}setCursor(){if(this.video)if(this.useBuiltinCursors)switch(this.mouseDownButton){case 0:this.video.setAttribute("class","streamingVideoCursorPan");break;case 1:this.video.setAttribute("class","streamingVideoCursorMove");break;case 2:this.video.setAttribute("class","streamingVideoCursorRotate");break;default:this.video.setAttribute("class","streamingVideoCursorPointer")}else this.video.setAttribute("class","streamingVideoNoCursor")}callActionEventHander(a,b){if(this.mouseKeyListener&&
this.onActionEnable)switch(a){case 0:if(Q.isFunction(this.mouseKeyListener.onMouseEnter))this.mouseKeyListener.onMouseEnter(b);break;case 1:if(Q.isFunction(this.mouseKeyListener.onMouseLeave))this.mouseKeyListener.onMouseLeave(b);break;case 2:if(Q.isFunction(this.mouseKeyListener.onMouseMove))this.mouseKeyListener.onMouseMove(b);break;case 3:if(Q.isFunction(this.mouseKeyListener.onMouseDown))this.mouseKeyListener.onMouseDown(b);break;case 4:if(Q.isFunction(this.mouseKeyListener.onMouseUp))this.mouseKeyListener.onMouseUp(b);
break;case 5:if(Q.isFunction(this.mouseKeyListener.onKeyDown))this.mouseKeyListener.onKeyDown(b);break;case 6:if(Q.isFunction(this.mouseKeyListener.onKeyUp))this.mouseKeyListener.onKeyUp(b);break;case 7:if(Q.isFunction(this.mouseKeyListener.onKeyPress))this.mouseKeyListener.onKeyPress(b)}}registerMouseEvents(){this.video.onmouseenter=a=>{this.sendMouseEnter();a.buttons&1&&this.sendMouseDown(0,a.offsetX,a.offsetY);a.buttons&2&&this.sendMouseDown(2,a.offsetX,a.offsetY);a.buttons&4&&this.sendMouseDown(1,
a.offsetX,a.offsetY);a.buttons&8&&this.sendMouseDown(3,a.offsetX,a.offsetY);a.buttons&16&&this.sendMouseDown(4,a.offsetX,a.offsetY);this.callActionEventHander(0,a)};this.video.onmouseleave=a=>{this.sendMouseLeave();a.buttons&1&&this.sendMouseUp(0,a.offsetX,a.offsetY);a.buttons&2&&this.sendMouseUp(2,a.offsetX,a.offsetY);a.buttons&4&&this.sendMouseUp(1,a.offsetX,a.offsetY);a.buttons&8&&this.sendMouseUp(3,a.offsetX,a.offsetYy);a.buttons&16&&this.sendMouseUp(4,a.offsetX,a.offsetY);this.callActionEventHander(1,
a)};this.video.onmousemove=a=>{this.sendMouseMove(a.offsetX,a.offsetY,a.movementX,a.movementY);a.preventDefault();if(0==this.mouseDownButton||2==this.mouseDownButton)this.setCursor(),this.mouseDownButton=void 0;this.callActionEventHander(2,a)};this.video.onmousedown=a=>{this.keyEventTarget==this.video&&this.video.focus();this.mouseDownButton=a.button;this.sendMouseDown(a.button,a.offsetX,a.offsetY);a.preventDefault();0!=a.button&&2!=a.button&&this.setCursor();this.callActionEventHander(3,a)};this.video.onmouseup=
a=>{this.mouseDownButton=void 0;this.sendMouseUp(a.button,a.offsetX,a.offsetY);a.preventDefault();this.setCursor();this.callActionEventHander(4,a)};this.video.oncontextmenu=a=>{a.preventDefault()};"onmousewheel"in this.video?this.video.addEventListener("mousewheel",a=>{this.sendMouseWheel(a.wheelDelta,a.offsetX,a.offsetY);a.preventDefault()},{passive:!1}):this.video.addEventListener("DOMMouseScroll",a=>{this.sendMouseWheel(-120*a.detail,a.offsetX,a.offsetY);a.preventDefault()},!1)}registerTouchEvents(){this.ongoingTouches=
[];this.copyTouch=({identifier:b,clientX:c,clientY:e,force:d})=>({identifier:b,clientX:c,clientY:e,force:d});this.ongoingTouchIndexById=b=>{for(let c=0;c<this.ongoingTouches.length;c++)if(this.ongoingTouches[c].identifier==b)return c;return-1};if(this.fakeMouseWithTouches){var a=void 0;this.video.addEventListener("touchstart",b=>{let c=this.container.getBoundingClientRect();if(void 0===a){let e=b.changedTouches[0];a={id:e.identifier,x:e.clientX-c.left,y:e.clientY-c.top};this.video.onmouseenter(b);
this.sendMouseDown(0,a.x,a.y)}b.preventDefault()},{passive:!1});this.video.addEventListener("touchend",b=>{let c=this.container.getBoundingClientRect();for(let e=0;e<b.changedTouches.length;e++){let d=b.changedTouches[e];if(d.identifier===a.id){this.sendMouseUp(0,d.clientX-c.left,d.clientY-c.top);this.video.onmouseleave(b);a=void 0;break}}b.preventDefault()},{passive:!1});this.video.addEventListener("touchmove",b=>{var c=this.container.getBoundingClientRect();for(var e=0;e<b.touches.length;e++){let d=
b.touches[e];if(d.identifier===a.id){e=d.clientX-c.left;c=d.clientY-c.top;this.sendMouseMove(e,c,e-a.x,c-a.y);a.x=e;a.y=c;break}}b.preventDefault()},{passive:!1})}else this.video.addEventListener("touchstart",b=>{b.preventDefault();if(this.onTouch)this.onTouch(`ongoingTouches: ${this.ongoingTouches.length}, touches: ${b.touches.length}, changedTouches: ${b.changedTouches.length}`);this.ongoingTouches.length>b.touches.length-b.changedTouches.length&&(this.onTouch&&this.onTouch("\u89e6\u53d1\u4e86\u7cfb\u7edf\u89e6\u6478\u64cd\u4f5c\uff0c\u5c06\u624b\u52a8\u53d1\u9001TouchEnd\u4e8b\u4ef6"),
this.sendTouch(81,this.ongoingTouches),this.ongoingTouches=[]);b=b.changedTouches;for(let c=0;c<b.length;c++)this.ongoingTouches.push(this.copyTouch(b[c]));this.sendTouch(80,b)},{passive:!1}),this.video.addEventListener("touchend",b=>{b.preventDefault();b=b.changedTouches;this.sendTouch(81,b);for(let c=0;c<b.length;c++){let e=this.ongoingTouchIndexById(b[c].identifier);0<=e&&this.ongoingTouches.splice(e,1)}},{passive:!1}),this.video.addEventListener("touchmove",b=>{b.preventDefault();this.sendTouch(82,
b.touches)},{passive:!1})}resize(a){this.playerAspectRatio=this.container.clientHeight/this.container.clientWidth;this.videoAspectRatio=a?this.playerAspectRatio:this.videoHeight()/this.videoWidth()}normalizeAndQuantizeUnsigned(a,b){if(this.playerAspectRatio>this.videoAspectRatio){let c=this.playerAspectRatio/this.videoAspectRatio;a/=this.container.clientWidth;b=c*(b/this.container.clientHeight-.5)+.5}else a=this.videoAspectRatio/this.playerAspectRatio*(a/this.container.clientWidth-.5)+.5,b/=this.container.clientHeight;
return 0>a||1<a||0>b||1<b?{inRange:!1,x:65535,y:65535}:{inRange:!0,x:65536*a,y:65536*b}}normalizeAndQuantizeSigned(a,b){if(this.playerAspectRatio>this.videoAspectRatio){let c=this.playerAspectRatio/this.videoAspectRatio;a/=.5*this.container.clientWidth;b=c*b/(.5*this.container.clientHeight);return{x:32767*a,y:32767*b}}return{x:this.videoAspectRatio/this.playerAspectRatio*a/(.5*this.container.clientWidth)*32767,y:b/(.5*this.container.clientHeight)*32767}}sendTouch(a,b){this.callOnUserInteraction();
var c=new DataView(new ArrayBuffer(2+10*b.length));c.setUint8(0,a);c.setUint8(1,b.length);let e=2,d=[];for(let h=0;h<b.length;h++){let g=b[h],r=g.clientX-this.video.offsetLeft,k=g.clientY-this.video.offsetTop,f=this.normalizeAndQuantizeUnsigned(r,k),l=this.ongoingTouchIndexById(g.identifier);if(0>l){if(this.onTouch)this.onTouch("can't figure out which touch to continue")}else c.setUint16(e,f.x,!0),e+=2,c.setUint16(e,f.y,!0),e+=2,c.setInt32(e,l,!0),e+=4,c.setUint8(e,255*g.force,!0),e+=1,c.setUint8(e,
f.inRange?1:0,!0),e+=1,this.onTouch&&d.push(`{${l} (${parseInt(r)},${parseInt(k)})->(${parseInt(f.x)},${parseInt(f.y)}) ${255*g.force} ${f.inRange?1:0}}`)}this.rtc.send(c.buffer);this.onTouch&&(c="",80==a?c="start":82==a?c="move":81==a&&(c="end"),a=`[${c}] N${b.length} ${d.join(",")}}`,this.onTouch(a))}sendKeydown(a){this.callOnUserInteraction();this.rtc.send((new Uint8Array([60,va(a),a.repeat])).buffer)}sendKeyup(a){this.callOnUserInteraction();this.rtc.send((new Uint8Array([61,va(a)])).buffer)}sendKeypress(a){this.callOnUserInteraction();
let b=new DataView(new ArrayBuffer(3));b.setUint8(0,62);b.setUint16(1,a.charCode,!0);this.rtc.send(b.buffer)}sendMouseEnter(){this.callOnUserInteraction();var a=new DataView(new ArrayBuffer(1));a.setUint8(0,70);this.rtc.send(a.buffer)}sendMouseLeave(){this.callOnUserInteraction();var a=new DataView(new ArrayBuffer(1));a.setUint8(0,71);this.rtc.send(a.buffer)}sendMouseMove(a,b,c,e){this.callOnUserInteraction();this.normalizeAndQuantizeUnsigned&&(a=this.normalizeAndQuantizeUnsigned(a,b),c=this.normalizeAndQuantizeSigned(c,
e),e=new DataView(new ArrayBuffer(9)),e.setUint8(0,74),e.setUint16(1,a.x,!0),e.setUint16(3,a.y,!0),e.setInt16(5,c.x,!0),e.setInt16(7,c.y,!0),this.rtc.send(e.buffer))}sendMouseDown(a,b,c){this.callOnUserInteraction();this.normalizeAndQuantizeUnsigned&&(b=this.normalizeAndQuantizeUnsigned(b,c),c=new DataView(new ArrayBuffer(6)),c.setUint8(0,72),c.setUint8(1,a),c.setUint16(2,b.x,!0),c.setUint16(4,b.y,!0),this.rtc.send(c.buffer))}sendMouseUp(a,b,c){this.normalizeAndQuantizeUnsigned&&(b=this.normalizeAndQuantizeUnsigned(b,
c),c=new DataView(new ArrayBuffer(6)),c.setUint8(0,73),c.setUint8(1,a),c.setUint16(2,b.x,!0),c.setUint16(4,b.y,!0),this.rtc.send(c.buffer))}sendMouseWheel(a,b,c){this.callOnUserInteraction();this.normalizeAndQuantizeUnsigned&&(b=this.normalizeAndQuantizeUnsigned(b,c),c=new DataView(new ArrayBuffer(7)),c.setUint8(0,75),c.setInt16(1,a,!0),c.setUint16(3,b.x,!0),c.setUint16(5,b.y,!0),this.rtc.send(c.buffer))}}class Vb extends fa{constructor(a){super(a);this.create()}create(){this.el||(this.el=document.createElement("i"),
this.el.id=`statusIndicator_${this.uid}`,this.el.className="__statusIndicator",this.appendElement(this.el))}destroy(){this.el&&(this.removeElement(this.el),this.el=null)}setStatus(a){let b="Red",c=this.get("statusIndicator");switch(a){case S.WS_Disconnected:b="Red";c&&(c.style.display="inline-block");break;case S.WS_Connecting:b="RGB(200,200,200)";break;case S.WS_Connected:b="Yellow";break;case S.RTC_Opened:b="RGB(0,128,255)";break;case S.OnReady:b="RGB(0,255,0)",this.hide()}this.lastStatus=a;c&&
(c.style.backgroundColor=b)}hide(){let a=this.get("statusIndicator");a&&(a.style.display="none")}}class Wb extends fa{constructor(a){super(a);this.bDelayClear=!1;this.create()}create(){this.el=document.createElement("pre");this.el.id=`debugInfoPanel_${this.uid}`;this.el.className="__startupInfoPanel";this.el.oncontextmenu=new Function("return false");this.el.onselectstart=new Function("return false");this.appendElement(this.el);this._visible=!0}destroy(){this.el&&(this.removeElement(this.el),this.el=
null)}setVisible(a){!this._visible&&a&&this.el&&(this.el.innerText="");this._visible!=a&&this.el&&((this._visible=a)?(this.el.className="__startupInfoPanel",this.el.style.display="block"):this.el.style.display="none",this.setNeedReposUI())}hide(){this.el.className="__startupInfoPanel __fadeoutComp";setTimeout(()=>this.setVisible(!1),500)}setDelayClear(a){this.bDelayClear=a}log(a){if(this.el){if(this.bDelayClear)this.bDelayClear=!1,this.el.innerText=a+"\n";else{let b=this.el.innerText;b+=a+"\n";this.el.innerText=
b}this.el.scrollTop=this.el.scrollHeight+100}}setPosition(a){a||(a=this.container.getBoundingClientRect());this.el&&(this.el.style.height=`${a.height-20}px`)}}class aa{}aa.Information='<svg width="22" height="22" viewBox="0 0 32 32"><g transform="translate(1878 2755)"><rect width="32" height="32" transform="translate(-1878 -2755)" fill="none"/><path d="M11,22A11,11,0,0,1,3.222,3.222,11,11,0,1,1,18.779,18.778,10.929,10.929,0,0,1,11,22ZM8.5,10a.5.5,0,0,0-.5.5v2a.5.5,0,0,0,.5.5H10v5.5a.5.5,0,0,0,.5.5h2a.5.5,0,0,0,.5-.5v-8a.5.5,0,0,0-.5-.5ZM11,4a2,2,0,1,0,2,2A2,2,0,0,0,11,4Z" transform="translate(-1873 -2750)" fill="#3c3b3c"/></g></svg>';
aa.FullScreenEnter='<svg width="22" height="22" viewBox="0 0 32 32"><g id="cloud_icon_fullscreen_def" transform="translate(1787 2755)"><rect width="32" height="32" transform="translate(-1787 -2755)" fill="none"/><g transform="translate(0 -0.5)"><g transform="translate(-1780 -2747.5)"><rect width="10" height="10" transform="translate(-2 -2)" fill="none"/><path d="M12,0H7A1,1,0,0,0,6,1V6" transform="translate(-6)" fill="none" stroke="#3c3b3c" stroke-width="2"/><path d="M6,6.5,0,1" transform="translate(0.5 -0.5)" fill="none" stroke="#3c3b3c" stroke-width="2"/></g><g transform="translate(-1782 -2737.5)"><rect width="10" height="10" fill="none"/><path d="M12,6H7A1,1,0,0,1,6,5V0" transform="translate(-4 2)" fill="none" stroke="#3c3b3c" stroke-width="2"/><path d="M6,1,0,6.5" transform="translate(2.5 1)" fill="none" stroke="#3c3b3c" stroke-width="2"/></g><g transform="translate(-1770 -2749.5)"><rect width="10" height="10" fill="none"/><path d="M6,0h5a1,1,0,0,1,1,1V6" transform="translate(-4 2)" fill="none" stroke="#3c3b3c" stroke-width="2"/><path d="M0,6.5,6,1" transform="translate(1.5 1.5)" fill="none" stroke="#3c3b3c" stroke-width="2"/></g><g transform="translate(-1770 -2737.5)"><rect width="10" height="10" fill="none"/><path d="M6,6h5a1,1,0,0,0,1-1V0" transform="translate(-4 2)" fill="none" stroke="#3c3b3c" stroke-width="2"/><path d="M0,1,6,6.5" transform="translate(1.5 1)" fill="none" stroke="#3c3b3c" stroke-width="2"/></g></g></g></svg>';
aa.FullScreenExit='<svg width="22" height="22" viewBox="0 0 32 32"><g id="cloud_icon_exotfullsc_def" transform="translate(1744 2755)"><rect width="32" height="32" transform="translate(-1744 -2755)" fill="none"/><g transform="translate(0 -1)"><g transform="translate(-1739 -2749)"><rect width="10" height="10" fill="none"/><path d="M6,6h5a1,1,0,0,0,1-1V0" transform="translate(-4 2)" fill="none" stroke="#3c3b3c" stroke-width="2"/><path d="M0,1,6,6.5" transform="translate(1.5 1)" fill="none" stroke="#3c3b3c" stroke-width="2"/></g><g transform="translate(-1739 -2737)"><rect width="10" height="10" fill="none"/><path d="M6,0h5a1,1,0,0,1,1,1V6" transform="translate(-4 2)" fill="none" stroke="#3c3b3c" stroke-width="2"/><path d="M0,6.5,6,1" transform="translate(1.5 1.5)" fill="none" stroke="#3c3b3c" stroke-width="2"/></g><g transform="translate(-1727 -2749)"><rect width="10" height="10" fill="none"/><path d="M12,6H7A1,1,0,0,1,6,5V0" transform="translate(-4 2)" fill="none" stroke="#3c3b3c" stroke-width="2"/><path d="M6,1,0,6.5" transform="translate(2.5 1)" fill="none" stroke="#3c3b3c" stroke-width="2"/></g><g transform="translate(-1727 -2737)"><rect width="10" height="10" fill="none"/><path d="M12,0H7A1,1,0,0,0,6,1V6" transform="translate(-4 2)" fill="none" stroke="#3c3b3c" stroke-width="2"/><path d="M6,6.5,0,1" transform="translate(2.5 1.5)" fill="none" stroke="#3c3b3c" stroke-width="2"/></g></g></g></svg>';
aa.InitialCamera='<svg width="22" height="22" viewBox="0 0 32 32"><g id="cloud_icon_initialpos_def" transform="translate(1831 2755)"><rect width="32" height="32" transform="translate(-1831 -2755)" fill="none"/><path d="M18.667,22.222H1.333A1.333,1.333,0,0,1,0,20.893V8.24A1.319,1.319,0,0,1,.5,7.2L9.167.292a1.335,1.335,0,0,1,1.666,0L19.5,7.2A1.319,1.319,0,0,1,20,8.24V20.893A1.333,1.333,0,0,1,18.667,22.222ZM9,12.11a1,1,0,0,0-1,1v6a1,1,0,0,0,1,1h2a1,1,0,0,0,1-1v-6a1,1,0,0,0-1-1Z" transform="translate(-1825 -2751.11)" fill="#3c3b3c" stroke="rgba(0,0,0,0)" stroke-width="1"/></g></svg>';
class Xb extends fa{constructor(a,b,c){super(a);this.updateConnectionCount(b);this.createButton(c)}createButton(a){this.elButton||(this.elButton=document.createElement("button"),this.elButton.id=`liveStatusSwitchButton_${this.uid}`,this.elButton.innerHTML=aa.Information,this.elButton.title=a,this.elButton.className="__liveStatusSwitchButton",this.elButton.oncontextmenu=new Function("return false"),this.elButton.onselectstart=new Function("return false"),this.elButton.onclick=()=>this.setPanelVisible(),
this.elButton.onmousedown=b=>{1==b.button&&b.preventDefault()},this.appendElement(this.elButton))}createPanel(){if(!this.elPanel){var a='<table border="0" cellspacing="0" cellpadding="0" style="position:absolute !important;padding:4px;left:0px;top:0px;width:100%;height:100%;">'+`<tr><td height="22" align="right" width="66" title="\u8fde\u63a5\u4e2a\u6570-PlayerId-QualityControl">\u8fde\u63a5\u4fe1\u606f\uff1a</td><td><span id="i_connections_${this.uid}">1</span>-<span id="i_playerId_${this.uid}">1</span></td><td align="right"><a id="i_hide_panel_${this.uid}" href="javascript:">\u5173\u95ed</a></td></tr>`+
`<tr><td height="22" align="right">\u8fd0\u884c\u65f6\u957f\uff1a</td><td colspan="2" id="i_duration_${this.uid}">00:00:00</td></tr>`+`<tr><td height="22" align="right">\u5206\u8fa8\u7387\uff1a</td><td colspan="2" id="i_resolution_${this.uid}">1920 x 1080</td></tr>`+`<tr><td height="22" align="right">\u63a5\u6536\u6570\u636e\uff1a</td><td colspan="2" id="i_bytesReceived_${this.uid}">0 kB</td></tr>`+`<tr><td height="22" align="right">\u63a5\u6536\u5e27\u6570\uff1a</td><td colspan="2" id="i_framesReceived_${this.uid}">0</td></tr>`+
`<tr><td height="22" align="right" title="\u4e22\u5305\u6570\u91cf / \u4e22\u5e27\u6570\u91cf">\u4e22\u5305\u4e22\u5e27\uff1a</td><td colspan="2"><span id="i_packetsLost_${this.uid}">0</span> / <span id="i_frameDropped_${this.uid}">0</span></td></tr>`+`<tr><td height="22" align="right" title="\u6d4f\u89c8\u5668\u89e3\u7801\u65f6\u95f4">\u89e3\u7801\u65f6\u95f4\uff1a</td><td colspan="2"><span id="i_compositeTime_${this.uid}"></span></td></tr>`+`<tr><td height="22" align="right" title="\u5df2\u89e3\u7801\u7684\u5e27\u6570 / \u5df2\u89e3\u7801\u7684\u5173\u952e\u5e27\u6570\u91cf">\u89e3\u7801\u5e27\u6570\uff1a</td><td colspan="2"><span id="i_framesDecoded_${this.uid}" title="\u89e3\u7801\u7684\u5e27\u6570">0</span> / <span id="i_keyframesDecoded_${this.uid}" title="\u5df2\u89e3\u7801\u7684\u5173\u952e\u5e27\u6570">0</span></td></tr>`+
`<tr><td height="22" align="right">\u7801\u7387\uff1a</td><td colspan="2" id="i_bitrate_${this.uid}">-</td></tr>`+`<tr><td height="22" align="right" title="\u6e32\u67d3\u5e27\u7387/\u89c6\u9891\u5e27\u7387">\u5e27\u7387\uff1a</td><td colspan="2" title="\u6e32\u67d3\u5e27\u7387/\u89c6\u9891\u5e27\u7387"><span id="i_framerateRender_${this.uid}">-</span> / <span id="i_framerateVideo_${this.uid}">-</span></td></tr>`+`<tr><td height="22" align="right">QP\uff1a</td><td colspan="2" id="i_qp_${this.uid}">0</td></tr>`+
`<tr><td height="22" align="right" title="\u503c\u8d8a\u5927\uff0c\u753b\u8d28\u8d8a\u7c97\u7cd9\uff0c\u9700\u8981\u7684\u5e26\u5bbd\u8d8a\u5c0f">QP\u4e0a\u9650\uff1a</td><td colspan="2"><select id="i_settings_maxQP_${this.uid}" style="width:84px;"></select></td></tr>`+`<tr><td height="22" align="right" title="\u5355\u4f4d\uff1aMbps">\u7801\u7387\u4e0a\u9650\uff1a</td><td colspan="2"><select id="i_settings_maxBitrate_${this.uid}" style="width:84px;"></select></td></tr>`+"</table>";this.elPanel=document.createElement("div");
this.elPanel.innerHTML=a;this.elPanel.id=`liveStatusPanel_${this.uid}`;this.elPanel.className="__liveStatusPanel __fadeinComp";this.elPanel.oncontextmenu=new Function("return false");this.elPanel.onselectstart=new Function("return false");this.appendElement(this.elPanel);this.get("i_hide_panel").onclick=()=>this.setPanelVisible();for(a=29;40>=a;a++)this.get("i_settings_maxQP").add(new Option(a,a));this.get("i_settings_maxQP").onchange=()=>{let b={encodeMaxQP:this.getValue("i_settings_maxQP")};this.player.rtc.updateParams(b);
this.player.signallingConnection.updateParams(b);this.get("i_settings_maxQP").blur()};for(a=10;100>=a;a+=5)this.get("i_settings_maxBitrate").add(new Option(a,a));this.get("i_settings_maxBitrate").onchange=()=>{let b={maxBitrate:this.getValue("i_settings_maxBitrate")};this.player.rtc.updateParams(b);this.player.signallingConnection.updateParams(b);this.get("i_settings_maxBitrate").blur()}}}setPosition(a){a||(a=this.container.getBoundingClientRect());this.elButton&&(this.elButton.style.top=`${a.height-
32}px`);if(this.elPanel){let b=this.elPanel.getBoundingClientRect();this.elPanel.style.top=`${a.height-b.height-42}px`}}destroy(){this.updateLatencyTestUI=!1;this.visible&&this.setPanelVisible();this.elPanel&&(this.removeElement(this.elPanel),this.elPanel=null);this.elButton&&(this.removeElement(this.elButton),this.elButton=null)}setPanelVisible(){this.elPanel?"none"==this.elPanel.style.display?(this.updateConnectionCount(),this.elPanel.style.display="block",this.elPanel.className="__liveStatusPanel __fadeinComp",
this.visible=!0,this.resize(),this.player.rtc.sendEnableIntervalSendQP(!0)):(this.elPanel.className="__liveStatusPanel __fadeoutComp",setTimeout(()=>{this.visible=!1;this.elPanel.style.display="none";this.player.rtc.sendEnableIntervalSendQP(!1)},500)):(this.createPanel(),this.visible=!0,this.resize(),this.updateConnectionCount(),this.player.rtc.requestInitialSettings(),this.player.rtc.sendEnableIntervalSendQP(!0));this.setNeedReposUI();this.resize()}adjustMaxQP(a){return 18==a?(this.get("i_settings_maxQP")&&
this.get("i_settings_maxQP").add(new Option(18,18)),18):0>a?40:0<=a&&29>a?29:40<a?40:a}adjustMaxBitrate(a){return 300==a?(this.get("i_settings_maxBitrate")&&this.get("i_settings_maxBitrate").add(new Option(300,300)),300):10>a?10:100<a?100:a}formatNumber(a,b){return"undefined"==typeof a?"-":(new Intl.NumberFormat(window.navigator.language,{maximumFractionDigits:b||0})).format(a)}processValue(a){return a}updateButtonTip(a){this.elButton&&(this.elButton.title=a)}updateConnectionCount(a){void 0!=a&&(this.playersCount=
a);this.setText("i_connections",this.playersCount);this.updatePlayerId()}updatePlayerId(){this.setText("i_playerId",this.player.playerId+(this.player.isQualityController()?"-QC":""))}updateWebRtcStats(a){if(this.visible){var b=(a.timestamp-a.timestampStart)/1E3,c=new Intl.NumberFormat(window.navigator.language,{maximumFractionDigits:0,minimumIntegerDigits:2}),e=[],d=[60,60];for(let h=0;h<d.length;h++)e.push(b%d[h]),b/=d[h];e.push(b);b=c.format(e[0]);d=c.format(Math.floor(e[1]));c=c.format(Math.floor([e[2]]));
this.setText("i_duration",c+":"+d+":"+b);this.setText("i_resolution",a.frameWidth&&a.frameHeight?a.frameWidth+" x "+a.frameHeight:"-");c="B";e=a.bytesReceived||0;b=["kB","MB","GB"];for(d=0;d<b.length&&!(1E5>e);d++)e/=1E3,c=b[d];this.setText("i_bytesReceived",this.formatNumber(e)+" "+c);this.setText("i_framesReceived",this.processValue(a.framesReceived));this.setText("i_framesDecoded",a.framesDecoded);this.setText("i_keyframesDecoded",this.processValue(a.keyFramesDecoded));this.updateVideoFramerate(this.formatNumber(a.framesPerSecond));
this.updateBitrate(a.bitrate);this.setText("i_packetsLost",this.processValue(a.packetsLost));this.setText("i_frameDropped",this.processValue(a.framesDropped));this.setText("i_compositeTime",this.formatNumber(a.receiveToCompositeMs,1))}}updateVideoFramerate(a){let b=this.get("i_framerateVideo");b.style.color=10>a?"red":20>a?"orange":"rgb(128,255,0)";b.innerText=a}updateBitrate(a){let b=this.get("i_bitrate");a?1E3<a?(b.style.color="rgb(128,255,0)",b.innerText=this.formatNumber(a/1E3,1)+" Mbps"):(b.style.color=
100>a?"red":1E3>a?"orange":"rgb(128,255,0)",b.innerText=this.formatNumber(a)+" kbps"):b.innerText="-"}updateInitialSettings(a){let b=this.adjustMaxQP(a.Encoder.MaxQP);this.setValue("i_settings_maxQP",b);a=this.adjustMaxBitrate(a.WebRTC.MaxBitrate/1E3/1E3);this.setValue("i_settings_maxBitrate",a)}updateQPAndRenderFPS(a,b){let c=this.get("i_qp");c.style.color=35<a?"red":26<a?"orange":"rgb(128,255,0)";c.innerText=a;this.get("i_framerateRender").innerText=this.processValue(b)}}class Yb extends fa{constructor(a){super(a);
this.create()}create(){this.el||(this.el=document.createElement("button"),this.el.id=`fullscreeButton_${this.uid}`,this.el.className="__fullscreeButton",this.el.innerHTML=aa.FullScreenEnter,this.el.title="\u8fdb\u5165\u5168\u5c4f",this.el.oncontextmenu=new Function("return false"),this.el.onselectstart=new Function("return false"),this.el.onclick=()=>this.player.fullscreen=!this.player.fullscreen,this.el.onmousedown=a=>{1==a.button&&a.preventDefault()},this.appendElement(this.el),document.addEventListener("fullscreenchange",
()=>{this.el.title="\u9000\u51fa\u5168\u5c4f";this.el.innerHTML=Q.isFullscreen()?aa.FullScreenExit:aa.FullScreenEnter;this.player.resize()}))}destroy(){this.el&&(this.removeElement(this.el),this.el=null)}setPosition(a,b){a||(a=this.container.getBoundingClientRect());this.el&&(this.el.style.left=`${b?38:5}px`,this.el.style.top=`${a.height-32}px`)}}class Zb extends fa{constructor(a){super(a);this.create()}create(){if(!this.el){var a=[];a.push("\u9f20\u6807\u5de6\u952e\u70b9\u51fb\uff1a\u56de\u5230\u4fdd\u5b58\u7684\u4f4d\u7f6e\u6216\u8005\u5de5\u7a0b\u521d\u59cb\u4f4d\u7f6e");
a.push("\u9f20\u6807\u53f3\u952e\u70b9\u51fb\uff1a\u4fdd\u5b58\u5f53\u524d\u7684\u76f8\u673a\u4f4d\u7f6e");a.push("\u9f20\u6807\u4e2d\u95f4\u70b9\u51fb\uff1a\u5c06\u5f53\u524d\u4f4d\u7f6e\u8bbe\u7f6e\u4e3a\u5de5\u7a0b\u521d\u59cb\u4f4d\u7f6e\u5e76\u8df3\u8f6c");a=a.join("\n");this.el=document.createElement("button");this.el.id=`viewHomeButton_${this.uid}`;this.el.className="__viewHomeButton";this.el.innerHTML=aa.InitialCamera;this.el.title=a;this.el.oncontextmenu=new Function("return false");this.el.onselectstart=
new Function("return false");this.el.onclick=b=>this.player.viewHome(0);this.el.onmousedown=b=>{0!=b.button&&this.player.viewHome(b.button);b.preventDefault()};this.appendElement(this.el)}}destroy(){this.el&&(this.removeElement(this.el),this.el=null)}setPosition(a,b,c){a||(a=this.container.getBoundingClientRect());if(this.el){let e=5;if(b&&c)e=70;else if(b||c)e=38;this.el.style.left=e+"px";this.el.style.top=`${a.height-32}px`}}}class $b extends fa{constructor(a){super(a);this.elContainer=document.createElement("div");
this.elContainer.id=`taskWaiting_${this.uid}`;this.elContainer.className="__taskWaiting";this.elContainer.oncontextmenu=new Function("return false");this.elContainer.onselectstart=new Function("return false");this.appendElement(this.elContainer);this.elText=document.createElement("div");this.elText.style.marginBottom="15px";this.elText.innerText="dddd";this.elContainer.appendChild(this.elText);this.elButton=document.createElement("input");this.elButton.type="button";this.elButton.value="\u7acb\u5373\u91cd\u542f\u5b9e\u4f8b";
this.elButton.onclick=()=>{this.player.setInstanceOptions({iid:this.player.options.iid,reset:!0})};this.elContainer.appendChild(this.elButton);this.setMode(0)}setMode(a){this._mode=a;0===a?this.elContainer.style.background="transparent":(this.elContainer.style.background="rgba(64,64,64,0.5)",this.elContainer.style.height="26px",this.elContainer.style.lineHeight="26px")}destroy(){this.elContainer&&(this.removeElement(this.elContainer),this.elContainer=null)}updateText(a){this.elText&&(this.elText.innerText=
a,this.show())}show(){this.elContainer.className="__taskWaiting";this.elContainer.style.display="block"}hide(){this.elContainer.className="__taskWaiting __fadeoutComp";setTimeout(()=>this.elContainer.style.display="none",500)}setPosition(a,b,c,e){if(this.elContainer)if(a||(a=this.container.getBoundingClientRect()),0==this._mode){var d=a.width/2-150;0>d&&(d=10);this.elContainer.style.left=d+"px";this.elContainer.style.top=a.height/2+"px"}else d=0,b&&d++,c&&d++,e&&d++,a=a.height-32,this.elContainer.style.left=
(0==d?5:1==d?38:2==d?70:102)+"px",this.elContainer.style.top=a+"px"}}class ac extends fa{constructor(a){super(a);this.el=document.createElement("pre");this.el.id=`touchEventsPanel_${this.uid}`;this.el.className="__touchEventsPanel";this.el.oncontextmenu=new Function("return false");this.el.onselectstart=new Function("return false");this.appendElement(this.el)}destroy(){this.el&&(this.removeElement(this.el),this.el=null)}appendText(a){if(this.el){let b=this.el.innerText;b+=a+"\n";this.el.innerText=
b;this.el.scrollTop=this.el.scrollHeight+100}}setPosition(a){a||(a=this.container.getBoundingClientRect());this.el&&(this.el.style.width=`${a.width}px`)}}var ta=0;class bc{constructor(a,b){if(a){this.host=a;this.options=b;la.processParams(this.options);this.uid=++ta;this.options.apiOptions.player=this;this.api=new qa(null,this.options.apiOptions);if(this.options.domId)if(a=ua(this.options.domId))this.container=document.createElement("div"),this.container.style="position:relative;width:100%;height:100%;",
a.innerHTML="",a.appendChild(this.container);else if("loading"==document.readyState){console.error("DOM\u5c1a\u5728\u52a0\u8f7d\u4e2d\uff0c\u6b64\u65f6\u4e0d\u80fd\u521d\u59cb\u5316AirCityPlayer!");return}if(this.hasVideo=!!this.container)this.styleManager=new Tb,this.createWidgetsInConstructor(),this.canAdaptiveResolution=!1,this.lastResizeTime=(new Date).getTime(),this.orientationChangeTimeout=void 0;this.constructUrlAndConnect();this.resetInteractTimestamp()}else console.error("[AirCityPlayer] The parameter `host` cannot be empty!")}constructUrlAndConnect(){this.logStartupInfo(`host: ${this.host}`);
this.useHttps="https:"==location.protocol||this.options.useHttps;this.url=`${this.useHttps?"wss":"ws"}://${this.host}/player?hasVideo=${this.hasVideo}`;this.options.offer&&(this.url+="&offer=1");this.options.iid&&(this.url+="&iid="+this.options.iid);this.options.pid&&(this.url+="&pid="+this.options.pid);this.options.password&&(this.url+="&password="+this.options.password);if("object"==typeof this.options.urlExtraInfo)for(let a in this.options.urlExtraInfo)this.url+="&"+a+"="+this.options.urlExtraInfo[a];
this.options.reset&&(this.url+="&reset=1",this.options.reset=!1);setTimeout(()=>this.connectSignallingServer(),200)}callEvent(a,b,c){a=this.options.events[a];"function"==typeof a&&a(b,c)}getHost(){return this.host}getAPI(){return this.api}getInstanceInfo(){return this.paramInfo}getVideoSize(){if(this.htmlVideo.valid())return{width:this.htmlVideo.videoWidth(),height:this.htmlVideo.videoHeight()}}setResolution(a,b){window.devicePixelRatio&&(a*=window.devicePixelRatio,b*=window.devicePixelRatio);if(3840<
a||2160<b)b=a/b,b>=3840/2160?(a=3840,b=3840/b):(a=2160*b,b=2160);this.streamerAdaptive&&this.streamerLimitMaxResolution&&(a>this.streamerResX||b>this.streamerResY)&&(b=a/b,b>=this.streamerResX/this.streamerResY?(a=this.streamerResX,b=this.streamerResX/b):(a=this.streamerResY*b,b=this.streamerResY));a=Math.floor(a);b=Math.floor(b);let c=this.htmlVideo.videoWidth(),e=this.htmlVideo.videoHeight();(a!=c&&a+1!=c&&a-1!=c||b!=e&&b+1!=e&&b-1!=e)&&this.rtc&&this.rtc.updateRenderResolution(a,b)}destroy(a){console.log(`call AirCityPlayer.destroy: ${a||
" "}`);this.isDestroyed||(ta--,this.isDestroyed=!0,this.destroyReason=a,this.rtc&&this.rtc.close(),this.signallingConnection&&this.signallingConnection.close())}setKeyEventTarget(a){this.htmlVideo&&this.htmlVideo.setKeyEventTarget(a)}setKeyEventReceiver(a){this.setKeyEventTarget(a)}resize(){if(this.container){this.rect=this.container.getBoundingClientRect();if(this.bNeedReposUI||!this.oldRect||this.oldRect.width!=this.rect.width||this.oldRect.height!=this.rect.height)this.bNeedReposUI=!1,this.oldRect=
this.rect,this.startupInfo&&this.startupInfo.setPosition(this.rect),this.liveStatus&&this.liveStatus.setPosition(this.rect),this.fullscreenButton&&this.fullscreenButton.setPosition(this.rect,this.options.ui.statusButton),this.homeButton&&this.homeButton.setPosition(this.rect,this.options.ui.statusButton,this.options.ui.fullscreenButton),this.taskListBar&&this.taskListBar.setPosition(this.rect,this.options.ui.statusButton,this.options.ui.fullscreenButton,this.options.ui.homeButton);this.htmlVideo.valid()&&
(this.canAdaptiveResolution&&(this._updateVideoStreamSize||(this._updateVideoStreamSize=()=>{1E3<(new Date).getTime()-this.lastResizeTime?(this.setResolution(this.htmlVideo.clientWidth(),this.htmlVideo.clientHeight()),this.lastResizeTime=(new Date).getTime()):(clearTimeout(this.resizeTimerId),this.resizeTimerId=setTimeout(a=>this._updateVideoStreamSize(),1E3))}),this._updateVideoStreamSize()),this.htmlVideo&&this.htmlVideo.resize(this.streamerAdaptive&&this.canAdaptiveResolution))}}setInstanceOptions(a){const b=
this;return $jscomp.asyncExecutePromiseGeneratorFunction(function*(){var c=a.pid==b.options.pid&&a.iid==b.options.iid||!a.pid&&a.iid==b.options.iid||!a.iid&&a.pid==b.options.pid;if(c&&!a.reset)b.api.log("setInstanceOptions: no change.");else{if(!c){c=(!a.iid||a.iid==b.options.iid)&&a.pid!=b.options.pid;if(b.streamerLocked&&c){b.api.log("\u5f53\u524d\u5b9e\u4f8b\u5df2\u8bbe\u7f6e\u9501\u5b9a\u5de5\u7a0b\uff0c\u65e0\u6cd5\u901a\u8fc7API\u63a5\u53e3\u5207\u6362\u5de5\u7a0b");return}c=yield b.signallingConnection.checkParams(a);
if(null!==c){if(!1===c.iid){b.api.log(`iid(${a.iid})\u5bf9\u5e94\u7684\u5b9e\u4f8b\u4e0d\u5b58\u5728\uff0c\u8bf7\u786e\u8ba4`);return}if(!1===c.pid){b.api.log(`pid(${a.pid})\u5bf9\u5e94\u7684\u5de5\u7a0b\u4e0d\u5b58\u5728\uff0c\u8bf7\u786e\u8ba4`);return}}}b.destroy();b.options.iid=a.iid;b.options.pid=a.pid;b.options.reset=a.reset;b.constructUrlAndConnect()}})}set fullscreen(a){a?Q.fullscreen(this.container):Q.exitFullscreen()}get fullscreen(){return!!document.fullscreenElement}setActionEventEnabled(a){this.htmlVideo&&
this.htmlVideo.setActionEventEnabled(a)}onApiReady(){this.setStatus(S.OnReady);this.signallingConnection&&this.signallingConnection.sendReady();1==this.options.ui.mainUI?this.api.settings.setMainUIVisibility(!0):0==this.options.ui.mainUI&&this.api.settings.setMainUIVisibility(!1);1==this.options.ui.campass?this.api.settings.setCampassVisible(!0):0==this.options.ui.campass&&this.api.settings.setCampassVisible(!1)}onMainThreadBusy(a){if(1===a.busy){let b="BUSY! ",c=this.api.apiQueue.queueSize(),e=this.api.apiQueue.dataSize();
0<c&&(b+=`JS\u961f\u5217\uff1a${c}/${e}\uff0c`);1<a.taskCount&&(b+=`\u540e\u53f0\u961f\u5217\uff1a${a.taskCount}\uff0c`);b+=`\u6b63\u5728\u6267\u884c\uff1a${p[a.currentTask]}\uff0c\u8bf7\u7a0d\u5019...`;this.hasVideo&&(this.htmlVideo.isVideoLoaded()&&this.options.ui.taskListBar||!this.htmlVideo.isVideoLoaded())&&this.taskListBar.updateText(b)}else this.taskListBar.hide()}viewHome(a){this.api.viewHome(a)}resetInteractTimestamp(){this.timestampForInteraction=(new Date).getTime()}receiveParamInfo(a){this.paramInfo=
a;let b=a.project,c=a.nodeIP,e=a.hostName;this.options.iid=a.iid;this.options.pid=a.pid;this.streamerAdaptive=a.adjustResolution;this.streamerLimitMaxResolution=a.limitMaxResolution;this.streamerResX=a.resX;this.streamerResY=a.resY;this.streamerLocked=a.locked;if(this.kickOutInMinutes=a.kickOutInMinutes){let d=setInterval(()=>{(new Date).getTime()-this.timestampForInteraction>6E4*this.kickOutInMinutes&&(this.destroy("\u957f\u65f6\u95f4\u672a\u4f7f\u7528\u8fde\u63a5\u5df2\u65ad\u5f00"),console.warn("\u957f\u65f6\u95f4\u672a\u4f7f\u7528\u8fde\u63a5\u5df2\u65ad\u5f00"),
clearInterval(d))},2E4)}this.nodeInfoArray=["\u6e32\u67d3\u8282\u70b9\u4fe1\u606f\uff1a"];e&&this.nodeInfoArray.push("\t\u4e3b\u673a\u540d\u79f0\uff1a"+e);c&&this.nodeInfoArray.push("\t\u4e3b\u673a\u5730\u5740\uff1a"+c);b&&this.nodeInfoArray.push("\t\u3000\u5de5\u7a0b\uff1a"+b);this.options.pid&&this.nodeInfoArray.push("\t\u5de5\u7a0bID\uff1a"+this.options.pid);this.nodeInfoArray.push("\t\u5b9e\u4f8bID\uff1a"+this.options.iid);this.nodeInfoArray.push("\t\u81ea\u9002\u5e94\uff1a"+this.streamerAdaptive);
this.nodeInfoArray.push("\t\u9650\u5236\u6700\u5927\u5206\u8fa8\u7387\uff1a"+this.streamerLimitMaxResolution);this.nodeInfoArray.push(`\t\u5206\u8fa8\u7387\uff1a${this.streamerResX}x${this.streamerResY}`);this.liveStatus&&this.liveStatus.updateButtonTip(this.nodeInfoArray.join("\n"));this.api.log(this.nodeInfoArray.join("\n\t"))}logStartupInfo(a){if(a){var b=new Date;a=`[${oa(b.getHours(),2)+":"+oa(b.getMinutes(),2)+":"+oa(b.getSeconds(),2)+"."+oa(b.getMilliseconds(),3)}] ${a}`;this.startupInfo&&
this.startupInfo.log(a);1<ta&&(a=`[${this.uid}] `+a);console.log("[DEBUG]"+a);this.api.log(a)}}setStatus(a,b){this.cloudStatus=a;this.statusIndicator&&this.statusIndicator.setStatus(a);switch(a){case S.WS_Disconnected:if(this.isDestroyed){console.log("destroyed.");break}b&&(this.logStartupInfo(b),console.warn(b));break;case S.WS_Connecting:this.logStartupInfo(`connecting ${this.useHttps?"wss":"ws"}...`);break;case S.WS_Connected:this.logStartupInfo("connected");break;case S.OnReady:this.startupInfo&&
this.startupInfo.hide(),this.options.ui.debugTouchPanel&&!this.touchEventsPanel&&setTimeout(()=>{this.touchEventsPanel=new ac(this);this.touchEventsPanel.appendText("Start recording touch events here:")},500),this.resize()}}createWidgetsInConstructor(){this.taskListBar=new $b(this);this.htmlVideo=new Ub(this,{keyEventTarget:this.options.keyEventTarget,useBuiltinCursors:this.options.useBuiltinCursors,mouseKeyListener:this.options.events.mouseKeyListener,onTouch:a=>this.debugTouchPanel&&this.touchEventsPanel.appendText(a),
onVideoLoaded:()=>{this.logStartupInfo("video: loadedmetadata");this.createWidgets();this.callEvent("onVideoLoaded");this.resize()}});this.options.ui.statusIndicator&&(this.statusIndicator=new Vb(this));this.options.ui.startupInfo&&(this.startupInfo=new Wb(this),this.logStartupInfo("sdk version: "+this.api.getVersion()),this.logStartupInfo("uid: "+this.uid));this.resizeObserver=new ResizeObserver(a=>this.resize());this.resizeObserver.observe(this.container)}createWidgets(){this.options.ui.statusButton&&
(this.liveStatus=new Xb(this,this.playerCount,this.nodeInfoArray.join("\n")));this.options.ui.fullscreenButton&&(this.fullscreenButton=new Yb(this));this.options.ui.homeButton&&(this.homeButton=new Zb(this));this.taskListBar&&this.taskListBar.setMode(1)}destroyWidgets(){this.liveStatus&&(this.liveStatus.destroy(),this.liveStatus=null);this.fullscreenButton&&(this.fullscreenButton.destroy(),this.fullscreenButton=null);this.homeButton&&(this.homeButton.destroy(),this.homeButton=null);this.touchEventsPanel&&
(this.touchEventsPanel.destroy(),this.touchEventsPanel=null);this.taskListBar&&(this.taskListBar.destroy(),this.taskListBar=null)}isQualityController(){return this.bQualityController}initWebRtcPlayer(a){this.rtc=new Rb({useStats:this.hasVideo&&(this.options.ui.statusButton||this.options.events.onRtcStatsReport),peerConnectionOptions:a.peerConnectionOptions,events:{onlog:b=>this.logStartupInfo(b),ontrack:b=>{this.htmlVideo&&this.htmlVideo.setTrack(b)},onicecandidate:b=>{this.signallingConnection&&
this.signallingConnection.sendCandidate(b)},onOfferCreated:b=>{this.signallingConnection&&this.signallingConnection.sendOffer(b.sdp,this.hasVideo)},onAnswerCreated:b=>{this.signallingConnection&&this.signallingConnection.send(b)},onstats:b=>{this.liveStatus&&this.liveStatus.updateWebRtcStats(b);this.callEvent("onRtcStatsReport",b)},ondatachannelopen:()=>{this.setStatus(S.RTC_Opened);this.hasVideo&&(this.rtc.requestQualityControl(),this.liveStatus&&this.rtc.requestInitialSettings());this.api.onConnectionOpen()},
ondatachannelclose:b=>this.api.onConnectionClose(b),ondatachannelerror:b=>this.api.onConnectionClose(b.error),ondatachannelmessage:(b,c)=>{switch(b){case "ResponseAPI":this.api.onConnectionMessage(c);break;case "InitialSettings":this.liveStatus&&this.liveStatus.updateInitialSettings(c);break;case "VideoEncoderAvgQP":this.liveStatus&&this.liveStatus.visible&&(b=(new TextDecoder("utf-16")).decode(c.data.slice(1)),(b=JSON.parse(b))&&this.liveStatus.updateQPAndRenderFPS(b.qp,b.renderFPS));break;case "QualityControlOwnership":this.bQualityController=
c,this.liveStatus&&this.liveStatus.updatePlayerId()}}}});this.hasVideo&&this.htmlVideo.setWebRtcPlayer(this.rtc);this.logStartupInfo("setting up...");this.options.offer&&this.rtc.createOffer();this.hasVideo&&(this.htmlVideo.registerKeyboardEvents(),this.htmlVideo.registerMouseEvents(),this.htmlVideo.registerTouchEvents())}connectSignallingServer(){this.setStatus(S.WS_Connecting);this.signallingConnection=new Sb({onopen:()=>this.setStatus(S.WS_Connected),onclose:a=>this.handleSignallingClose(a),onerror:()=>
{this.setStatus(S.WS_Disconnected)},onmessage:a=>{switch(a.type){case "config":this.initWebRtcPlayer(a);break;case "answer":this.playerId=a.playerId;this.rtc&&this.rtc.onReceiveAnswer(a);break;case "offer":this.playerId=a.playerId;this.rtc&&this.rtc.onReceiveOffer(a);break;case "iceCandidate":this.rtc&&this.rtc.onIceCandidate(a.candidate);break;case "paramInfo":this.receiveParamInfo(a);break;case "status":this.handleSignallingMessage_Status(a);break;case "playerCount":this.handleSignallingMessage_PlayerCount(a)}}});
this.signallingConnection.connect(this.url)}handleSignallingClose(a){this.destroyWidgets();this.callEvent("onConnClose",a);this.startupInfo&&this.startupInfo.setVisible(!0);this.api.onConnectionClose(a);this.rtc&&this.rtc.close();let b="";this.isDestroyed?(b="destroyed - \u7528\u6237\u9500\u6bc1",b=this.destroyReason?b+(": "+this.destroyReason):b+"."):(b="closed: ",a.code&&(b+=a.code),a.reason?b+=" "+a.reason:1006==a.code&&(b+=" \u8fde\u63a5\u65ad\u5f00"));this.setStatus(S.WS_Disconnected,b);Da(a.code)||
this.destroy();this.isDestroyed||(this.logStartupInfo("\u5c06\u57285\u79d2\u540e\u91cd\u65b0\u8fde\u63a5..."),this.startupInfo.setDelayClear(!0),setTimeout(()=>this.connectSignallingServer(),5E3));a.code==ra.instance_is_busy&&confirm("\u5f53\u524d\u5b9e\u4f8b\u6b63\u5fd9\u65e0\u6cd5\u8fde\u63a5\uff01\n\u662f\u5426\u7acb\u5373\u91cd\u542f\u8be5\u5b9e\u4f8b\u4ee5\u8fdb\u884c\u8fde\u63a5\uff1f")&&this.setInstanceOptions({iid:this.busyIId,reset:!0})}handleSignallingMessage_Status(a){let b=Ca(a.state);
b&&this.logStartupInfo(b);a.state===ba.StartFailed?(console.error(a.info),this.options.ui.startupInfo&&setTimeout(()=>alert(a.info),500)):a.state==ba.ConfirmBusy&&(this.busyIId=a.info)}handleSignallingMessage_PlayerCount(a){this.playerCount=a.count;this.liveStatus&&this.liveStatus.updateConnectionCount(this.playerCount);(this.canAdaptiveResolution=1===a.count)&&this.resize()}}w.APIErrorCode={OK:0,InvalidParameters:1,InternalError:2,ResourceNotFound:3,AcpProjWKTNotSet:4,CoordinateConversionFailed:5,
IDExists:6,InvalidRequestType:7,InvalidRequestString:8,NoCommand:9,DataTypeNotSupport:10,InvalidOperation:11,ProjectNotOpened:12,CodeMax:65535};w.AirCityAPI=qa;w.AirCityPlayer=bc;w.AnimatedImageButtonData=La;w.BPFuncParamType={Bool:0,UInt8:1,Int32:2,Float:3,Double:4,String:5,Color:6,Vector2D:7,Vector:8,Rotator:9,IntArray:10,StringArray:11,VectorArray:12,Coordinate:13,CoordinateArray:14,FloatArray:15};w.BPFunctionData=Za;w.BeamData=Ma;w.CameraTourData=ab;w.CameraTourKeyFrame=$a;w.CloudStatus=S;w.Color=
{LightPink:"RGB(255,182,193)",Pink:"RGB(255,192,203)",Crimson:"RGB(220,20,60)",LavenderBlush:"RGB(255,240,245)",PaleVioletRed:"RGB(219,112,147)",HotPink:"RGB(255,105,180)",DeepPink:"RGB(255,20,147)",MediumVioletRed:"RGB(199,21,133)",Orchid:"RGB(218,112,214)",Thistle:"RGB(216,191,216)",plum:"RGB(221,160,221)",Violet:"RGB(238,130,238)",Magenta:"RGB(255,0,255)",Fuchsia:"RGB(255,0,255)",DarkMagenta:"RGB(139,0,139)",Purple:"RGB(128,0,128)",MediumOrchid:"RGB(186,85,211)",DarkVoilet:"RGB(148,0,211)",DarkOrchid:"RGB(153,50,204)",
Indigo:"RGB(75,0,130)",BlueViolet:"RGB(138,43,226)",MediumPurple:"RGB(147,112,219)",MediumSlateBlue:"RGB(123,104,238)",SlateBlue:"RGB(106,90,205)",DarkSlateBlue:"RGB(72,61,139)",Lavender:"RGB(230,230,250)",GhostWhite:"RGB(248,248,255)",Blue:"RGB(0,0,255)",MediumBlue:"RGB(0,0,205)",MidnightBlue:"RGB(25,25,112)",DarkBlue:"RGB(0,0,139)",Navy:"RGB(0,0,128)",RoyalBlue:"RGB(65,105,225)",CornflowerBlue:"RGB(100,149,237)",LightSteelBlue:"RGB(176,196,222)",LightSlateGray:"RGB(119,136,153)",SlateGray:"RGB(112,128,144)",
DoderBlue:"RGB(30,144,255)",AliceBlue:"RGB(240,248,255)",SteelBlue:"RGB(70,130,180)",LightSkyBlue:"RGB(135,206,250)",SkyBlue:"RGB(135,206,235)",DeepSkyBlue:"RGB(0,191,255)",LightBLue:"RGB(173,216,230)",PowDerBlue:"RGB(176,224,230)",CadetBlue:"RGB(95,158,160)",Azure:"RGB(240,255,255)",LightCyan:"RGB(225,255,255)",PaleTurquoise:"RGB(175,238,238)",Cyan:"RGB(0,255,255)",Aqua:"RGB(212,242,231)",DarkTurquoise:"RGB(0,206,209)",DarkSlateGray:"RGB(47,79,79)",DarkCyan:"RGB(0,139,139)",Teal:"RGB(0,128,128)",
MediumTurquoise:"RGB(72,209,204)",LightSeaGreen:"RGB(32,178,170)",Turquoise:"RGB(64,224,208)",Auqamarin:"RGB(127,255,170)",MediumAquamarine:"RGB(0,250,154)",MediumSpringGreen:"RGB(0,255,127)",MintCream:"RGB(245,255,250)",SpringGreen:"RGB(60,179,113)",SeaGreen:"RGB(46,139,87)",Honeydew:"RGB(240,255,240)",LightGreen:"RGB(144,238,144)",PaleGreen:"RGB(152,251,152)",DarkSeaGreen:"RGB(143,188,143)",LimeGreen:"RGB(50,205,50)",Lime:"RGB(0,255,0)",ForestGreen:"RGB(34,139,34)",Green:"RGB(0,128,0)",DarkGreen:"RGB(0,100,0)",
Chartreuse:"RGB(127,255,0)",LawnGreen:"RGB(124,252,0)",GreenYellow:"RGB(173,255,47)",OliveDrab:"RGB(85,107,47)",Beige:"RGB(245,245,220)",LightGoldenrodYellow:"RGB(250,250,210)",Ivory:"RGB(255,255,240)",LightYellow:"RGB(255,255,224)",Yellow:"RGB(255,255,0)",Olive:"RGB(128,128,0)",DarkKhaki:"RGB(189,183,107)",LemonChiffon:"RGB(255,250,205)",PaleGodenrod:"RGB(238,232,170)",Khaki:"RGB(240,230,140)",Gold:"RGB(255,215,0)",Cornislk:"RGB(255,248,220)",GoldEnrod:"RGB(218,165,32)",FloralWhite:"RGB(255,250,240)",
OldLace:"RGB(253,245,230)",Wheat:"RGB(245,222,179)",Moccasin:"RGB(255,228,181)",Orange:"RGB(255,165,0)",PapayaWhip:"RGB(255,239,213)",BlanchedAlmond:"RGB(255,235,205)",NavajoWhite:"RGB(255,222,173)",AntiqueWhite:"RGB(250,235,215)",Tan:"RGB(210,180,140)",BrulyWood:"RGB(222,184,135)",Bisque:"RGB(255,228,196)",DarkOrange:"RGB(255,140,0)",Linen:"RGB(250,240,230)",Peru:"RGB(205,133,63)",PeachPuff:"RGB(255,218,185)",SandyBrown:"RGB(244,164,96)",Chocolate:"RGB(210,105,30)",SaddleBrown:"RGB(139,69,19)",SeaShell:"RGB(255,245,238)",
Sienna:"RGB(160,82,45)",LightSalmon:"RGB(255,160,122)",Coral:"RGB(255,127,80)",OrangeRed:"RGB(255,69,0)",DarkSalmon:"RGB(233,150,122)",Tomato:"RGB(255,99,71)",MistyRose:"RGB(255,228,225)",Salmon:"RGB(250,128,114)",Snow:"RGB(255,250,250)",LightCoral:"RGB(240,128,128)",RosyBrown:"RGB(188,143,143)",IndianRed:"RGB(205,92,92)",Red:"RGB(255,0,0)",Brown:"RGB(165,42,42)",FireBrick:"RGB(178,34,34)",DarkRed:"RGB(139,0,0)",Maroon:"RGB(128,0,0)",White:"RGB(255,255,255)",WhiteSmoke:"RGB(245,245,245)",Gainsboro:"RGB(220,220,220)",
LightGrey:"RGB(211,211,211)",Silver:"RGB(192,192,192)",DarkGray:"RGB(169,169,169)",Gray:"RGB(128,128,128)",DimGray:"RGB(105,105,105)",Black:"RGB(0,0,0)"};w.CommandType=p;w.CustomObjectData=Va;w.CustomObjectData2=Wa;w.CustomTagData=Ia;w.DecalData=Ta;w.DynamicWaterData=Ya;w.HeatMapPointData=Fa;w.HighlightAreaData=Ja;w.ImageButtonData=Ka;w.LayerVisibleData=Ea;w.MapMode={Campass:0,SmallMap:1,BigMap:2};w.MeasurementMode={Coordinate:1,Linear:2,Horizontal:3,Vertical:4,MultiPoint:5,TerrainArea:6};w.MousePickMask=
pa;w.ODLineData=Qa;w.PanelType={ViewshedAnalysis:0,SkylineAnalysis:1,ViewDomeAnalysis:2,VisiblityAnalysis:3,FloodFillAnalysis:4,SolarAnalysis:5,CutFillAnalysis:6,TerrainSlopeAnalysi:7,ContourLineAnalysis:8};w.PanoramaData=Sa;w.Polygon3DData=Oa;w.Polygon3DStyle={Wave:0,LoopLine:1,Gradual:2,DynamicGradual:3,WaveTransparent:4,WideWave:5,RotateArrow:6,RotateLine:7,RotateGradual:8,SingleColor:9,SingleColorWithLight:10};w.PolygonData=Ra;w.PolygonStyle={SingleColor:0,CirclePoint:1,Volumn:2,Gradual:3,DynamicGradual:4,
WaveTransparent:5,WideWave:6,RotateArrow:7,RotateLine:8,RotateGradual:9,OnTerrain:10};w.PolylineData=Pa;w.PolylineStyle={Arrow:0,Arrow1:1,Flow:2,Beam:3,Normal:4,OnTerrain:5,DottedNormal:6,DottedCircle:7};w.RadiationPointData=Na;w.TagData=Ga;w.TileLayerActorData=da;w.TileLayerData=Ua;w.VERSION="5.3";w.VideoProjectionData=Xa;w.Viewport=Z;w.WaterFlowFieldStyle={HeatMap:0,Water:1};w.WebUIData=Ha;w.__onCefResponse=function(a){if(sa)sa.onConnectionMessage(a)};Object.defineProperty(w,"__esModule",{value:!0});
return w}({});(()=>{if("undefined"!=typeof module&&module.exports)module.exports=acapi;else if("function"==typeof define&&define.amd)define(function(){return acapi});else{window.AcApiVersion=acapi.VERSION;for(let w in acapi)"VERSION"!=w&&(window[w]=acapi[w]);acapi.AirCityAPI.__onApiConstructed=w=>window.__g=w}})();
